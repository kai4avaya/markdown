(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))T(x);new MutationObserver(x=>{for(const k of x)if(k.type==="childList")for(const v of k.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&T(v)}).observe(document,{childList:!0,subtree:!0});function b(x){const k={};return x.integrity&&(k.integrity=x.integrity),x.referrerPolicy&&(k.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?k.credentials="include":x.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function T(x){if(x.ep)return;x.ep=!0;const k=b(x);fetch(x.href,k)}})();/*!
 * @toast-ui/editor
 * @version 3.2.2 | Fri Feb 17 2023
 * @author NHN Cloud FE Development Lab <dl_javascript@nhn.com>
 * @license MIT
 */(function(Q,y){typeof exports=="object"&&typeof module=="object"?module.exports=y():typeof define=="function"&&define.amd?define([],y):typeof exports=="object"?exports.toastui=y():(Q.toastui=Q.toastui||{},Q.toastui.Editor=y())})(self,function(){return function(){var Q={368:function(x){/*! @license DOMPurify 2.3.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.3/LICENSE */x.exports=function(){function k(V){if(Array.isArray(V)){for(var tt=0,lt=Array(V.length);tt<V.length;tt++)lt[tt]=V[tt];return lt}return Array.from(V)}var v=Object.hasOwnProperty,M=Object.setPrototypeOf,N=Object.isFrozen,D=Object.getPrototypeOf,F=Object.getOwnPropertyDescriptor,R=Object.freeze,O=Object.seal,S=Object.create,X=typeof Reflect<"u"&&Reflect,Z=X.apply,nt=X.construct;Z||(Z=function(V,tt,lt){return V.apply(tt,lt)}),R||(R=function(V){return V}),O||(O=function(V){return V}),nt||(nt=function(V,tt){return new(Function.prototype.bind.apply(V,[null].concat(k(tt))))});var rt=Vt(Array.prototype.forEach),Ct=Vt(Array.prototype.pop),j=Vt(Array.prototype.push),ze=Vt(String.prototype.toLowerCase),fn=Vt(String.prototype.match),xe=Vt(String.prototype.replace),$i=Vt(String.prototype.indexOf),ji=Vt(String.prototype.trim),pe=Vt(RegExp.prototype.test),_e=en(TypeError);function Vt(V){return function(tt){for(var lt=arguments.length,mt=Array(lt>1?lt-1:0),zt=1;zt<lt;zt++)mt[zt-1]=arguments[zt];return Z(V,tt,mt)}}function en(V){return function(){for(var tt=arguments.length,lt=Array(tt),mt=0;mt<tt;mt++)lt[mt]=arguments[mt];return nt(V,lt)}}function ut(V,tt){M&&M(V,null);for(var lt=tt.length;lt--;){var mt=tt[lt];if(typeof mt=="string"){var zt=ze(mt);zt!==mt&&(N(tt)||(tt[lt]=zt),mt=zt)}V[mt]=!0}return V}function Ce(V){var tt=S(null),lt=void 0;for(lt in V)Z(v,V,[lt])&&(tt[lt]=V[lt]);return tt}function qe(V,tt){for(;V!==null;){var lt=F(V,tt);if(lt){if(lt.get)return Vt(lt.get);if(typeof lt.value=="function")return Vt(lt.value)}V=D(V)}function mt(zt){return console.warn("fallback value for",zt),null}return mt}var gr=R(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_n=R(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),li=R(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),vr=R(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ci=R(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),he=R(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),qn=R(["#text"]),ui=R(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Ie=R(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Vi=R(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),$n=R(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ss=O(/\{\{[\s\S]*|[\s\S]*\}\}/gm),as=O(/<%[\s\S]*|[\s\S]*%>/gm),Ui=O(/^data-[\-\w.\u00B7-\uFFFF]/),ls=O(/^aria-[\-\w]+$/),Wi=O(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ki=O(/^(?:\w+script|data):/i),Gi=O(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),mn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V};function fe(V){if(Array.isArray(V)){for(var tt=0,lt=Array(V.length);tt<V.length;tt++)lt[tt]=V[tt];return lt}return Array.from(V)}var yr=function(){return typeof window>"u"?null:window},cs=function(V,tt){if((V===void 0?"undefined":mn(V))!=="object"||typeof V.createPolicy!="function")return null;var lt=null,mt="data-tt-policy-suffix";tt.currentScript&&tt.currentScript.hasAttribute(mt)&&(lt=tt.currentScript.getAttribute(mt));var zt="dompurify"+(lt?"#"+lt:"");try{return V.createPolicy(zt,{createHTML:function(Vn){return Vn}})}catch{return console.warn("TrustedTypes policy "+zt+" could not be created."),null}};function jn(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yr(),tt=function(I){return jn(I)};if(tt.version="2.3.3",tt.removed=[],!V||!V.document||V.document.nodeType!==9)return tt.isSupported=!1,tt;var lt=V.document,mt=V.document,zt=V.DocumentFragment,Vn=V.HTMLTemplateElement,Un=V.Node,br=V.Element,wr=V.NodeFilter,Ji=V.NamedNodeMap,Yi=Ji===void 0?V.NamedNodeMap||V.MozNamedAttrMap:Ji,us=V.Text,Ne=V.Comment,Qi=V.DOMParser,di=V.trustedTypes,kr=br.prototype,xr=qe(kr,"cloneNode"),ds=qe(kr,"nextSibling"),pi=qe(kr,"childNodes"),hi=qe(kr,"parentNode");if(typeof Vn=="function"){var ae=mt.createElement("template");ae.content&&ae.content.ownerDocument&&(mt=ae.content.ownerDocument)}var $e=cs(di,lt),me=$e&&wn?$e.createHTML(""):"",Cr=mt,re=Cr.implementation,ps=Cr.createNodeIterator,gn=Cr.createDocumentFragment,hs=Cr.getElementsByTagName,Oe=lt.importNode,Xi={};try{Xi=Ce(mt).documentMode?mt.documentMode:{}}catch{}var _t={};tt.isSupported=typeof hi=="function"&&re&&re.createHTMLDocument!==void 0&&Xi!==9;var fi=ss,Wn=as,fs=Ui,ms=ls,gs=Ki,Zi=Gi,Er=Wi,Ot=null,to=ut({},[].concat(fe(gr),fe(_n),fe(li),fe(ci),fe(qn))),Lt=null,eo=ut({},[].concat(fe(ui),fe(Ie),fe(Vi),fe($n))),Tr=null,Sr=null,no=!0,je=!0,St=!1,vn=!1,yn=!1,Mr=!1,bn=!1,Le=!1,Ir=!1,Nr=!0,wn=!1,At=!0,Kn=!0,Ve=!1,Ue={},We=null,Or=ut({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),mi=null,gi=ut({},["audio","video","img","source","image","track"]),vi=null,yi=ut({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Gn="http://www.w3.org/1998/Math/MathML",Xt="http://www.w3.org/2000/svg",ie="http://www.w3.org/1999/xhtml",kn=ie,Ae=!1,Dt=void 0,bi=["application/xhtml+xml","text/html"],Ke="text/html",Ut=void 0,xt=null,Mt=mt.createElement("form"),Jn=function(I){xt&&xt===I||(I&&(I===void 0?"undefined":mn(I))==="object"||(I={}),I=Ce(I),Ot="ALLOWED_TAGS"in I?ut({},I.ALLOWED_TAGS):to,Lt="ALLOWED_ATTR"in I?ut({},I.ALLOWED_ATTR):eo,vi="ADD_URI_SAFE_ATTR"in I?ut(Ce(yi),I.ADD_URI_SAFE_ATTR):yi,mi="ADD_DATA_URI_TAGS"in I?ut(Ce(gi),I.ADD_DATA_URI_TAGS):gi,We="FORBID_CONTENTS"in I?ut({},I.FORBID_CONTENTS):Or,Tr="FORBID_TAGS"in I?ut({},I.FORBID_TAGS):{},Sr="FORBID_ATTR"in I?ut({},I.FORBID_ATTR):{},Ue="USE_PROFILES"in I&&I.USE_PROFILES,no=I.ALLOW_ARIA_ATTR!==!1,je=I.ALLOW_DATA_ATTR!==!1,St=I.ALLOW_UNKNOWN_PROTOCOLS||!1,vn=I.SAFE_FOR_TEMPLATES||!1,yn=I.WHOLE_DOCUMENT||!1,Le=I.RETURN_DOM||!1,Ir=I.RETURN_DOM_FRAGMENT||!1,Nr=I.RETURN_DOM_IMPORT!==!1,wn=I.RETURN_TRUSTED_TYPE||!1,bn=I.FORCE_BODY||!1,At=I.SANITIZE_DOM!==!1,Kn=I.KEEP_CONTENT!==!1,Ve=I.IN_PLACE||!1,Er=I.ALLOWED_URI_REGEXP||Er,kn=I.NAMESPACE||ie,Dt=Dt=bi.indexOf(I.PARSER_MEDIA_TYPE)===-1?Ke:I.PARSER_MEDIA_TYPE,Ut=Dt==="application/xhtml+xml"?function(W){return W}:ze,vn&&(je=!1),Ir&&(Le=!0),Ue&&(Ot=ut({},[].concat(fe(qn))),Lt=[],Ue.html===!0&&(ut(Ot,gr),ut(Lt,ui)),Ue.svg===!0&&(ut(Ot,_n),ut(Lt,Ie),ut(Lt,$n)),Ue.svgFilters===!0&&(ut(Ot,li),ut(Lt,Ie),ut(Lt,$n)),Ue.mathMl===!0&&(ut(Ot,ci),ut(Lt,Vi),ut(Lt,$n))),I.ADD_TAGS&&(Ot===to&&(Ot=Ce(Ot)),ut(Ot,I.ADD_TAGS)),I.ADD_ATTR&&(Lt===eo&&(Lt=Ce(Lt)),ut(Lt,I.ADD_ATTR)),I.ADD_URI_SAFE_ATTR&&ut(vi,I.ADD_URI_SAFE_ATTR),I.FORBID_CONTENTS&&(We===Or&&(We=Ce(We)),ut(We,I.FORBID_CONTENTS)),Kn&&(Ot["#text"]=!0),yn&&ut(Ot,["html","head","body"]),Ot.table&&(ut(Ot,["tbody"]),delete Tr.tbody),R&&R(I),xt=I)},ro=ut({},["mi","mo","mn","ms","mtext"]),Yn=ut({},["foreignobject","desc","title","annotation-xml"]),Qn=ut({},_n);ut(Qn,li),ut(Qn,vr);var Ge=ut({},ci);ut(Ge,he);var io=function(I){var W=hi(I);W&&W.tagName||(W={namespaceURI:ie,tagName:"template"});var U=ze(I.tagName),G=ze(W.tagName);if(I.namespaceURI===Xt)return W.namespaceURI===ie?U==="svg":W.namespaceURI===Gn?U==="svg"&&(G==="annotation-xml"||ro[G]):!!Qn[U];if(I.namespaceURI===Gn)return W.namespaceURI===ie?U==="math":W.namespaceURI===Xt?U==="math"&&Yn[G]:!!Ge[U];if(I.namespaceURI===ie){if(W.namespaceURI===Xt&&!Yn[G]||W.namespaceURI===Gn&&!ro[G])return!1;var yt=ut({},["title","style","font","a","script"]);return!Ge[U]&&(yt[U]||!Qn[U])}return!1},De=function(I){j(tt.removed,{element:I});try{I.parentNode.removeChild(I)}catch{try{I.outerHTML=me}catch{I.remove()}}},Lr=function(I,W){try{j(tt.removed,{attribute:W.getAttributeNode(I),from:W})}catch{j(tt.removed,{attribute:null,from:W})}if(W.removeAttribute(I),I==="is"&&!Lt[I])if(Le||Ir)try{De(W)}catch{}else try{W.setAttribute(I,"")}catch{}},wi=function(I){var W=void 0,U=void 0;if(bn)I="<remove></remove>"+I;else{var G=fn(I,/^[\r\n\t ]+/);U=G&&G[0]}Dt==="application/xhtml+xml"&&(I='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+I+"</body></html>");var yt=$e?$e.createHTML(I):I;if(kn===ie)try{W=new Qi().parseFromString(yt,Dt)}catch{}if(!W||!W.documentElement){W=re.createDocument(kn,"template",null);try{W.documentElement.innerHTML=Ae?"":yt}catch{}}var qt=W.body||W.documentElement;return I&&U&&qt.insertBefore(mt.createTextNode(U),qt.childNodes[0]||null),kn===ie?hs.call(W,yn?"html":"body")[0]:yn?W.documentElement:qt},oo=function(I){return ps.call(I.ownerDocument||I,I,wr.SHOW_ELEMENT|wr.SHOW_COMMENT|wr.SHOW_TEXT,null,!1)},Xn=function(I){return!(I instanceof us||I instanceof Ne||typeof I.nodeName=="string"&&typeof I.textContent=="string"&&typeof I.removeChild=="function"&&I.attributes instanceof Yi&&typeof I.removeAttribute=="function"&&typeof I.setAttribute=="function"&&typeof I.namespaceURI=="string"&&typeof I.insertBefore=="function")},Re=function(I){return(Un===void 0?"undefined":mn(Un))==="object"?I instanceof Un:I&&(I===void 0?"undefined":mn(I))==="object"&&typeof I.nodeType=="number"&&typeof I.nodeName=="string"},ge=function(I,W,U){_t[I]&&rt(_t[I],function(G){G.call(tt,W,U,xt)})},ki=function(I){var W=void 0;if(ge("beforeSanitizeElements",I,null),Xn(I)||fn(I.nodeName,/[\u0080-\uFFFF]/))return De(I),!0;var U=Ut(I.nodeName);if(ge("uponSanitizeElement",I,{tagName:U,allowedTags:Ot}),!Re(I.firstElementChild)&&(!Re(I.content)||!Re(I.content.firstElementChild))&&pe(/<[/\w]/g,I.innerHTML)&&pe(/<[/\w]/g,I.textContent)||U==="select"&&pe(/<template/i,I.innerHTML))return De(I),!0;if(!Ot[U]||Tr[U]){if(Kn&&!We[U]){var G=hi(I)||I.parentNode,yt=pi(I)||I.childNodes;if(yt&&G)for(var qt=yt.length-1;qt>=0;--qt)G.insertBefore(xr(yt[qt],!0),ds(I))}return De(I),!0}return I instanceof br&&!io(I)?(De(I),!0):U!=="noscript"&&U!=="noembed"||!pe(/<\/no(script|embed)/i,I.innerHTML)?(vn&&I.nodeType===3&&(W=I.textContent,W=xe(W,fi," "),W=xe(W,Wn," "),I.textContent!==W&&(j(tt.removed,{element:I.cloneNode()}),I.textContent=W)),ge("afterSanitizeElements",I,null),!1):(De(I),!0)},Ar=function(I,W,U){if(At&&(W==="id"||W==="name")&&(U in mt||U in Mt))return!1;if(!(je&&!Sr[W]&&pe(fs,W))){if(!(no&&pe(ms,W))){if(!Lt[W]||Sr[W])return!1;if(!vi[W]){if(!pe(Er,xe(U,Zi,""))){if((W!=="src"&&W!=="xlink:href"&&W!=="href"||I==="script"||$i(U,"data:")!==0||!mi[I])&&!(St&&!pe(gs,xe(U,Zi,"")))){if(U)return!1}}}}}return!0},so=function(I){var W=void 0,U=void 0,G=void 0,yt=void 0;ge("beforeSanitizeAttributes",I,null);var qt=I.attributes;if(qt){var It={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Lt};for(yt=qt.length;yt--;){var dt=W=qt[yt],Wt=dt.name,at=dt.namespaceURI;if(U=ji(W.value),G=Ut(Wt),It.attrName=G,It.attrValue=U,It.keepAttr=!0,It.forceKeepAttr=void 0,ge("uponSanitizeAttribute",I,It),U=It.attrValue,!It.forceKeepAttr&&(Lr(Wt,I),It.keepAttr))if(pe(/\/>/i,U))Lr(Wt,I);else{vn&&(U=xe(U,fi," "),U=xe(U,Wn," "));var xi=Ut(I.nodeName);if(Ar(xi,G,U))try{at?I.setAttributeNS(at,Wt,U):I.setAttribute(Wt,U),Ct(tt.removed)}catch{}}}ge("afterSanitizeAttributes",I,null)}},ao=function I(W){var U=void 0,G=oo(W);for(ge("beforeSanitizeShadowDOM",W,null);U=G.nextNode();)ge("uponSanitizeShadowNode",U,null),ki(U)||(U.content instanceof zt&&I(U.content),so(U));ge("afterSanitizeShadowDOM",W,null)};return tt.sanitize=function(I,W){var U=void 0,G=void 0,yt=void 0,qt=void 0,It=void 0;if((Ae=!I)&&(I="<!-->"),typeof I!="string"&&!Re(I)){if(typeof I.toString!="function")throw _e("toString is not a function");if(typeof(I=I.toString())!="string")throw _e("dirty is not a string, aborting")}if(!tt.isSupported){if(mn(V.toStaticHTML)==="object"||typeof V.toStaticHTML=="function"){if(typeof I=="string")return V.toStaticHTML(I);if(Re(I))return V.toStaticHTML(I.outerHTML)}return I}if(Mr||Jn(W),tt.removed=[],typeof I=="string"&&(Ve=!1),!Ve)if(I instanceof Un)(G=(U=wi("<!---->")).ownerDocument.importNode(I,!0)).nodeType===1&&G.nodeName==="BODY"||G.nodeName==="HTML"?U=G:U.appendChild(G);else{if(!Le&&!vn&&!yn&&I.indexOf("<")===-1)return $e&&wn?$e.createHTML(I):I;if(!(U=wi(I)))return Le?null:me}U&&bn&&De(U.firstChild);for(var dt=oo(Ve?I:U);yt=dt.nextNode();)yt.nodeType===3&&yt===qt||ki(yt)||(yt.content instanceof zt&&ao(yt.content),so(yt),qt=yt);if(qt=null,Ve)return I;if(Le){if(Ir)for(It=gn.call(U.ownerDocument);U.firstChild;)It.appendChild(U.firstChild);else It=U;return Nr&&(It=Oe.call(lt,It,!0)),It}var Wt=yn?U.outerHTML:U.innerHTML;return vn&&(Wt=xe(Wt,fi," "),Wt=xe(Wt,Wn," ")),$e&&wn?$e.createHTML(Wt):Wt},tt.setConfig=function(I){Jn(I),Mr=!0},tt.clearConfig=function(){xt=null,Mr=!1},tt.isValidAttribute=function(I,W,U){xt||Jn({});var G=Ut(I),yt=Ut(W);return Ar(G,yt,U)},tt.addHook=function(I,W){typeof W=="function"&&(_t[I]=_t[I]||[],j(_t[I],W))},tt.removeHook=function(I){_t[I]&&Ct(_t[I])},tt.removeHooks=function(I){_t[I]&&(_t[I]=[])},tt.removeAllHooks=function(){_t={}},tt}return jn()}()},928:function(x,k,v){var M=v(322);x.exports=function(N,D,F){var R,O;if(F=F||0,!M(D))return-1;if(Array.prototype.indexOf)return Array.prototype.indexOf.call(D,N,F);for(O=D.length,R=F;F>=0&&R<O;R+=1)if(D[R]===N)return R;return-1}},690:function(x,k,v){var M=v(322),N=v(893),D=v(956);x.exports=function(F,R,O){M(F)?N(F,R,O):D(F,R,O)}},893:function(x){x.exports=function(k,v,M){var N=0,D=k.length;for(M=M||null;N<D&&v.call(M,k[N],N,k)!==!1;N+=1);}},956:function(x){x.exports=function(k,v,M){var N;for(N in M=M||null,k)if(k.hasOwnProperty(N)&&v.call(M,k[N],N,k)===!1)break}},354:function(x,k,v){var M=v(893);x.exports=function(N){var D;try{D=Array.prototype.slice.call(N)}catch{D=[],M(N,function(R){D.push(R)})}return D}},755:function(x){var k="_feEventKey";x.exports=function(v,M){var N,D=v[k];return D||(D=v[k]={}),(N=D[M])||(N=D[M]=[]),N}},349:function(x,k,v){var M=v(758),N=v(690),D=v(755);function F(O,S,X){var Z,nt=D(O,S);X?(N(nt,function(rt,Ct){return X!==rt.handler||(R(O,S,rt.wrappedHandler),Z=Ct,!1)}),nt.splice(Z,1)):(N(nt,function(rt){R(O,S,rt.wrappedHandler)}),nt.splice(0,nt.length))}function R(O,S,X){"removeEventListener"in O?O.removeEventListener(S,X):"detachEvent"in O&&O.detachEvent("on"+S,X)}x.exports=function(O,S,X){M(S)?N(S.split(/\s+/g),function(Z){F(O,Z,X)}):N(S,function(Z,nt){F(O,nt,Z)})}},348:function(x,k,v){var M=v(758),N=v(690),D=v(755);function F(R,O,S,X){function Z(nt){S.call(X||R,nt||window.event)}"addEventListener"in R?R.addEventListener(O,Z):"attachEvent"in R&&R.attachEvent("on"+O,Z),function(nt,rt,Ct,j){var ze=D(nt,rt),fn=!1;N(ze,function(xe){return xe.handler!==Ct||(fn=!0,!1)}),fn||ze.push({handler:Ct,wrappedHandler:j})}(R,O,S,Z)}x.exports=function(R,O,S,X){M(O)?N(O.split(/\s+/g),function(Z){F(R,Z,S,X)}):N(O,function(Z,nt){F(R,nt,Z,S)})}},24:function(x,k,v){var M=v(322),N=v(929);x.exports=function(D,F){F=(F=M(F)?F.join(" "):F).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),N(D.className.baseVal)?D.className=F:D.className.baseVal=F}},204:function(x,k,v){var M=v(690),N=v(928),D=v(902),F=v(24);x.exports=function(R){var O,S=Array.prototype.slice.call(arguments,1),X=R.classList,Z=[];X?M(S,function(nt){R.classList.add(nt)}):((O=D(R))&&(S=[].concat(O.split(/\s+/),S)),M(S,function(nt){N(nt,Z)<0&&Z.push(nt)}),F(R,Z))}},522:function(x,k,v){var M=v(758),N=v(690);x.exports=function(D,F,R){var O=D.style;M(F)?O[F]=R:N(F,function(S,X){O[X]=S})}},902:function(x,k,v){var M=v(929);x.exports=function(N){return N&&N.className?M(N.className.baseVal)?N.className:N.className.baseVal:""}},714:function(x,k,v){var M=v(928),N=v(902);x.exports=function(D,F){var R;return D.classList?D.classList.contains(F):(R=N(D).split(/\s+/),M(F,R)>-1)}},471:function(x,k,v){var M=v(928),N=v(354),D=Element.prototype,F=D.matches||D.webkitMatchesSelector||D.mozMatchesSelector||D.msMatchesSelector||function(R){var O=this.document||this.ownerDocument;return M(this,N(O.querySelectorAll(R)))>-1};x.exports=function(R,O){return F.call(R,O)}},462:function(x,k,v){var M=v(893),N=v(928),D=v(902),F=v(24);x.exports=function(R){var O,S,X=Array.prototype.slice.call(arguments,1),Z=R.classList;Z?M(X,function(nt){Z.remove(nt)}):(O=D(R).split(/\s+/),S=[],M(O,function(nt){N(nt,X)<0&&S.push(nt)}),F(R,S))}},969:function(x){x.exports=function(k,v){var M,N,D,F,R=Object.prototype.hasOwnProperty;for(D=1,F=arguments.length;D<F;D+=1)for(N in M=arguments[D])R.call(M,N)&&(k[N]=M[N]);return k}},254:function(x,k,v){var M=v(956);x.exports=function(N,D){var F=document.createElement("img"),R="";return M(D,function(O,S){R+="&"+S+"="+O}),R=R.substring(1),F.src=N+"?"+R,F.style.display="none",document.body.appendChild(F),document.body.removeChild(F),F}},391:function(x,k,v){var M=v(929),N=v(254);x.exports=function(D,F){var R=location.hostname,O="TOAST UI "+D+" for "+R+": Statistics",S=window.localStorage.getItem(O);(M(window.tui)||window.tui.usageStatistics!==!1)&&(S&&!function(X){return new Date().getTime()-X>6048e5}(S)||(window.localStorage.setItem(O,new Date().getTime()),setTimeout(function(){document.readyState!=="interactive"&&document.readyState!=="complete"||N("https://www.google-analytics.com/collect",{v:1,t:"event",tid:F,cid:R,dp:R,dh:D,el:D,ec:"use"})},1e3)))}},516:function(x){x.exports=function(k,v){var M,N;return v=v||0,function(){N=Array.prototype.slice.call(arguments),window.clearTimeout(M),M=window.setTimeout(function(){k.apply(null,N)},v)}}},423:function(x,k,v){var M=v(516);x.exports=function(N,D){var F,R,O,S,X=!0,Z=function(rt){N.apply(null,rt),F=null};function nt(){if(S=Array.prototype.slice.call(arguments),X)return Z(S),void(X=!1);O=Number(new Date),F=F||O,R(S),O-F>=D&&Z(S)}return R=M(Z,D=D||0),nt.reset=function(){X=!0,F=null},nt}},322:function(x){x.exports=function(k){return k instanceof Array}},326:function(x){x.exports=function(k){return typeof k=="boolean"||k instanceof Boolean}},65:function(x,k,v){var M=v(929),N=v(934);x.exports=function(D){return!M(D)&&!N(D)}},404:function(x,k,v){var M=v(790);x.exports=function(N){return!M(N)}},294:function(x){x.exports=function(k){return k instanceof Function}},934:function(x){x.exports=function(k){return k===null}},321:function(x){x.exports=function(k){return typeof k=="number"||k instanceof Number}},73:function(x){x.exports=function(k){return k===Object(k)}},758:function(x){x.exports=function(k){return typeof k=="string"||k instanceof String}},790:function(x,k,v){var M=v(65);x.exports=function(N){return M(N)&&N!==!1}},929:function(x){x.exports=function(k){return k===void 0}}},y={};function b(x){var k=y[x];if(k!==void 0)return k.exports;var v=y[x]={exports:{}};return Q[x].call(v.exports,v,v.exports,b),v.exports}b.n=function(x){var k=x&&x.__esModule?function(){return x.default}:function(){return x};return b.d(k,{a:k}),k},b.d=function(x,k){for(var v in k)b.o(k,v)&&!b.o(x,v)&&Object.defineProperty(x,v,{enumerable:!0,get:k[v]})},b.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),b.o=function(x,k){return Object.prototype.hasOwnProperty.call(x,k)};var T={};return function(){b.d(T,{default:function(){return Pb}});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var x=function(n,t){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},x(n,t)};function k(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}x(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var v=function(){return v=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},v.apply(this,arguments)};function M(n,t,e){if(arguments.length===2)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))}function N(n,t){return Object.defineProperty?Object.defineProperty(n,"raw",{value:t}):n.raw=t,n}function D(n){this.content=n}D.prototype={constructor:D,find:function(n){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===n)return t;return-1},get:function(n){var t=this.find(n);return t==-1?void 0:this.content[t+1]},update:function(n,t,e){var r=e&&e!=n?this.remove(e):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(e||n,t):(o[i+1]=t,e&&(o[i]=e)),new D(o)},remove:function(n){var t=this.find(n);if(t==-1)return this;var e=this.content.slice();return e.splice(t,2),new D(e)},addToStart:function(n,t){return new D([n,t].concat(this.remove(n).content))},addToEnd:function(n,t){var e=this.remove(n).content.slice();return e.push(n,t),new D(e)},addBefore:function(n,t,e){var r=this.remove(t),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,t,e),new D(i)},forEach:function(n){for(var t=0;t<this.content.length;t+=2)n(this.content[t],this.content[t+1])},prepend:function(n){return(n=D.from(n)).size?new D(n.content.concat(this.subtract(n).content)):this},append:function(n){return(n=D.from(n)).size?new D(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var t=this;n=D.from(n);for(var e=0;e<n.content.length;e+=2)t=t.remove(n.content[e]);return t},get size(){return this.content.length>>1}},D.from=function(n){if(n instanceof D)return n;var t=[];if(n)for(var e in n)t.push(e,n[e]);return new D(t)};var F=D;function R(n,t,e){for(let r=0;;r++){if(r==n.childCount||r==t.childCount)return n.childCount==t.childCount?null:e;let i=n.child(r),o=t.child(r);if(i!=o){if(!i.sameMarkup(o))return e;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)e++;return e}if(i.content.size||o.content.size){let s=R(i.content,o.content,e+1);if(s!=null)return s}e+=i.nodeSize}else e+=i.nodeSize}}function O(n,t,e,r){for(let i=n.childCount,o=t.childCount;;){if(i==0||o==0)return i==o?null:{a:e,b:r};let s=n.child(--i),a=t.child(--o),l=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:e,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,e--,r--;return{a:e,b:r}}if(s.content.size||a.content.size){let c=O(s.content,a.content,e-1,r-1);if(c)return c}e-=l,r-=l}else e-=l,r-=l}}class S{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,i=0,o){for(let s=0,a=0;a<e;s++){let l=this.content[s],c=a+l.nodeSize;if(c>t&&r(l,i+a,o||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,t-u),Math.min(l.content.size,e-u),r,i+u)}a=c}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,i){let o="",s=!0;return this.nodesBetween(t,e,(a,l)=>{a.isText?(o+=a.text.slice(Math.max(t,l)-l,e-l),s=!r):a.isLeaf?(i?o+=typeof i=="function"?i(a):i:a.type.spec.leafText&&(o+=a.type.spec.leafText(a)),s=!r):!s&&a.isBlock&&(o+=r,s=!0)},0),o}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,i=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(r)&&(i[i.length-1]=e.withText(e.text+r.text),o=1);o<t.content.length;o++)i.push(t.content[o]);return new S(i,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],i=0;if(e>t)for(let o=0,s=0;s<e;o++){let a=this.content[o],l=s+a.nodeSize;l>t&&((s<t||l>e)&&(a=a.isText?a.cut(Math.max(0,t-s),Math.min(a.text.length,e-s)):a.cut(Math.max(0,t-s-1),Math.min(a.content.size,e-s-1))),r.push(a),i+=a.nodeSize),s=l}return new S(r,i)}cutByIndex(t,e){return t==e?S.empty:t==0&&e==this.content.length?this:new S(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let i=this.content.slice(),o=this.size+e.nodeSize-r.nodeSize;return i[t]=e,new S(i,o)}addToStart(t){return new S([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new S(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let i=this.content[e];t(i,r,e),r+=i.nodeSize}}findDiffStart(t,e=0){return R(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return O(this,t,e,r)}findIndex(t,e=-1){if(t==0)return Z(0,t);if(t==this.size)return Z(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=i+this.child(r).nodeSize;if(o>=t)return o==t||e>0?Z(r+1,o):Z(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return S.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new S(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return S.empty;let e,r=0;for(let i=0;i<t.length;i++){let o=t[i];r+=o.nodeSize,i&&o.isText&&t[i-1].sameMarkup(o)?(e||(e=t.slice(0,i)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new S(e||t,r)}static from(t){if(!t)return S.empty;if(t instanceof S)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new S([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}S.empty=new S([],0);const X={index:0,offset:0};function Z(n,t){return X.index=n,X.offset=t,X}function nt(n,t){if(n===t)return!0;if(!n||typeof n!="object"||!t||typeof t!="object")return!1;let e=Array.isArray(n);if(Array.isArray(t)!=e)return!1;if(e){if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(!nt(n[r],t[r]))return!1}else{for(let r in n)if(!(r in t)||!nt(n[r],t[r]))return!1;for(let r in t)if(!(r in n))return!1}return!0}class rt{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,r=!1;for(let i=0;i<t.length;i++){let o=t[i];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,i));else{if(o.type.excludes(this.type))return t;!r&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),r=!0),e&&e.push(o)}}return e||(e=t.slice()),r||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&nt(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let r=t.marks[e.type];if(!r)throw new RangeError(`There is no mark type ${e.type} in this schema`);return r.create(e.attrs)}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].eq(e[r]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return rt.none;if(t instanceof rt)return[t];let e=t.slice();return e.sort((r,i)=>r.type.rank-i.type.rank),e}}rt.none=[];class Ct extends Error{}class j{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=fn(this.content,t+this.openStart,e);return r&&new j(r,this.openStart,this.openEnd)}removeBetween(t,e){return new j(ze(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return j.empty;let r=e.openStart||0,i=e.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new j(S.fromJSON(t,e.content),r,i)}static maxOpen(t,e=!0){let r=0,i=0;for(let o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=t.lastChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.lastChild)i++;return new j(t,r,i)}}function ze(n,t,e){let{index:r,offset:i}=n.findIndex(t),o=n.maybeChild(r),{index:s,offset:a}=n.findIndex(e);if(i==t||o.isText){if(a!=e&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,t).append(n.cut(e))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(ze(o.content,t-i-1,e-i-1)))}function fn(n,t,e,r){let{index:i,offset:o}=n.findIndex(t),s=n.maybeChild(i);if(o==t||s.isText)return r&&!r.canReplace(i,i,e)?null:n.cut(0,t).append(e).append(n.cut(t));let a=fn(s.content,t-o-1,e);return a&&n.replaceChild(i,s.copy(a))}function xe(n,t,e){if(e.openStart>n.depth)throw new Ct("Inserted content deeper than insertion position");if(n.depth-e.openStart!=t.depth-e.openEnd)throw new Ct("Inconsistent open depths");return $i(n,t,e,0)}function $i(n,t,e,r){let i=n.index(r),o=n.node(r);if(i==t.index(r)&&r<n.depth-e.openStart){let s=$i(n,t,e,r+1);return o.copy(o.content.replaceChild(i,s))}if(e.content.size){if(e.openStart||e.openEnd||n.depth!=r||t.depth!=r){let{start:s,end:a}=function(l,c){let u=c.depth-l.openStart,d=c.node(u).copy(l.content);for(let p=u-1;p>=0;p--)d=c.node(p).copy(S.from(d));return{start:d.resolveNoCache(l.openStart+u),end:d.resolveNoCache(d.content.size-l.openEnd-u)}}(e,n);return en(o,ut(n,s,a,t,r))}{let s=n.parent,a=s.content;return en(s,a.cut(0,n.parentOffset).append(e.content).append(a.cut(t.parentOffset)))}}return en(o,Ce(n,t,r))}function ji(n,t){if(!t.type.compatibleContent(n.type))throw new Ct("Cannot join "+t.type.name+" onto "+n.type.name)}function pe(n,t,e){let r=n.node(e);return ji(r,t.node(e)),r}function _e(n,t){let e=t.length-1;e>=0&&n.isText&&n.sameMarkup(t[e])?t[e]=n.withText(t[e].text+n.text):t.push(n)}function Vt(n,t,e,r){let i=(t||n).node(e),o=0,s=t?t.index(e):i.childCount;n&&(o=n.index(e),n.depth>e?o++:n.textOffset&&(_e(n.nodeAfter,r),o++));for(let a=o;a<s;a++)_e(i.child(a),r);t&&t.depth==e&&t.textOffset&&_e(t.nodeBefore,r)}function en(n,t){if(!n.type.validContent(t))throw new Ct("Invalid content for node "+n.type.name);return n.copy(t)}function ut(n,t,e,r,i){let o=n.depth>i&&pe(n,t,i+1),s=r.depth>i&&pe(e,r,i+1),a=[];return Vt(null,n,i,a),o&&s&&t.index(i)==e.index(i)?(ji(o,s),_e(en(o,ut(n,t,e,r,i+1)),a)):(o&&_e(en(o,Ce(n,t,i+1)),a),Vt(t,e,i,a),s&&_e(en(s,Ce(e,r,i+1)),a)),Vt(r,null,i,a),new S(a)}function Ce(n,t,e){let r=[];return Vt(null,n,e,r),n.depth>e&&_e(en(pe(n,t,e+1),Ce(n,t,e+1)),r),Vt(t,null,e,r),new S(r)}j.empty=new j(S.empty,0,0);class qe{constructor(t,e,r){this.pos=t,this.path=e,this.parentOffset=r,this.depth=e.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[3*this.resolveDepth(t)]}index(t){return this.path[3*this.resolveDepth(t)+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)}start(t){return(t=this.resolveDepth(t))==0?0:this.path[3*t-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]}after(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=t.child(e);return r?t.child(e).cut(r):i}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):t==0?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let r=this.path[3*e],i=e==0?0:this.path[3*e-1]+1;for(let o=0;o<t;o++)i+=r.child(o).nodeSize;return i}marks(){let t=this.parent,e=this.index();if(t.content.size==0)return rt.none;if(this.textOffset)return t.child(e).marks;let r=t.maybeChild(e-1),i=t.maybeChild(e);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive!==!1||i&&o[s].isInSet(i.marks)||(o=o[s--].removeFromSet(o));return o}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let r=e.marks,i=t.parent.maybeChild(t.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive!==!1||i&&r[o].isInSet(i.marks)||(r=r[o--].removeFromSet(r));return r}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!e||e(this.node(r))))return new vr(this,t,r);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let r=[],i=0,o=e;for(let s=t;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(r.push(s,a,i+l),!c||(s=s.child(a),s.isText))break;o=c-1,i+=l+1}return new qe(e,r,o)}static resolveCached(t,e){for(let i=0;i<gr.length;i++){let o=gr[i];if(o.pos==e&&o.doc==t)return o}let r=gr[_n]=qe.resolve(t,e);return _n=(_n+1)%li,r}}let gr=[],_n=0,li=12;class vr{constructor(t,e,r){this.$from=t,this.$to=e,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const ci=Object.create(null);class he{constructor(t,e,r,i=rt.none){this.type=t,this.attrs=e,this.marks=i,this.content=r||S.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,r,i=0){this.content.nodesBetween(t,e,r,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,r,i){return this.content.textBetween(t,e,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,r){return this.type==t&&nt(this.attrs,e||t.defaultAttrs||ci)&&rt.sameSet(this.marks,r||rt.none)}copy(t=null){return t==this.content?this:new he(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new he(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return t==0&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,r=!1){if(t==e)return j.empty;let i=this.resolve(t),o=this.resolve(e),s=r?0:i.sharedDepth(e),a=i.start(s),l=i.node(s).content.cut(i.pos-a,o.pos-a);return new j(l,i.depth-s,o.depth-s)}replace(t,e,r){return xe(this.resolve(t),this.resolve(e),r)}nodeAt(t){for(let e=this;;){let{index:r,offset:i}=e.content.findIndex(t);if(e=e.maybeChild(r),!e)return null;if(i==t||e.isText)return e;t-=i+1}}childAfter(t){let{index:e,offset:r}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:r}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:e,offset:r}=this.content.findIndex(t);if(r<t)return{node:this.content.child(e),index:e,offset:r};let i=this.content.child(e-1);return{node:i,index:e-1,offset:r-i.nodeSize}}resolve(t){return qe.resolveCached(this,t)}resolveNoCache(t){return qe.resolve(this,t)}rangeHasMark(t,e,r){let i=!1;return e>t&&this.nodesBetween(t,e,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),ui(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,r=S.empty,i=0,o=r.childCount){let s=this.contentMatchAt(t).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(t,e,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(t).matchType(r),s=o&&o.matchFragment(this.content,e);return!!s&&s.validEnd}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let t=rt.none;for(let e=0;e<this.marks.length;e++)t=this.marks[e].addToSet(t);if(!rt.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=e.marks.map(t.markFromJSON)}if(e.type=="text"){if(typeof e.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(e.text,r)}let i=S.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,i,r)}}he.prototype.text=void 0;class qn extends he{constructor(t,e,r,i){if(super(t,e,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):ui(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new qn(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new qn(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return t==0&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function ui(n,t){for(let e=n.length-1;e>=0;e--)t=n[e].type.name+"("+t+")";return t}class Ie{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let r=new Vi(t,e);if(r.next==null)return Ie.empty;let i=$n(r);r.next&&r.err("Unexpected trailing text");let o=function(s){let a=Object.create(null);return l(Ki(s,0));function l(c){let u=[];c.forEach(p=>{s[p].forEach(({term:h,to:f})=>{if(!h)return;let m;for(let g=0;g<u.length;g++)u[g][0]==h&&(m=u[g][1]);Ki(s,f).forEach(g=>{m||u.push([h,m=[]]),m.indexOf(g)==-1&&m.push(g)})})});let d=a[c.join(",")]=new Ie(c.indexOf(s.length-1)>-1);for(let p=0;p<u.length;p++){let h=u[p][1].sort(Wi);d.next.push({type:u[p][0],next:a[h.join(",")]||l(h)})}return d}}(function(s){let a=[[]];return u(d(s,0),l()),a;function l(){return a.push([])-1}function c(p,h,f){let m={term:f,to:h};return a[p].push(m),m}function u(p,h){p.forEach(f=>f.to=h)}function d(p,h){if(p.type=="choice")return p.exprs.reduce((f,m)=>f.concat(d(m,h)),[]);if(p.type!="seq"){if(p.type=="star"){let f=l();return c(h,f),u(d(p.expr,f),f),[c(f)]}if(p.type=="plus"){let f=l();return u(d(p.expr,h),f),u(d(p.expr,f),f),[c(f)]}if(p.type=="opt")return[c(h)].concat(d(p.expr,h));if(p.type=="range"){let f=h;for(let m=0;m<p.min;m++){let g=l();u(d(p.expr,f),g),f=g}if(p.max==-1)u(d(p.expr,f),f);else for(let m=p.min;m<p.max;m++){let g=l();c(f,g),u(d(p.expr,f),g),f=g}return[c(f)]}if(p.type=="name")return[c(h,void 0,p.value)];throw new Error("Unknown expr type")}for(let f=0;;f++){let m=d(p.exprs[f],h);if(f==p.exprs.length-1)return m;u(m,h=l())}}}(i));return function(s,a){for(let l=0,c=[s];l<c.length;l++){let u=c[l],d=!u.validEnd,p=[];for(let h=0;h<u.next.length;h++){let{type:f,next:m}=u.next[h];p.push(f.name),!d||f.isText||f.hasRequiredAttrs()||(d=!1),c.indexOf(m)==-1&&c.push(m)}d&&a.err("Only non-generatable nodes ("+p.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,r),o}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,r=t.childCount){let i=this;for(let o=e;i&&o<r;o++)i=i.matchType(t.child(o).type);return i}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let r=0;r<t.next.length;r++)if(this.next[e].type==t.next[r].type)return!0;return!1}fillBefore(t,e=!1,r=0){let i=[this];return function o(s,a){let l=s.matchFragment(t,r);if(l&&(!e||l.validEnd))return S.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:d}=s.next[c];if(!u.isText&&!u.hasRequiredAttrs()&&i.indexOf(d)==-1){i.push(d);let p=o(d,a.concat(u));if(p)return p}}return null}(this,[])}findWrapping(t){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==t)return this.wrapCache[r+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(t)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];a.isLeaf||a.hasRequiredAttrs()||a.name in e||i.type&&!l.validEnd||(r.push({match:a.contentMatch,type:a,via:i}),e[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];return function e(r){t.push(r);for(let i=0;i<r.next.length;i++)t.indexOf(r.next[i].next)==-1&&e(r.next[i].next)}(this),t.map((e,r)=>{let i=r+(e.validEnd?"*":" ")+" ";for(let o=0;o<e.next.length;o++)i+=(o?", ":"")+e.next[o].type.name+"->"+t.indexOf(e.next[o].next);return i}).join(`
`)}}Ie.empty=new Ie(!0);class Vi{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function $n(n){let t=[];do t.push(ss(n));while(n.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function ss(n){let t=[];do t.push(as(n));while(n.next&&n.next!=")"&&n.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function as(n){let t=function(e){if(e.eat("(")){let r=$n(e);return e.eat(")")||e.err("Missing closing paren"),r}if(!/\W/.test(e.next)){let r=function(i,o){let s=i.nodeTypes,a=s[o];if(a)return[a];let l=[];for(let c in s){let u=s[c];u.groups.indexOf(o)>-1&&l.push(u)}return l.length==0&&i.err("No node type or group '"+o+"' found"),l}(e,e.next).map(i=>(e.inline==null?e.inline=i.isInline:e.inline!=i.isInline&&e.err("Mixing inline and block content"),{type:"name",value:i}));return e.pos++,r.length==1?r[0]:{type:"choice",exprs:r}}e.err("Unexpected token '"+e.next+"'")}(n);for(;;)if(n.eat("+"))t={type:"plus",expr:t};else if(n.eat("*"))t={type:"star",expr:t};else if(n.eat("?"))t={type:"opt",expr:t};else{if(!n.eat("{"))break;t=ls(n,t)}return t}function Ui(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let t=Number(n.next);return n.pos++,t}function ls(n,t){let e=Ui(n),r=e;return n.eat(",")&&(r=n.next!="}"?Ui(n):-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:e,max:r,expr:t}}function Wi(n,t){return t-n}function Ki(n,t){let e=[];return function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);e.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];a||e.indexOf(l)!=-1||r(l)}}(t),e.sort(Wi)}function Gi(n){let t=Object.create(null);for(let e in n){let r=n[e];if(!r.hasDefault)return null;t[e]=r.default}return t}function mn(n,t){let e=Object.create(null);for(let r in n){let i=t&&t[r];if(i===void 0){let o=n[r];if(!o.hasDefault)throw new RangeError("No value supplied for attribute "+r);i=o.default}e[r]=i}return e}function fe(n){let t=Object.create(null);if(n)for(let e in n)t[e]=new cs(n[e]);return t}class yr{constructor(t,e,r){this.name=t,this.schema=e,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=fe(r.attrs),this.defaultAttrs=Gi(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Ie.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:mn(this.attrs,t)}create(t=null,e,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new he(this,this.computeAttrs(t),S.from(e),rt.setFrom(r))}createChecked(t=null,e,r){if(e=S.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new he(this,this.computeAttrs(t),e,rt.setFrom(r))}createAndFill(t=null,e,r){if(t=this.computeAttrs(t),(e=S.from(e)).size){let s=this.contentMatch.fillBefore(e);if(!s)return null;e=s.append(e)}let i=this.contentMatch.matchFragment(e),o=i&&i.fillBefore(S.empty,!0);return o?new he(this,t,e.append(o),rt.setFrom(r)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let e;for(let r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?e&&e.push(t[r]):e||(e=t.slice(0,r));return e?e.length?e:rt.none:t}static compile(t,e){let r=Object.create(null);t.forEach((o,s)=>r[o]=new yr(o,e,s));let i=e.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}class cs{constructor(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default}get isRequired(){return!this.hasDefault}}class jn{constructor(t,e,r,i){this.name=t,this.rank=e,this.schema=r,this.spec=i,this.attrs=fe(i.attrs),this.excluded=null;let o=Gi(this.attrs);this.instance=o?new rt(this,o):null}create(t=null){return!t&&this.instance?this.instance:new rt(this,mn(this.attrs,t))}static compile(t,e){let r=Object.create(null),i=0;return t.forEach((o,s)=>r[o]=new jn(o,i++,e,s)),r}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}excludes(t){return this.excluded.indexOf(t)>-1}}class V{constructor(t){this.cached=Object.create(null),this.spec={nodes:F.from(t.nodes),marks:F.from(t.marks||{}),topNode:t.topNode},this.nodes=yr.compile(this.spec.nodes,this),this.marks=jn.compile(this.spec.marks,this);let e=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let i=this.nodes[r],o=i.spec.content||"",s=i.spec.marks;i.contentMatch=e[o]||(e[o]=Ie.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet=s=="_"?null:s?tt(this,s.split(" ")):s!=""&&i.inlineContent?null:[]}for(let r in this.marks){let i=this.marks[r],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:tt(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,r,i){if(typeof t=="string")t=this.nodeType(t);else{if(!(t instanceof yr))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,r,i)}text(t,e){let r=this.nodes.text;return new qn(r,r.defaultAttrs,t,rt.setFrom(e))}mark(t,e){return typeof t=="string"&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return he.fromJSON(this,t)}markFromJSON(t){return rt.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function tt(n,t){let e=[];for(let r=0;r<t.length;r++){let i=t[r],o=n.marks[i],s=o;if(o)e.push(o);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&e.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return e}class lt{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=t.nodes[r.node];return i.contentMatch.matchType(i)})}parse(t,e={}){let r=new wr(this,e,!1);return r.addAll(t,e.from,e.to),r.finish()}parseSlice(t,e={}){let r=new wr(this,e,!0);return r.addAll(t,e.from,e.to),j.maxOpen(r.finish())}matchTag(t,e,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(Ji(t,o.tag)&&(o.namespace===void 0||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(t);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(t,e,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(t)!=0||s.context&&!r.matchesContext(s.context)||a.length>t.length&&(a.charCodeAt(t.length)!=61||a.slice(t.length+1)!=e))){if(s.getAttrs){let l=s.getAttrs(e);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(t){let e=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<e.length;s++){let a=e[s];if((a.priority==null?50:a.priority)<o)break}e.splice(s,0,i)}for(let i in t.marks){let o=t.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Yi(s)),s.mark=i})}for(let i in t.nodes){let o=t.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Yi(s)),s.node=i})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new lt(t,lt.schemaRules(t)))}}const mt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},zt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Vn={ol:!0,ul:!0};function Un(n,t,e){return t!=null?(t?1:0)|(t==="full"?2:0):n&&n.whitespace=="pre"?3:-5&e}class br{constructor(t,e,r,i,o,s,a){this.type=t,this.attrs=e,this.marks=r,this.pendingMarks=i,this.solid=o,this.options=a,this.content=[],this.activeMarks=rt.none,this.stashMarks=[],this.match=s||(4&a?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(S.from(t));if(!e){let r,i=this.type.contentMatch;return(r=i.findWrapping(t.type))?(this.match=i,r):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)}finish(t){if(!(1&this.options)){let r,i=this.content[this.content.length-1];if(i&&i.isText&&(r=/[ \t\r\n\u000c]+$/.exec(i.text))){let o=i;i.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-r[0].length))}}let e=S.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(S.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}popFromStashMark(t){for(let e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]}applyPending(t){for(let e=0,r=this.pendingMarks;e<r.length;e++){let i=r[e];(this.type?this.type.allowsMarkType(i.type):us(i.type,t))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!mt.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class wr{constructor(t,e,r){this.parser=t,this.options=e,this.isOpen=r,this.open=0;let i,o=e.topNode,s=Un(null,e.preserveWhitespace,0)|(r?4:0);i=o?new br(o.type,o.attrs,rt.none,rt.none,!0,e.topMatch||o.type.contentMatch,s):new br(r?null:t.schema.topNodeType,null,rt.none,rt.none,!0,null,s),this.nodes=[i],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t){if(t.nodeType==3)this.addTextNode(t);else if(t.nodeType==1){let e=t.getAttribute("style"),r=e?this.readStyles(function(o){let s,a=/\s*([\w-]+)\s*:\s*([^;]+)/g,l=[];for(;s=a.exec(o);)l.push(s[1],s[2].trim());return l}(e)):null,i=this.top;if(r!=null)for(let o=0;o<r.length;o++)this.addPendingMark(r[o]);if(this.addElement(t),r!=null)for(let o=0;o<r.length;o++)this.removePendingMark(r[o],i)}}addTextNode(t){let e=t.nodeValue,r=this.top;if(2&r.options||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(e)){if(1&r.options)e=2&r.options?e.replace(/\r\n?/g,`
`):e.replace(/\r?\n|\r/g," ");else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],o=t.previousSibling;(!i||o&&o.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)}addElement(t,e){let r,i=t.nodeName.toLowerCase();Vn.hasOwnProperty(i)&&this.parser.normalizeLists&&function(s){for(let a=s.firstChild,l=null;a;a=a.nextSibling){let c=a.nodeType==1?a.nodeName.toLowerCase():null;c&&Vn.hasOwnProperty(c)&&l?(l.appendChild(a),a=l):c=="li"?l=a:c&&(l=null)}}(t);let o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(r=this.parser.matchTag(t,this,e));if(o?o.ignore:zt.hasOwnProperty(i))this.findInside(t),this.ignoreFallback(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);let s,a=this.top,l=this.needsBlock;if(mt.hasOwnProperty(i))s=!0,a.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),s&&this.sync(a),this.needsBlock=l}else this.addElementByRule(t,o,o.consuming===!1?r:void 0)}leafFallback(t){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`))}ignoreFallback(t){t.nodeName!="BR"||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))}readStyles(t){let e=rt.none;t:for(let r=0;r<t.length;r+=2)for(let i;;){let o=this.parser.matchStyle(t[r],t[r+1],this,i);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),o.consuming!==!1)break;i=o}return e}addElementByRule(t,e,r){let i,o,s;e.node?(o=this.parser.schema.nodes[e.node],o.isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):i=this.enter(o,e.attrs||null,e.preserveWhitespace)):(s=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(s));let a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(r)this.addElement(t,r);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=t;typeof e.contentElement=="string"?l=t.querySelector(e.contentElement):typeof e.contentElement=="function"?l=e.contentElement(t):e.contentElement&&(l=e.contentElement),this.findAround(t,l,!0),this.addAll(l)}i&&this.sync(a)&&this.open--,s&&this.removePendingMark(s,a)}addAll(t,e,r){let i=e||0;for(let o=e?t.childNodes[e]:t.firstChild,s=r==null?null:t.childNodes[r];o!=s;o=o.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(o);this.findAtPoint(t,i)}findPlace(t){let e,r;for(let i=this.open;i>=0;i--){let o=this.nodes[i],s=o.findWrapping(t);if(s&&(!e||e.length>s.length)&&(e=s,r=o,!s.length)||o.solid)break}if(!e)return!1;this.sync(r);for(let i=0;i<e.length;i++)this.enterInner(e[i],null,!1);return!0}insertNode(t){if(t.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();let e=this.top;e.applyPending(t.type),e.match&&(e.match=e.match.matchType(t.type));let r=e.activeMarks;for(let i=0;i<t.marks.length;i++)e.type&&!e.type.allowsMarkType(t.marks[i].type)||(r=t.marks[i].addToSet(r));return e.content.push(t.mark(r)),!0}return!1}enter(t,e,r){let i=this.findPlace(t.create(e));return i&&this.enterInner(t,e,!0,r),i}enterInner(t,e=null,r=!1,i){this.closeExtra();let o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t);let s=Un(t,i,o.options);4&o.options&&o.content.length==0&&(s|=4),this.nodes.push(new br(t,e,o.activeMarks,o.pendingMarks,r,null,s)),this.open++}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(t){for(let e=this.open;e>=0;e--)if(this.nodes[e]==t)return this.open=e,!0;return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let r=this.nodes[e].content;for(let i=r.length-1;i>=0;i--)t+=r[i].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==e&&(this.find[r].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].pos==null&&t.nodeType==1&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,r){if(t!=e&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&e.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),r=this.options.context,i=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let c=e[a];if(c==""){if(a==e.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return s(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let e in this.parser.schema.nodes){let r=this.parser.schema.nodes[e];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(t){let e=function(r,i){for(let o=0;o<i.length;o++)if(r.eq(i[o]))return i[o]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)}removePendingMark(t,e){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(t)>-1)i.pendingMarks=t.removeFromSet(i.pendingMarks);else{i.activeMarks=t.removeFromSet(i.activeMarks);let o=i.popFromStashMark(t);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==e)break}}}function Ji(n,t){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,t)}function Yi(n){let t={};for(let e in n)t[e]=n[e];return t}function us(n,t){let e=t.schema.nodes;for(let r in e){let i=e[r];if(!i.allowsMarkType(n))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==t||o.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}class Ne{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},r){r||(r=di(e).createDocumentFragment());let i=r,o=[];return t.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(this.marks[c.type.name]){if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}else l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,e);u&&(o.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(s,e))}),r}serializeNodeInner(t,e){let{dom:r,contentDOM:i}=Ne.renderSpec(di(e),this.nodes[t.type.name](t));if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,i)}return r}serializeNode(t,e={}){let r=this.serializeNodeInner(t,e);for(let i=t.marks.length-1;i>=0;i--){let o=this.serializeMark(t.marks[i],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(t,e,r={}){let i=this.marks[t.type.name];return i&&Ne.renderSpec(di(r),i(t,e))}static renderSpec(t,e,r=null){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i,o=e[0],s=o.indexOf(" ");s>0&&(r=o.slice(0,s),o=o.slice(s+1));let a=r?t.createElementNS(r,o):t.createElement(o),l=e[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let u in l)if(l[u]!=null){let d=u.indexOf(" ");d>0?a.setAttributeNS(u.slice(0,d),u.slice(d+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<e.length;u++){let d=e[u];if(d===0){if(u<e.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}{let{dom:p,contentDOM:h}=Ne.renderSpec(t,d,r);if(a.appendChild(p),h){if(i)throw new RangeError("Multiple content holes");i=h}}}return{dom:a,contentDOM:i}}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new Ne(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=Qi(t.nodes);return e.text||(e.text=r=>r.text),e}static marksFromSchema(t){return Qi(t.marks)}}function Qi(n){let t={};for(let e in n){let r=n[e].spec.toDOM;r&&(t[e]=r)}return t}function di(n){return n.document||window.document}var kr=b(956),xr=b.n(kr),ds=b(969),pi=b.n(ds),hi=b(522),ae=b.n(hi),$e=b(204),me=b.n($e),Cr=b(462),re=b.n(Cr),ps=b(758),gn=b.n(ps),hs=b(321),Oe=b.n(hs),Xi=b(929),_t=b.n(Xi),fi=b(934),Wn=b.n(fi),fs=b(391),ms=b.n(fs),gs=/[\u0020]+/g,Zi=/[>(){}[\]+-.!#|]/g,Er=/<([a-zA-Z_][a-zA-Z0-9\-._]*)(\s|[^\\>])*\/?>|<(\/)([a-zA-Z_][a-zA-Z0-9\-._]*)\s*\/?>|<!--[^-]+-->|<([a-zA-Z_][a-zA-Z0-9\-.:/]*)>/g,Ot=/\\[!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~\\]/g,to=/[*_~`]/g,Lt=/!\[.*\]\(.*\)/g,eo=/[[\]]/g,Tr=/(?:^|[^\\])\\(?!\\)/g,Sr=new RegExp('[&<>"]',"g");function no(n){switch(n){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";default:return n}}function je(n){return Sr.test(n)?n.replace(Sr,no):n}function St(n,t){return n.indexOf(t)!==-1}var vn=["rel","target","hreflang","type"],yn={codeblock:/(^ {4}[^\n]+\n*)+/,thematicBreak:/^ *((\* *){3,}|(- *){3,} *|(_ *){3,}) */,atxHeading:/^(#{1,6}) +[\s\S]+/,seTextheading:/^([^\n]+)\n *(=|-){2,} */,blockquote:/^( *>[^\n]+.*)+/,list:/^ *(\*+|-+|\d+\.) [\s\S]+/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? */,link:/!?\[.*\]\(.*\)/,reflink:/!?\[.*\]\s*\[([^\]]*)\]/,verticalBar:/\u007C/,fencedCodeblock:/^((`|~){3,})/};function Mr(n){if(!n)return null;var t={};return vn.forEach(function(e){_t()(n[e])||(t[e]=n[e])}),t}function bn(n,t){for(var e="",r=0;r<t;r+=1)e+=n;return e}function Le(n){for(var t=[],e=Lt.exec(n);e;)t.push([e.index,e.index+e[0].length]),e=Lt.exec(n);return n.replace(eo,function(r,i){var o=t.some(function(s){return i>s[0]&&i<s[1]});return o?r:"\\"+r})}function Ir(n){var t=function(r){return"\\"+r},e=n.replace(gs," ");return Ot.test(e)&&(e=e.replace(Ot,t)),Tr.test(e)&&(e=e.replace(Tr,function(r){return r+"\\"})),e=e.replace(to,t),Er.test(e)&&(e=e.replace(Er,t)),function(r){var i=!1;return xr()(yn,function(o){return o.test(r)&&(i=!0),!i}),i}(e)&&(e=e.replace(Zi,t)),e}function Nr(n){return Wn()(n)||_t()(n)}function wn(n,t){if(n===null&&n===t)return!0;if(typeof n!="object"||typeof t!="object"||Nr(n)||Nr(t))return n===t;for(var e in n)if(n[e]!==t[e])return!1;for(var e in t)if(!(e in n))return!1;return!0}function At(n){return n[n.length-1]}function Kn(n){return typeof n=="object"&&n!==null}function Ve(n,t){var e=v({},n);return n&&t&&Object.keys(t).forEach(function(r){Kn(e[r])?Array.isArray(t[r])?e[r]=Ue(t[r]):e.hasOwnProperty(r)?e[r]=Ve(e[r],t[r]):e[r]=We(t[r]):e[r]=t[r]}),e}function Ue(n){return n.map(function(t){return Kn(t)?Array.isArray(t)?Ue(t):We(t):t})}function We(n){var t=Object.keys(n);return t.length?t.reduce(function(e,r){return Kn(n[r])?e[r]=Array.isArray(n[r])?Ue(n[r]):We(n[r]):e[r]=n[r],e},{}):n}function Or(n,t){return t===void 0&&(t={}),Object.keys(t).forEach(function(e){n.hasOwnProperty(e)&&typeof n[e]=="object"?Array.isArray(t[e])?n[e]=t[e]:Or(n[e],t[e]):n[e]=t[e]}),n}function mi(n,t){return n>t?[t,n]:[n,t]}const gi=Math.pow(2,16);function vi(n,t){return n+t*gi}function yi(n){return 65535&n}class Gn{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class Xt{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&Xt.empty)return Xt.empty}recover(t){let e=0,r=yi(t);if(!this.inverted)for(let i=0;i<r;i++)e+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*r]+e+function(i){return(i-(65535&i))/gi}(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>t)break;let c=this.ranges[a+o],u=this.ranges[a+s],d=l+c;if(t<=d){let p=l+i+((c?t==l?-1:t==d?1:e:e)<0?0:u);if(r)return p;let h=t==(e<0?l:d)?null:vi(a/3,t-l),f=t==l?2:t==d?1:4;return(e<0?t!=l:t!=d)&&(f|=8),new Gn(p,f,h)}i+=u-c}return r?t+i:new Gn(t+i,0,null)}touches(t,e){let r=0,i=yi(e),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>t)break;let c=this.ranges[a+o];if(t<=l+c&&a==3*i)return!0;r+=this.ranges[a+s]-c}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[i+e],u=this.ranges[i+r];t(a,a+c,l,l+u),o+=u-c}}invert(){return new Xt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?Xt.empty:new Xt(t<0?[0,-t,0]:[0,0,t])}}Xt.empty=new Xt([]);class ie{constructor(t=[],e,r=0,i=t.length){this.maps=t,this.mirror=e,this.from=r,this.to=i}slice(t=0,e=this.maps.length){return new ie(this.maps,this.mirror,t,e)}copy(){return new ie(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(t,e){this.to=this.maps.push(t),e!=null&&this.setMirror(this.maps.length-1,e)}appendMapping(t){for(let e=0,r=this.maps.length;e<t.maps.length;e++){let i=t.getMirror(e);this.appendMap(t.maps[e],i!=null&&i<e?r+i:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,r=this.maps.length+t.maps.length;e>=0;e--){let i=t.getMirror(e);this.appendMap(t.maps[e].invert(),i!=null&&i>e?r-i-1:void 0)}}invert(){let t=new ie;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let r=this.from;r<this.to;r++)t=this.maps[r].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this.maps[o].mapResult(t,e);if(s.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,t=this.maps[a].recover(s.recover);continue}}i|=s.delInfo,t=s.pos}return r?t:new Gn(t,i,null)}}const kn=Object.create(null);class Ae{getMap(){return Xt.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=kn[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in kn)throw new RangeError("Duplicate use of step JSON ID "+t);return kn[t]=e,e.prototype.jsonID=t,e}}class Dt{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new Dt(t,null)}static fail(t){return new Dt(null,t)}static fromReplace(t,e,r,i){try{return Dt.ok(t.replace(e,r,i))}catch(o){if(o instanceof Ct)return Dt.fail(o.message);throw o}}}function bi(n,t,e){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(bi(o.content,t,o))),o.isInline&&(o=t(o,e,i)),r.push(o)}return S.fromArray(r)}class Ke extends Ae{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new j(bi(e.content,(s,a)=>s.isAtom&&a.type.allowsMarkType(this.mark.type)?s.mark(this.mark.addToSet(s.marks)):s,i),e.openStart,e.openEnd);return Dt.fromReplace(t,this.from,this.to,o)}invert(){return new Ut(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new Ke(e.pos,r.pos,this.mark)}merge(t){return t instanceof Ke&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Ke(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ke(e.from,e.to,t.markFromJSON(e.mark))}}Ae.jsonID("addMark",Ke);class Ut extends Ae{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new j(bi(e.content,i=>i.mark(this.mark.removeFromSet(i.marks)),t),e.openStart,e.openEnd);return Dt.fromReplace(t,this.from,this.to,r)}invert(){return new Ke(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new Ut(e.pos,r.pos,this.mark)}merge(t){return t instanceof Ut&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Ut(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ut(e.from,e.to,t.markFromJSON(e.mark))}}Ae.jsonID("removeMark",Ut);class xt extends Ae{constructor(t,e,r,i=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=i}apply(t){return this.structure&&Jn(t,this.from,this.to)?Dt.fail("Structure replace would overwrite content"):Dt.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Xt([this.from,this.to-this.from,this.slice.size])}invert(t){return new xt(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new xt(e.pos,Math.max(e.pos,r.pos),this.slice)}merge(t){if(!(t instanceof xt)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;{let e=this.slice.size+t.slice.size==0?j.empty:new j(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new xt(t.from,this.to,e,this.structure)}}{let e=this.slice.size+t.slice.size==0?j.empty:new j(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new xt(this.from,this.to+(t.to-t.from),e,this.structure)}}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new xt(e.from,e.to,j.fromJSON(t,e.slice),!!e.structure)}}Ae.jsonID("replace",xt);class Mt extends Ae{constructor(t,e,r,i,o,s,a=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(t){if(this.structure&&(Jn(t,this.from,this.gapFrom)||Jn(t,this.gapTo,this.to)))return Dt.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return Dt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?Dt.fromReplace(t,this.from,this.to,r):Dt.fail("Content does not fit in gap")}getMap(){return new Xt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new Mt(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),i=t.map(this.gapFrom,-1),o=t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||i<e.pos||o>r.pos?null:new Mt(e.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Mt(e.from,e.to,e.gapFrom,e.gapTo,j.fromJSON(t,e.slice),e.insert,!!e.structure)}}function Jn(n,t,e){let r=n.resolve(t),i=e-t,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function ro(n,t,e){return(t==0||n.canReplace(t,n.childCount))&&(e==n.childCount||n.canReplace(0,e))}function Yn(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let e=n.depth;;--e){let r=n.$from.node(e),i=n.$from.index(e),o=n.$to.indexAfter(e);if(e<n.depth&&r.canReplace(i,o,t))return e;if(e==0||r.type.spec.isolating||!ro(r,i,o))break}return null}function Qn(n){return{type:n,attrs:null}}function Ge(n,t,e=1,r){let i=n.resolve(t),o=i.depth-e,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=e-2;c>o;c--,u--){let d=i.node(c),p=i.index(c);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(p,d.childCount),f=r&&r[u]||d;if(f!=d&&(h=h.replaceChild(0,f.type.create(f.attrs))),!d.canReplace(p+1,d.childCount)||!f.type.validContent(h))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function io(n,t){let e=n.resolve(t),r=e.index();return De(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function De(n,t){return!(!n||!t||n.isLeaf||!n.canAppend(t))}function Lr(n,t,e=t,r=j.empty){if(t==e&&!r.size)return null;let i=n.resolve(t),o=n.resolve(e);return wi(i,o,r)?new xt(t,e,r):new oo(i,o,r).fit()}function wi(n,t,e){return!e.openStart&&!e.openEnd&&n.start()==t.start()&&n.parent.canReplace(n.index(),t.index(),e.content)}Ae.jsonID("replaceAround",Mt);class oo{constructor(t,e,r){this.$from=t,this.$to=e,this.unplaced=r,this.frontier=[],this.placed=S.empty;for(let i=0;i<=t.depth;i++){let o=t.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(t.indexAfter(i))})}for(let i=t.depth;i>0;i--)this.placed=S.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(t<0?this.$to:r.doc.resolve(t));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new j(o,s,a);return t>-1?new Mt(r.pos,t,this.$to.pos,this.$to.end(),l,e):l.size||r.pos!=this.$to.pos?new xt(r.pos,i.pos,l):null}findFittable(){for(let t=1;t<=2;t++)for(let e=this.unplaced.openStart;e>=0;e--){let r,i=null;e?(i=ge(this.unplaced.content,e-1).firstChild,r=i.content):r=this.unplaced.content;let o=r.firstChild;for(let s=this.depth;s>=0;s--){let a,{type:l,match:c}=this.frontier[s],u=null;if(t==1&&(o?c.matchType(o.type)||(u=c.fillBefore(S.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:e,frontierDepth:s,parent:i,inject:u};if(t==2&&o&&(a=c.findWrapping(o.type)))return{sliceDepth:e,frontierDepth:s,parent:i,wrap:a};if(i&&c.matchType(i.type))break}}}openMore(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=ge(t,e);return!(!i.childCount||i.firstChild.isLeaf)&&(this.unplaced=new j(t,e+1,Math.max(r,i.size+e>=t.size-r?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=ge(t,e);if(i.childCount<=1&&e>0){let o=t.size-e<=e+i.size;this.unplaced=new j(Xn(t,e-1,1),e-1,o?e-1:r)}else this.unplaced=new j(Xn(t,e,1),e,r)}placeNodes({sliceDepth:t,frontierDepth:e,parent:r,inject:i,wrap:o}){for(;this.depth>e;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-t,c=0,u=[],{match:d,type:p}=this.frontier[e];if(i){for(let m=0;m<i.childCount;m++)u.push(i.child(m));d=d.matchFragment(i)}let h=a.size+t-(s.content.size-s.openEnd);for(;c<a.childCount;){let m=a.child(c),g=d.matchType(m.type);if(!g)break;c++,(c>1||l==0||m.content.size)&&(d=g,u.push(ki(m.mark(p.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?h:-1)))}let f=c==a.childCount;f||(h=-1),this.placed=Re(this.placed,e,S.from(u)),this.frontier[e].match=d,f&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<h;m++){let w=g.lastChild;this.frontier.push({type:w.type,match:w.contentMatchAt(w.childCount)}),g=w.content}this.unplaced=f?t==0?j.empty:new j(Xn(s.content,t-1,1),t-1,h<0?s.openEnd:t-1):new j(Xn(s.content,t,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t,e=this.frontier[this.depth];if(!e.type.isTextblock||!Ar(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:r,type:i}=this.frontier[e],o=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),s=Ar(t,e,i,r,o);if(s){for(let a=e-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Ar(t,a,c,l,!0);if(!u||u.childCount)continue t}return{depth:e,fit:s,move:o?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=Re(this.placed,e.depth,e.fit)),t=e.move;for(let r=e.depth+1;r<=t.depth;r++){let i=t.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,t.index(r));this.openFrontierNode(i.type,i.attrs,o)}return t}openFrontierNode(t,e=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=Re(this.placed,this.depth,S.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(S.empty,!0);t.childCount&&(this.placed=Re(this.placed,this.frontier.length,t))}}function Xn(n,t,e){return t==0?n.cutByIndex(e,n.childCount):n.replaceChild(0,n.firstChild.copy(Xn(n.firstChild.content,t-1,e)))}function Re(n,t,e){return t==0?n.append(e):n.replaceChild(n.childCount-1,n.lastChild.copy(Re(n.lastChild.content,t-1,e)))}function ge(n,t){for(let e=0;e<t;e++)n=n.firstChild.content;return n}function ki(n,t,e){if(t<=0)return n;let r=n.content;return t>1&&(r=r.replaceChild(0,ki(r.firstChild,t-1,r.childCount==1?e-1:0))),t>0&&(r=n.type.contentMatch.fillBefore(r).append(r),e<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(S.empty,!0)))),n.copy(r)}function Ar(n,t,e,r,i){let o=n.node(t),s=i?n.indexAfter(t):n.index(t);if(s==o.childCount&&!e.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!function(l,c,u){for(let d=u;d<c.childCount;d++)if(!l.allowsMarks(c.child(d).marks))return!0;return!1}(e,o.content,s)?a:null}function so(n){return n.spec.defining||n.spec.definingForContent}function ao(n,t,e,r,i){if(t<e){let o=n.firstChild;n=n.replaceChild(0,o.copy(ao(o.content,t+1,e,r,o)))}if(t>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(S.empty,!0))}return n}function I(n,t){let e=[];for(let r=Math.min(n.depth,t.depth);r>=0;r--){let i=n.start(r);if(i<n.pos-(n.depth-r)||t.end(r)>t.pos+(t.depth-r)||n.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(i==t.start(r)||r==n.depth&&r==t.depth&&n.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==i-1)&&e.push(r)}return e}let W=class extends Error{};W=function n(t){let e=Error.call(this,t);return e.__proto__=n.prototype,e},(W.prototype=Object.create(Error.prototype)).constructor=W,W.prototype.name="TransformError";const U=Object.create(null);class G{constructor(t,e,r){this.$anchor=t,this.$head=e,this.ranges=r||[new yt(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=j.empty){let r=e.content.lastChild,i=null;for(let a=0;a<e.openEnd;a++)i=r,r=r.lastChild;let o=t.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=t.mapping.slice(o);t.replaceRange(u.map(l.pos),u.map(c.pos),a?j.empty:e),a==0&&gl(t,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,e){let r=t.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=t.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);o?t.deleteRange(c,u):(t.replaceRangeWith(c,u,e),gl(t,r,e.isInline?-1:1))}}static findFrom(t,e,r=!1){let i=t.parent.inlineContent?new dt(t):Dr(t.node(0),t.parent,t.pos,t.index(),e,r);if(i)return i;for(let o=t.depth-1;o>=0;o--){let s=e<0?Dr(t.node(0),t.node(o),t.before(o+1),t.index(o),e,r):Dr(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,r);if(s)return s}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new Zt(t.node(0))}static atStart(t){return Dr(t,t,0,0,1)||new Zt(t)}static atEnd(t){return Dr(t,t,t.content.size,t.childCount,-1)||new Zt(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=U[e.type];if(!r)throw new RangeError(`No selection type ${e.type} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in U)throw new RangeError("Duplicate use of selection JSON ID "+t);return U[t]=e,e.prototype.jsonID=t,e}getBookmark(){return dt.between(this.$anchor,this.$head).getBookmark()}}G.prototype.visible=!0;class yt{constructor(t,e){this.$from=t,this.$to=e}}let qt=!1;function It(n){qt||n.parent.inlineContent||(qt=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class dt extends G{constructor(t,e=t){It(t),It(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let r=t.resolve(e.map(this.head));if(!r.parent.inlineContent)return G.near(r);let i=t.resolve(e.map(this.anchor));return new dt(i.parent.inlineContent?i:r,r)}replace(t,e=j.empty){if(super.replace(t,e),e==j.empty){let r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}}eq(t){return t instanceof dt&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new Wt(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if(typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new dt(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,r=e){let i=t.resolve(e);return new this(i,r==e?i:t.resolve(r))}static between(t,e,r){let i=t.pos-e.pos;if(r&&!i||(r=i>=0?1:-1),!e.parent.inlineContent){let o=G.findFrom(e,r,!0)||G.findFrom(e,-r,!0);if(!o)return G.near(e,r);e=o.$head}return t.parent.inlineContent||(i==0||(t=(G.findFrom(t,-r,!0)||G.findFrom(t,r,!0)).$anchor).pos<e.pos!=i<0)&&(t=e),new dt(t,e)}}G.jsonID("text",dt);class Wt{constructor(t,e){this.anchor=t,this.head=e}map(t){return new Wt(t.map(this.anchor),t.map(this.head))}resolve(t){return dt.between(t.resolve(this.anchor),t.resolve(this.head))}}class at extends G{constructor(t){let e=t.nodeAfter,r=t.node(0).resolve(t.pos+e.nodeSize);super(t,r),this.node=e}map(t,e){let{deleted:r,pos:i}=e.mapResult(this.anchor),o=t.resolve(i);return r?G.near(o):new at(o)}content(){return new j(S.from(this.node),0,0)}eq(t){return t instanceof at&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new xi(this.anchor)}static fromJSON(t,e){if(typeof e.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new at(t.resolve(e.anchor))}static create(t,e){return new at(t.resolve(e))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}at.prototype.visible=!1,G.jsonID("node",at);class xi{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:r}=t.mapResult(this.anchor);return e?new Wt(r,r):new xi(r)}resolve(t){let e=t.resolve(this.anchor),r=e.nodeAfter;return r&&at.isSelectable(r)?new at(e):G.near(e)}}class Zt extends G{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=j.empty){if(e==j.empty){t.delete(0,t.doc.content.size);let r=G.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new Zt(t)}map(t){return new Zt(t)}eq(t){return t instanceof Zt}getBookmark(){return Ch}}G.jsonID("all",Zt);const Ch={map(){return this},resolve:n=>new Zt(n)};function Dr(n,t,e,r,i,o=!1){if(t.inlineContent)return dt.create(n,e);for(let s=r-(i>0?0:1);i>0?s<t.childCount:s>=0;s+=i){let a=t.child(s);if(a.isAtom){if(!o&&at.isSelectable(a))return at.create(n,e-(i<0?a.nodeSize:0))}else{let l=Dr(n,a,e+i,i<0?a.childCount:0,i,o);if(l)return l}e+=a.nodeSize*i}return null}function gl(n,t,e){let r=n.steps.length-1;if(r<t)return;let i,o=n.steps[r];(o instanceof xt||o instanceof Mt)&&(n.mapping.maps[r].forEach((s,a,l,c)=>{i==null&&(i=c)}),n.setSelection(G.near(n.doc.resolve(i),e)))}class Eh extends class{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new ie}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new W(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,r=j.empty){let i=Lr(this.doc,t,e,r);return i&&this.step(i),this}replaceWith(t,e,r){return this.replace(t,e,new j(S.from(r),0,0))}delete(t,e){return this.replace(t,e,j.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,r){return function(i,o,s,a){if(!a.size)return i.deleteRange(o,s);let l=i.doc.resolve(o),c=i.doc.resolve(s);if(wi(l,c,a))return i.step(new xt(o,s,a));let u=I(l,i.doc.resolve(s));u[u.length-1]==0&&u.pop();let d=-(l.depth+1);u.unshift(d);for(let g=l.depth,w=l.pos-1;g>0;g--,w--){let C=l.node(g).type.spec;if(C.defining||C.definingAsContext||C.isolating)break;u.indexOf(g)>-1?d=g:l.before(g)==w&&u.splice(1,0,-g)}let p=u.indexOf(d),h=[],f=a.openStart;for(let g=a.content,w=0;;w++){let C=g.firstChild;if(h.push(C),w==a.openStart)break;g=C.content}for(let g=f-1;g>=0;g--){let w=h[g].type,C=so(w);if(C&&l.node(p).type!=w)f=g;else if(C||!w.isTextblock)break}for(let g=a.openStart;g>=0;g--){let w=(g+f+1)%(a.openStart+1),C=h[w];if(C)for(let E=0;E<u.length;E++){let L=u[(E+p)%u.length],P=!0;L<0&&(P=!1,L=-L);let A=l.node(L-1),H=l.index(L-1);if(A.canReplaceWith(H,H,C.type,C.marks))return i.replace(l.before(L),P?c.after(L):s,new j(ao(a.content,0,a.openStart,w),w,a.openEnd))}}let m=i.steps.length;for(let g=u.length-1;g>=0&&(i.replace(o,s,a),!(i.steps.length>m));g--){let w=u[g];w<0||(o=l.before(w),s=c.after(w))}}(this,t,e,r),this}replaceRangeWith(t,e,r){return function(i,o,s,a){if(!a.isInline&&o==s&&i.doc.resolve(o).parent.content.size){let l=function(c,u,d){let p=c.resolve(u);if(p.parent.canReplaceWith(p.index(),p.index(),d))return u;if(p.parentOffset==0)for(let h=p.depth-1;h>=0;h--){let f=p.index(h);if(p.node(h).canReplaceWith(f,f,d))return p.before(h+1);if(f>0)return null}if(p.parentOffset==p.parent.content.size)for(let h=p.depth-1;h>=0;h--){let f=p.indexAfter(h);if(p.node(h).canReplaceWith(f,f,d))return p.after(h+1);if(f<p.node(h).childCount)return null}return null}(i.doc,o,a.type);l!=null&&(o=s=l)}i.replaceRange(o,s,new j(S.from(a),0,0))}(this,t,e,r),this}deleteRange(t,e){return function(r,i,o){let s=r.doc.resolve(i),a=r.doc.resolve(o),l=I(s,a);for(let c=0;c<l.length;c++){let u=l[c],d=c==l.length-1;if(d&&u==0||s.node(u).type.contentMatch.validEnd)return r.delete(s.start(u),a.end(u));if(u>0&&(d||s.node(u-1).canReplace(s.index(u-1),a.indexAfter(u-1))))return r.delete(s.before(u),a.after(u))}for(let c=1;c<=s.depth&&c<=a.depth;c++)if(i-s.start(c)==s.depth-c&&o>s.end(c)&&a.end(c)-o!=a.depth-c)return r.delete(s.before(c),o);r.delete(i,o)}(this,t,e),this}lift(t,e){return function(r,i,o){let{$from:s,$to:a,depth:l}=i,c=s.before(l+1),u=a.after(l+1),d=c,p=u,h=S.empty,f=0;for(let w=l,C=!1;w>o;w--)C||s.index(w)>0?(C=!0,h=S.from(s.node(w).copy(h)),f++):d--;let m=S.empty,g=0;for(let w=l,C=!1;w>o;w--)C||a.after(w+1)<a.end(w)?(C=!0,m=S.from(a.node(w).copy(m)),g++):p++;r.step(new Mt(d,p,c,u,new j(h.append(m),f,g),h.size-f,!0))}(this,t,e),this}join(t,e=1){return function(r,i,o){let s=new xt(i-o,i+o,j.empty,!0);r.step(s)}(this,t,e),this}wrap(t,e){return function(r,i,o){let s=S.empty;for(let c=o.length-1;c>=0;c--){if(s.size){let u=o[c].type.contentMatch.matchFragment(s);if(!u||!u.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}s=S.from(o[c].type.create(o[c].attrs,s))}let a=i.start,l=i.end;r.step(new Mt(a,l,a,l,new j(s,0,0),o.length,!0))}(this,t,e),this}setBlockType(t,e=t,r,i=null){return function(o,s,a,l,c){if(!l.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let u=o.steps.length;o.doc.nodesBetween(s,a,(d,p)=>{if(d.isTextblock&&!d.hasMarkup(l,c)&&function(h,f,m){let g=h.resolve(f),w=g.index();return g.parent.canReplaceWith(w,w+1,m)}(o.doc,o.mapping.slice(u).map(p),l)){o.clearIncompatible(o.mapping.slice(u).map(p,1),l);let h=o.mapping.slice(u),f=h.map(p,1),m=h.map(p+d.nodeSize,1);return o.step(new Mt(f,m,f+1,m-1,new j(S.from(l.create(c,null,d.marks)),0,0),1,!0)),!1}})}(this,t,e,r,i),this}setNodeMarkup(t,e,r=null,i=[]){return function(o,s,a,l,c){let u=o.doc.nodeAt(s);if(!u)throw new RangeError("No node at given position");a||(a=u.type);let d=a.create(l,null,c||u.marks);if(u.isLeaf)return o.replaceWith(s,s+u.nodeSize,d);if(!a.validContent(u.content))throw new RangeError("Invalid content for node type "+a.name);o.step(new Mt(s,s+u.nodeSize,s+1,s+u.nodeSize-1,new j(S.from(d),0,0),1,!0))}(this,t,e,r,i),this}split(t,e=1,r){return function(i,o,s=1,a){let l=i.doc.resolve(o),c=S.empty,u=S.empty;for(let d=l.depth,p=l.depth-s,h=s-1;d>p;d--,h--){c=S.from(l.node(d).copy(c));let f=a&&a[h];u=S.from(f?f.type.create(f.attrs,u):l.node(d).copy(u))}i.step(new xt(o,o,new j(c.append(u),s,s),!0))}(this,t,e,r),this}addMark(t,e,r){return function(i,o,s,a){let l,c,u=[],d=[];i.doc.nodesBetween(o,s,(p,h,f)=>{if(!p.isInline)return;let m=p.marks;if(!a.isInSet(m)&&f.type.allowsMarkType(a.type)){let g=Math.max(h,o),w=Math.min(h+p.nodeSize,s),C=a.addToSet(m);for(let E=0;E<m.length;E++)m[E].isInSet(C)||(l&&l.to==g&&l.mark.eq(m[E])?l.to=w:u.push(l=new Ut(g,w,m[E])));c&&c.to==g?c.to=w:d.push(c=new Ke(g,w,a))}}),u.forEach(p=>i.step(p)),d.forEach(p=>i.step(p))}(this,t,e,r),this}removeMark(t,e,r){return function(i,o,s,a){let l=[],c=0;i.doc.nodesBetween(o,s,(u,d)=>{if(!u.isInline)return;c++;let p=null;if(a instanceof jn){let h,f=u.marks;for(;h=a.isInSet(f);)(p||(p=[])).push(h),f=h.removeFromSet(f)}else a?a.isInSet(u.marks)&&(p=[a]):p=u.marks;if(p&&p.length){let h=Math.min(d+u.nodeSize,s);for(let f=0;f<p.length;f++){let m,g=p[f];for(let w=0;w<l.length;w++){let C=l[w];C.step==c-1&&g.eq(l[w].style)&&(m=C)}m?(m.to=h,m.step=c):l.push({style:g,from:Math.max(d,o),to:h,step:c})}}}),l.forEach(u=>i.step(new Ut(u.from,u.to,u.style)))}(this,t,e,r),this}clearIncompatible(t,e,r){return function(i,o,s,a=s.contentMatch){let l=i.doc.nodeAt(o),c=[],u=o+1;for(let d=0;d<l.childCount;d++){let p=l.child(d),h=u+p.nodeSize,f=a.matchType(p.type);if(f){a=f;for(let m=0;m<p.marks.length;m++)s.allowsMarkType(p.marks[m].type)||i.step(new Ut(u,h,p.marks[m]))}else c.push(new xt(u,h,j.empty));u=h}if(!a.validEnd){let d=a.fillBefore(S.empty,!0);i.replace(u,u,new j(d,0,0))}for(let d=c.length-1;d>=0;d--)i.step(c[d])}(this,t,e,r),this}}{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=2,this}ensureMarks(t){return rt.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(t,e){super.addStep(t,e),this.updated=-3&this.updated,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let r=this.selection;return e&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||rt.none))),r.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,r){let i=this.doc.type.schema;if(e==null)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(r==null&&(r=e),r=r??e,!t)return this.deleteRange(e,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(e);o=r==e?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(e,r,i.text(t,o)),this.selection.empty||this.setSelection(G.near(this.selection.$to)),this}}setMeta(t,e){return this.meta[typeof t=="string"?t:t.key]=e,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function vl(n,t){return t&&n?n.bind(t):n}class Ci{constructor(t,e,r){this.name=t,this.init=vl(e.init,r),this.apply=vl(e.apply,r)}}const Th=[new Ci("doc",{init:n=>n.doc||n.schema.topNodeType.createAndFill(),apply:n=>n.doc}),new Ci("selection",{init:(n,t)=>n.selection||G.atStart(t.doc),apply:n=>n.selection}),new Ci("storedMarks",{init:n=>n.storedMarks||null,apply:(n,t,e,r)=>r.selection.$cursor?n.storedMarks:null}),new Ci("scrollToSelection",{init:()=>0,apply:(n,t)=>n.scrolledIntoView?t+1:t})];class vs{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Th.slice(),e&&e.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Ci(r.key,r.spec.state,r))})}}class Zn{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=e){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],r=this.applyInner(t),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,c=i?i[s].state:this,u=l<e.length&&a.spec.appendTransaction.call(a,l?e.slice(l):e,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",t),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:r,n:e.length}:{state:this,n:0})}e.push(u),r=r.applyInner(u),o=!0}i&&(i[s]={state:r,n:e.length})}}if(!o)return{state:r,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new Zn(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];e[o.name]=o.apply(t,this[o.name],this,e)}return e}get tr(){return new Eh(this)}static create(t){let e=new vs(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new Zn(e);for(let i=0;i<e.fields.length;i++)r[e.fields[i].name]=e.fields[i].init(t,r);return r}reconfigure(t){let e=new vs(this.schema,t.plugins),r=e.fields,i=new Zn(e);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(t,i)}return i}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(r=>r.toJSON())),t&&typeof t=="object")for(let r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[r],o=i.spec.state;o&&o.toJSON&&(e[r]=o.toJSON.call(i,this[i.key]))}return e}static fromJSON(t,e,r){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new vs(t.schema,t.plugins),o=new Zn(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=he.fromJSON(t.schema,e.doc);else if(s.name=="selection")o.selection=G.fromJSON(o.doc,e.selection);else if(s.name=="storedMarks")e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(e,a))return void(o[s.name]=c.fromJSON.call(l,t,e[a],o))}o[s.name]=s.init(t,o)}}),o}}function yl(n,t,e){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(t):r=="handleDOMEvents"&&(i=yl(i,t,{})),e[r]=i}return e}class le{constructor(t){this.spec=t,this.props={},t.props&&yl(t.props,this,this.props),this.key=t.key?t.key.key:bl("plugin")}getState(t){return t[this.key]}}const ys=Object.create(null);function bl(n){return n in ys?n+"$"+ ++ys[n]:(ys[n]=0,n+"$")}class Ei{constructor(t="key"){this.key=bl(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const xn=typeof navigator<"u"?navigator:null,wl=typeof document<"u"?document:null,Cn=xn&&xn.userAgent||"",bs=/Edge\/(\d+)/.exec(Cn),kl=/MSIE \d/.exec(Cn),ws=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Cn),ve=!!(kl||ws||bs),En=kl?document.documentMode:ws?+ws[1]:bs?+bs[1]:0,Je=!ve&&/gecko\/(\d+)/i.test(Cn);Je&&(/Firefox\/(\d+)/.exec(Cn)||[0,0])[1];const ks=!ve&&/Chrome\/(\d+)/.exec(Cn),oe=!!ks,Sh=ks?+ks[1]:0,ce=!ve&&!!xn&&/Apple Computer/.test(xn.vendor),Rr=ce&&(/Mobile\/\w+/.test(Cn)||!!xn&&xn.maxTouchPoints>2),Ee=Rr||!!xn&&/Mac/.test(xn.platform),Ye=/Android \d/.test(Cn),lo=!!wl&&"webkitFontSmoothing"in wl.documentElement.style,Mh=lo?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,ye=function(n){for(var t=0;;t++)if(!(n=n.previousSibling))return t},xs=function(n){let t=n.assignedSlot||n.parentNode;return t&&t.nodeType==11?t.host:t};let xl=null;const nn=function(n,t,e){let r=xl||(xl=document.createRange());return r.setEnd(n,e??n.nodeValue.length),r.setStart(n,t||0),r},Ti=function(n,t,e,r){return e&&(Cl(n,t,e,r,-1)||Cl(n,t,e,r,1))},Ih=/^(img|br|input|textarea|hr)$/i;function Cl(n,t,e,r,i){for(;;){if(n==e&&t==r)return!0;if(t==(i<0?0:Qe(n))){let o=n.parentNode;if(!o||o.nodeType!=1||Nh(n)||Ih.test(n.nodeName)||n.contentEditable=="false")return!1;t=ye(n)+(i<0?0:1),n=o}else{if(n.nodeType!=1||(n=n.childNodes[t+(i<0?-1:0)]).contentEditable=="false")return!1;t=i<0?Qe(n):0}}}function Qe(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Nh(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const Cs=function(n){let t=n.isCollapsed;return t&&oe&&n.rangeCount&&!n.getRangeAt(0).collapsed&&(t=!1),t};function Pr(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function Oh(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Tn(n,t){return typeof n=="number"?n:n[t]}function Lh(n){let t=n.getBoundingClientRect(),e=t.width/n.offsetWidth||1,r=t.height/n.offsetHeight||1;return{left:t.left,right:t.left+n.clientWidth*e,top:t.top,bottom:t.top+n.clientHeight*r}}function El(n,t,e){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=e||n.dom;s;s=xs(s)){if(s.nodeType!=1)continue;let a=s,l=a==o.body,c=l?Oh(o):Lh(a),u=0,d=0;if(t.top<c.top+Tn(r,"top")?d=-(c.top-t.top+Tn(i,"top")):t.bottom>c.bottom-Tn(r,"bottom")&&(d=t.bottom-c.bottom+Tn(i,"bottom")),t.left<c.left+Tn(r,"left")?u=-(c.left-t.left+Tn(i,"left")):t.right>c.right-Tn(r,"right")&&(u=t.right-c.right+Tn(i,"right")),u||d)if(l)o.defaultView.scrollBy(u,d);else{let p=a.scrollLeft,h=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let f=a.scrollLeft-p,m=a.scrollTop-h;t={left:t.left-f,top:t.top-m,right:t.right-f,bottom:t.bottom-m}}if(l)break}}function Tl(n){let t=[],e=n.ownerDocument;for(let r=n;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=e);r=xs(r));return t}function Sl(n,t){for(let e=0;e<n.length;e++){let{dom:r,top:i,left:o}=n[e];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=o&&(r.scrollLeft=o)}}let Fr=null;function Ml(n,t){let e,r,i=2e8,o=0,s=t.top,a=t.top;for(let l=n.firstChild,c=0;l;l=l.nextSibling,c++){let u;if(l.nodeType==1)u=l.getClientRects();else{if(l.nodeType!=3)continue;u=nn(l).getClientRects()}for(let d=0;d<u.length;d++){let p=u[d];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);let h=p.left>t.left?p.left-t.left:p.right<t.left?t.left-p.right:0;if(h<i){e=l,i=h,r=h&&e.nodeType==3?{left:p.right<t.left?p.right:p.left,top:t.top}:t,l.nodeType==1&&h&&(o=c+(t.left>=(p.left+p.right)/2?1:0));continue}}!e&&(t.left>=p.right&&t.top>=p.top||t.left>=p.left&&t.top>=p.bottom)&&(o=c+1)}}return e&&e.nodeType==3?function(l,c){let u=l.nodeValue.length,d=document.createRange();for(let p=0;p<u;p++){d.setEnd(l,p+1),d.setStart(l,p);let h=Sn(d,1);if(h.top!=h.bottom&&Es(c,h))return{node:l,offset:p+(c.left>=(h.left+h.right)/2?1:0)}}return{node:l,offset:0}}(e,r):!e||i&&e.nodeType==1?{node:n,offset:o}:Ml(e,r)}function Es(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function Il(n,t,e){let r=n.childNodes.length;if(r&&e.top<e.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-e.top)/(e.bottom-e.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Es(t,c))return Il(s,t,c)}}if((o=(o+1)%r)==i)break}return n}function Ah(n,t){let e,r=n.dom.ownerDocument,i=0;if(r.caretPositionFromPoint)try{let l=r.caretPositionFromPoint(t.left,t.top);l&&({offsetNode:e,offset:i}=l)}catch{}if(!e&&r.caretRangeFromPoint){let l=r.caretRangeFromPoint(t.left,t.top);l&&({startContainer:e,startOffset:i}=l)}let o,s=(n.root.elementFromPoint?n.root:r).elementFromPoint(t.left,t.top);if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let l=n.dom.getBoundingClientRect();if(!Es(t,l)||(s=Il(n.dom,t,l),!s))return null}if(ce)for(let l=s;e&&l;l=xs(l))l.draggable&&(e=void 0);if(s=function(l,c){let u=l.parentNode;return u&&/^li$/i.test(u.nodeName)&&c.left<l.getBoundingClientRect().left?u:l}(s,t),e){if(Je&&e.nodeType==1&&(i=Math.min(i,e.childNodes.length),i<e.childNodes.length)){let l,c=e.childNodes[i];c.nodeName=="IMG"&&(l=c.getBoundingClientRect()).right<=t.left&&l.bottom>t.top&&i++}e==n.dom&&i==e.childNodes.length-1&&e.lastChild.nodeType==1&&t.top>e.lastChild.getBoundingClientRect().bottom?o=n.state.doc.content.size:i!=0&&e.nodeType==1&&e.childNodes[i-1].nodeName=="BR"||(o=function(l,c,u,d){let p=-1;for(let h=c;h!=l.dom;){let f=l.docView.nearestDesc(h,!0);if(!f)return null;if(f.node.isBlock&&f.parent){let m=f.dom.getBoundingClientRect();if(m.left>d.left||m.top>d.top)p=f.posBefore;else{if(!(m.right<d.left||m.bottom<d.top))break;p=f.posAfter}}h=f.dom.parentNode}return p>-1?p:l.docView.posFromDOM(c,u,1)}(n,e,i,t))}o==null&&(o=function(l,c,u){let{node:d,offset:p}=Ml(c,u),h=-1;if(d.nodeType==1&&!d.firstChild){let f=d.getBoundingClientRect();h=f.left!=f.right&&u.left>(f.left+f.right)/2?1:-1}return l.docView.posFromDOM(d,p,h)}(n,s,t));let a=n.docView.nearestDesc(s,!0);return{pos:o,inside:a?a.posAtStart-a.border:-1}}function Sn(n,t){let e=n.getClientRects();return e.length?e[t<0?0:e.length-1]:n.getBoundingClientRect()}const Dh=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Nl(n,t,e){let{node:r,offset:i,atom:o}=n.docView.domFromPos(t,e<0?-1:1),s=lo||Je;if(r.nodeType==3){if(!s||!Dh.test(r.nodeValue)&&(e<0?i:i!=r.nodeValue.length)){let a=i,l=i,c=e<0?1:-1;return e<0&&!i?(l++,c=-1):e>=0&&i==r.nodeValue.length?(a--,c=1):e<0?a--:l++,Si(Sn(nn(r,a,l),c),c<0)}{let a=Sn(nn(r,i,i),e);if(Je&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let l=Sn(nn(r,i-1,i-1),-1);if(l.top==a.top){let c=Sn(nn(r,i,i+1),-1);if(c.top!=a.top)return Si(c,c.left<l.left)}}return a}}if(!n.state.doc.resolve(t-(o||0)).parent.inlineContent){if(o==null&&i&&(e<0||i==Qe(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return Ts(a.getBoundingClientRect(),!1)}if(o==null&&i<Qe(r)){let a=r.childNodes[i];if(a.nodeType==1)return Ts(a.getBoundingClientRect(),!0)}return Ts(r.getBoundingClientRect(),e>=0)}if(o==null&&i&&(e<0||i==Qe(r))){let a=r.childNodes[i-1],l=a.nodeType==3?nn(a,Qe(a)-(s?0:1)):a.nodeType!=1||a.nodeName=="BR"&&a.nextSibling?null:a;if(l)return Si(Sn(l,1),!1)}if(o==null&&i<Qe(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let l=a?a.nodeType==3?nn(a,0,s?0:1):a.nodeType==1?a:null:null;if(l)return Si(Sn(l,-1),!0)}return Si(Sn(r.nodeType==3?nn(r):r,-e),e>=0)}function Si(n,t){if(n.width==0)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function Ts(n,t){if(n.height==0)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function Ol(n,t,e){let r=n.state,i=n.root.activeElement;r!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{r!=t&&n.updateState(r),i!=n.dom&&i&&i.focus()}}const Rh=/[\u0590-\u08ac]/;let Ll=null,Al=null,Dl=!1;function Ph(n,t,e){return Ll==t&&Al==e?Dl:(Ll=t,Al=e,Dl=e=="up"||e=="down"?function(r,i,o){let s=i.selection,a=o=="up"?s.$from:s.$to;return Ol(r,i,()=>{let{node:l}=r.docView.domFromPos(a.pos,o=="up"?-1:1);for(;;){let u=r.docView.nearestDesc(l,!0);if(!u)break;if(u.node.isBlock){l=u.dom;break}l=u.dom.parentNode}let c=Nl(r,a.pos,1);for(let u=l.firstChild;u;u=u.nextSibling){let d;if(u.nodeType==1)d=u.getClientRects();else{if(u.nodeType!=3)continue;d=nn(u,0,u.nodeValue.length).getClientRects()}for(let p=0;p<d.length;p++){let h=d[p];if(h.bottom>h.top+1&&(o=="up"?c.top-h.top>2*(h.bottom-c.top):h.bottom-c.bottom>2*(c.bottom-h.top)))return!1}}return!0})}(n,t,e):function(r,i,o){let{$head:s}=i.selection;if(!s.parent.isTextblock)return!1;let a=s.parentOffset,l=!a,c=a==s.parent.content.size,u=r.domSelection();return Rh.test(s.parent.textContent)&&u.modify?Ol(r,i,()=>{let d=u.getRangeAt(0),p=u.focusNode,h=u.focusOffset,f=u.caretBidiLevel;u.modify("move",o,"character");let m=!(s.depth?r.docView.domAfterPos(s.before()):r.dom).contains(u.focusNode.nodeType==1?u.focusNode:u.focusNode.parentNode)||p==u.focusNode&&h==u.focusOffset;return u.removeAllRanges(),u.addRange(d),f!=null&&(u.caretBidiLevel=f),m}):o=="left"||o=="backward"?l:c}(n,t,e))}class Mi{constructor(t,e,r,i){this.parent=t,this.children=e,this.dom=r,this.contentDOM=i,this.dirty=0,r.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,r){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,r=this.posAtStart;;e++){let i=this.children[e];if(i==t)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode)){if(r<0){let o,s;if(t==this.contentDOM)o=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.previousSibling}for(;o&&(!(s=o.pmViewDesc)||s.parent!=this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}{let o,s;if(t==this.contentDOM)o=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;o=t.nextSibling}for(;o&&(!(s=o.pmViewDesc)||s.parent!=this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}}let i;if(t==this.dom&&this.contentDOM)i=e>ye(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(e==0)for(let o=t;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&e==t.childNodes.length)for(let o=t;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let r=!0,i=t;i;i=i.parentNode){let o,s=this.getDesc(i);if(s&&(!e||s.node)){if(!r||!(o=s.nodeDOM)||(o.nodeType==1?o.contains(t.nodeType==1?t:t.parentNode):o==t))return s;r=!1}}}getDesc(t){let e=t.pmViewDesc;for(let r=e;r;r=r.parent)if(r==this)return e}posFromDOM(t,e,r){for(let i=t;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(t,e,r)}return-1}descAt(t){for(let e=0,r=0;e<this.children.length;e++){let i=this.children[e],o=r+i.size;if(r==t&&o!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<o)return i.descAt(t-r-i.border);r=o}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r,i=0,o=0;for(let s=0;i<this.children.length;i++){let a=this.children[i],l=s+a.size;if(l>t||a instanceof Fl){o=t-s;break}s=l}if(o)return this.children[i].domFromPos(o-this.children[i].border,e);for(;i&&!(r=this.children[i-1]).size&&r instanceof Rl&&r.side>=0;i--);if(e<=0){let s,a=!0;for(;s=i?this.children[i-1]:null,s&&s.dom.parentNode!=this.contentDOM;i--,a=!1);return s&&e&&a&&!s.border&&!s.domAtom?s.domFromPos(s.size,e):{node:this.contentDOM,offset:s?ye(s.dom)+1:0}}{let s,a=!0;for(;s=i<this.children.length?this.children[i]:null,s&&s.dom.parentNode!=this.contentDOM;i++,a=!1);return s&&a&&!s.border&&!s.domAtom?s.domFromPos(0,e):{node:this.contentDOM,offset:s?ye(s.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,r=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(i==-1&&t<=c){let u=s+l.border;if(t>=u&&e<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,e,u);t=s;for(let d=a;d>0;d--){let p=this.children[d-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){i=ye(p.dom)+1;break}t-=p.size}i==-1&&(i=0)}if(i>-1&&(c>e||a==this.children.length-1)){e=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=ye(d.dom);break}e+=d.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:o}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return e.size==0||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:r}=this.domFromPos(t,0);if(e.nodeType!=1||r==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[r]}setSelection(t,e,r,i=!1){let o=Math.min(t,e),s=Math.max(t,e);for(let p=0,h=0;p<this.children.length;p++){let f=this.children[p],m=h+f.size;if(o>h&&s<m)return f.setSelection(t-h-f.border,e-h-f.border,r,i);h=m}let a=this.domFromPos(t,t?-1:1),l=e==t?a:this.domFromPos(e,e?-1:1),c=r.getSelection(),u=!1;if((Je||ce)&&t==e){let{node:p,offset:h}=a;if(p.nodeType==3){if(u=!(!h||p.nodeValue[h-1]!=`
`),u&&h==p.nodeValue.length)for(let f,m=p;m;m=m.parentNode){if(f=m.nextSibling){f.nodeName=="BR"&&(a=l={node:f.parentNode,offset:ye(f)+1});break}let g=m.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let f=p.childNodes[h-1];u=f&&(f.nodeName=="BR"||f.contentEditable=="false")}}if(Je&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let p=c.focusNode.childNodes[c.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||u&&ce)&&Ti(a.node,a.offset,c.anchorNode,c.anchorOffset)&&Ti(l.node,l.offset,c.focusNode,c.focusOffset))return;let d=!1;if((c.extend||t==e)&&!u){c.collapse(a.node,a.offset);try{t!=e&&c.extend(l.node,l.offset),d=!0}catch(p){if(!(p instanceof DOMException))throw p}}if(!d){if(t>e){let h=a;a=l,l=h}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?t<=s&&e>=r:t<s&&e>r){let a=r+o.border,l=s-o.border;if(t>=a&&e<=l)return this.dirty=t==r||e==s?2:1,void(t!=a||e!=l||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-a,e-a):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}r=s}this.dirty=2}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let r=t==1?2:1;e.dirty<r&&(e.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Rl extends Mi{constructor(t,e,r,i){let o,s=e.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:i)),!e.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(t,[],s,null),this.widget=e,this.widget=e,o=this}matchesWidget(t){return this.dirty==0&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return!!e&&e(t)}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Fh extends Mi{constructor(t,e,r,i){super(t,[],e,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class tr extends Mi{constructor(t,e,r,i){super(t,[],r,i),this.mark=e}static create(t,e,r,i){let o=i.nodeViews[e.type.name],s=o&&o(e,i,r);return s&&s.dom||(s=Ne.renderSpec(document,e.type.spec.toDOM(e,r))),new tr(t,e,s.dom,s.contentDOM||s.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return this.dirty!=3&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),this.dirty!=0){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}}slice(t,e,r){let i=tr.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;e<s&&(o=Is(o,e,s,r)),t>0&&(o=Is(o,0,t,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}}class er extends Mi{constructor(t,e,r,i,o,s,a,l,c){super(t,[],o,s),this.node=e,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a,s&&this.updateChildren(l,c)}static create(t,e,r,i,o,s){let a,l=o.nodeViews[e.type.name],c=l&&l(e,o,()=>a?a.parent?a.parent.posBeforeChild(a):void 0:s,r,i),u=c&&c.dom,d=c&&c.contentDOM;if(e.isText)if(u){if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u=document.createTextNode(e.text);else u||({dom:u,contentDOM:d}=Ne.renderSpec(document,e.type.spec.toDOM(e)));d||e.isText||u.nodeName=="BR"||(u.hasAttribute("contenteditable")||(u.contentEditable="false"),e.type.spec.draggable&&(u.draggable=!0));let p=u;return u=zl(u,r,e),c?a=new Bh(t,e,r,i,u,d||null,p,c,o,s+1):e.isText?new co(t,e,r,i,u,p,o):new er(t,e,r,i,u,d||null,p,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let e=this.children.length-1;e>=0;e--){let r=this.children[e];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=()=>S.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,e,r){return this.dirty==0&&t.eq(this.node)&&Ms(e,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let r=this.node.inlineContent,i=e,o=t.composing?this.localCompositionInfo(t,e):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new zh(this,s&&s.node);(function(c,u,d,p){let h=u.locals(c),f=0;if(h.length==0){for(let C=0;C<c.childCount;C++){let E=c.child(C);p(E,h,u.forChild(f,E),C),f+=E.nodeSize}return}let m=0,g=[],w=null;for(let C=0;;){if(m<h.length&&h[m].to==f){let A,H=h[m++];for(;m<h.length&&h[m].to==f;)(A||(A=[H])).push(h[m++]);if(A){A.sort(_h);for(let B=0;B<A.length;B++)d(A[B],C,!!w)}else d(H,C,!!w)}let E,L;if(w)L=-1,E=w,w=null;else{if(!(C<c.childCount))break;L=C,E=c.child(C++)}for(let A=0;A<g.length;A++)g[A].to<=f&&g.splice(A--,1);for(;m<h.length&&h[m].from<=f&&h[m].to>f;)g.push(h[m++]);let P=f+E.nodeSize;if(E.isText){let A=P;m<h.length&&h[m].from<A&&(A=h[m].from);for(let H=0;H<g.length;H++)g[H].to<A&&(A=g[H].to);A<P&&(w=E.cut(A-f),E=E.cut(0,A-f),P=A,L=-1)}p(E,E.isInline&&!E.isLeaf?g.filter(A=>!A.inline):g.slice(),u.forChild(f,E),L),f=P}})(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,t):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?rt.none:this.node.child(u).marks,r,t),l.placeWidget(c,t,i)},(c,u,d,p)=>{let h;l.syncToMarks(c.marks,r,t),l.findNodeMatch(c,u,d,p)||a&&t.state.selection.from>i&&t.state.selection.to<i+c.nodeSize&&(h=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,u,d,h,t)||l.updateNextNode(c,u,d,t,p)||l.addNode(c,u,d,t,i),i+=c.nodeSize}),l.syncToMarks([],r,t),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==2)&&(s&&this.protectLocalComposition(t,s),Bl(this.contentDOM,this.children,t),Rr&&function(c){if(c.nodeName=="UL"||c.nodeName=="OL"){let u=c.style.cssText;c.style.cssText=u+"; list-style: square !important",window.getComputedStyle(c).listStyle,c.style.cssText=u}}(this.dom))}localCompositionInfo(t,e){let{from:r,to:i}=t.state.selection;if(!(t.state.selection instanceof dt)||r<e||i>e+this.node.content.size)return null;let o=t.domSelection(),s=function(a,l){for(;;){if(a.nodeType==3)return a;if(a.nodeType==1&&l>0){if(a.childNodes.length>l&&a.childNodes[l].nodeType==3)return a.childNodes[l];l=Qe(a=a.childNodes[l-1])}else{if(!(a.nodeType==1&&l<a.childNodes.length))return null;a=a.childNodes[l],l=0}}}(o.focusNode,o.focusOffset);if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let a=s.nodeValue,l=function(c,u,d,p){for(let h=0,f=0;h<c.childCount&&f<=p;){let m=c.child(h++),g=f;if(f+=m.nodeSize,!m.isText)continue;let w=m.text;for(;h<c.childCount;){let C=c.child(h++);if(f+=C.nodeSize,!C.isText)break;w+=C.text}if(f>=d){let C=g<p?w.lastIndexOf(u,p-g-1):-1;if(C>=0&&C+u.length+g>=d)return g+C;if(d==p&&w.length>=p+u.length-g&&w.slice(p-g,p-g+u.length)==u)return p}}return-1}(this.node.content,a,r-e,i-e);return l<0?null:{node:s,pos:l,text:a}}return{node:s,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:r,text:i}){if(this.getDesc(e))return;let o=e;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new Fh(this,o,e,i);t.input.compositionNodes.push(s),this.children=Is(this.children,r,r+i.length,t,s)}update(t,e,r,i){return!(this.dirty==3||!t.sameMarkup(this.node))&&(this.updateInner(t,e,r,i),!0)}updateInner(t,e,r,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(Ms(t,this.outerDeco))return;let e=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Hl(this.dom,this.nodeDOM,Ss(this.outerDeco,this.node,e),Ss(t,this.node,e)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function Pl(n,t,e,r,i){return zl(r,t,n),new er(void 0,n,t,e,r,r,r,i,0)}class co extends er{constructor(t,e,r,i,o,s,a){super(t,e,r,i,o,null,s,a,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,r,i){return!(this.dirty==3||this.dirty!=0&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),this.dirty==0&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=0,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,r){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,r)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,e,r){let i=this.node.cut(t,e),o=document.createTextNode(i.text);return new co(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(t,e){super.markDirty(t,e),this.dom==this.nodeDOM||t!=0&&e!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}}class Fl extends Mi{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==0&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Bh extends er{constructor(t,e,r,i,o,s,a,l,c,u){super(t,e,r,i,o,s,a,c,u),this.spec=l}update(t,e,r,i){if(this.dirty==3)return!1;if(this.spec.update){let o=this.spec.update(t,e,r);return o&&this.updateInner(t,e,r,i),o}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,e,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,r,i){this.spec.setSelection?this.spec.setSelection(t,e,r):super.setSelection(t,e,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function Bl(n,t,e){let r=n.firstChild,i=!1;for(let o=0;o<t.length;o++){let s=t[o],a=s.dom;if(a.parentNode==n){for(;a!=r;)r=_l(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(s instanceof tr){let l=r?r.previousSibling:n.lastChild;Bl(s.contentDOM,s.children,e),r=l?l.nextSibling:n.firstChild}}for(;r;)r=_l(r),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const Ii=function(n){n&&(this.nodeName=n)};Ii.prototype=Object.create(null);const nr=[new Ii];function Ss(n,t,e){if(n.length==0)return nr;let r=e?nr[0]:new Ii,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new Ii(s.nodeName));for(let a in s){let l=s[a];l!=null&&(e&&i.length==1&&i.push(r=new Ii(t.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function Hl(n,t,e,r){if(e==nr&&r==nr)return t;let i=t;for(let o=0;o<r.length;o++){let s=r[o],a=e[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=nr[0]),i=l}Hh(i,a||nr[0],s)}return i}function Hh(n,t,e){for(let r in t)r=="class"||r=="style"||r=="nodeName"||r in e||n.removeAttribute(r);for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&e[r]!=t[r]&&n.setAttribute(r,e[r]);if(t.class!=e.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let r,i=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;r=i.exec(t.style);)n.style.removeProperty(r[1])}e.style&&(n.style.cssText+=e.style)}}function zl(n,t,e){return Hl(n,n,nr,Ss(t,e,n.nodeType!=1))}function Ms(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function _l(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class zh{constructor(t,e){this.lock=e,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(r,i){let o=i,s=o.children.length,a=r.childCount,l=new Map,c=[];t:for(;a>0;){let u;for(;;)if(s){let p=o.children[s-1];if(!(p instanceof tr)){u=p,s--;break}o=p,s=p.children.length}else{if(o==i)break t;s=o.parent.children.indexOf(o),o=o.parent}let d=u.node;if(d){if(d!=r.child(a-1))break;--a,l.set(u,a),c.push(u)}}return{index:a,matched:l,matches:c.reverse()}}(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let r=t;r<e;r++)this.top.children[r].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,r){let i=0,o=this.stack.length>>1,s=Math.min(o,t.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&t[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++)if(this.top.children[l].matchesMark(t[o])){a=l;break}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=tr.create(this.top,t[o],e,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(t,e,r,i){let o,s=-1;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(t,e,r))s=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(t,e,r)&&!this.preMatch.matched.has(c)){s=a;break}}return!(s<0)&&(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(t,e,r,i,o){let s=this.top.children[i];return s.dirty==3&&s.dom==s.contentDOM&&(s.dirty=2),!!s.update(t,e,r,o)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let r=t.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}t=e}}updateNextNode(t,e,r,i,o){for(let s=this.index;s<this.top.children.length;s++){let a=this.top.children[s];if(a instanceof er){let l=this.preMatch.matched.get(a);if(l!=null&&l!=o)return!1;let c=a.dom;if(!(this.lock&&(c==this.lock||c.nodeType==1&&c.contains(this.lock.parentNode))&&!(t.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==t.text&&a.dirty!=3&&Ms(e,a.outerDeco)))&&a.update(t,e,r,i))return this.destroyBetween(this.index,s),a.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,e,r,i,o){this.top.children.splice(this.index++,0,er.create(this.top,t,e,r,i,o)),this.changed=!0}placeWidget(t,e,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(t)||t!=i.widget&&i.widget.type.toDOM.parentNode){let o=new Rl(this.top,t,e,r);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof tr;)e=t,t=e.children[e.children.length-1];t&&t instanceof co&&!/\n$/.test(t.node.text)||((ce||oe)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let r=document.createElement(t);t=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),t=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Fl(this.top,[],r,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}}function _h(n,t){return n.type.side-t.type.side}function Is(n,t,e,r,i){let o=[];for(let s=0,a=0;s<n.length;s++){let l=n[s],c=a,u=a+=l.size;c>=e||u<=t?o.push(l):(c<t&&o.push(l.slice(0,t-c,r)),i&&(o.push(i),i=void 0),u>e&&o.push(l.slice(e-c,l.size,r)))}return o}function ql(n,t=null){let e=n.domSelection(),r=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(s<0)return null;let a,l,c=r.resolve(s);if(Cs(e)){for(a=c;i&&!i.node;)i=i.parent;let u=i.node;if(i&&u.isAtom&&at.isSelectable(u)&&i.parent&&(!u.isInline||!function(d,p,h){for(let f=p==0,m=p==Qe(d);f||m;){if(d==h)return!0;let g=ye(d);if(!(d=d.parentNode))return!1;f=f&&g==0,m=m&&g==Qe(d)}}(e.focusNode,e.focusOffset,i.dom))){let d=i.posBefore;l=new at(s==d?c:r.resolve(d))}}else{let u=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(u<0)return null;a=r.resolve(u)}return l||(l=Os(n,a,c,t=="pointer"||n.state.selection.head<c.pos&&!o?1:-1)),l}function $l(n){return n.editable?n.hasFocus():Jl(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Mn(n,t=!1){let e=n.state.selection;if(Wl(n,e),$l(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&oe){let r=n.domSelection(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Ti(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset))return n.input.mouseDown.delayedSelectionSync=!0,void n.domObserver.setCurSelection()}if(n.domObserver.disconnectSelection(),n.cursorWrapper)(function(r){let i=r.domSelection(),o=document.createRange(),s=r.cursorWrapper.dom,a=s.nodeName=="IMG";a?o.setEnd(s.parentNode,ye(s)+1):o.setEnd(s,0),o.collapse(!1),i.removeAllRanges(),i.addRange(o),!a&&!r.state.selection.visible&&ve&&En<=11&&(s.disabled=!0,s.disabled=!1)})(n);else{let r,i,{anchor:o,head:s}=e;!jl||e instanceof dt||(e.$from.parent.inlineContent||(r=Vl(n,e.from)),e.empty||e.$from.parent.inlineContent||(i=Vl(n,e.to))),n.docView.setSelection(o,s,n.root,t),jl&&(r&&Ul(r),i&&Ul(i)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(a){let l=a.dom.ownerDocument;l.removeEventListener("selectionchange",a.input.hideSelectionGuard);let c=a.domSelection(),u=c.anchorNode,d=c.anchorOffset;l.addEventListener("selectionchange",a.input.hideSelectionGuard=()=>{c.anchorNode==u&&c.anchorOffset==d||(l.removeEventListener("selectionchange",a.input.hideSelectionGuard),setTimeout(()=>{$l(a)&&!a.state.selection.visible||a.dom.classList.remove("ProseMirror-hideselection")},20))})}(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const jl=ce||oe&&Sh<63;function Vl(n,t){let{node:e,offset:r}=n.docView.domFromPos(t,0),i=r<e.childNodes.length?e.childNodes[r]:null,o=r?e.childNodes[r-1]:null;if(ce&&i&&i.contentEditable=="false")return Ns(i);if(!(i&&i.contentEditable!="false"||o&&o.contentEditable!="false")){if(i)return Ns(i);if(o)return Ns(o)}}function Ns(n){return n.contentEditable="true",ce&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Ul(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function Wl(n,t){if(t instanceof at){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(Kl(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else Kl(n)}function Kl(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Os(n,t,e,r){return n.someProp("createSelectionBetween",i=>i(n,t,e))||dt.between(t,e,r)}function Gl(n){return(!n.editable||n.root.activeElement==n.dom)&&Jl(n)}function Jl(n){let t=n.domSelection();if(!t.anchorNode)return!1;try{return n.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function Ls(n,t){let{$anchor:e,$head:r}=n.selection,i=t>0?e.max(r):e.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return o&&G.findFrom(o,t)}function rr(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function Yl(n,t,e){let r=n.state.selection;if(!(r instanceof dt)){if(r instanceof at&&r.node.isInline)return rr(n,new dt(t>0?r.$to:r.$from));{let i=Ls(n.state,t);return!!i&&rr(n,i)}}if(!r.empty||e.indexOf("s")>-1)return!1;if(n.endOfTextblock(t>0?"right":"left")){let i=Ls(n.state,t);return!!(i&&i instanceof at)&&rr(n,i)}if(!(Ee&&e.indexOf("m")>-1)){let i,o=r.$head,s=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!s||s.isText)return!1;let a=t<0?o.pos-s.nodeSize:o.pos;return!!(s.isAtom||(i=n.docView.descAt(a))&&!i.contentDOM)&&(at.isSelectable(s)?rr(n,new at(t<0?n.state.doc.resolve(o.pos-s.nodeSize):o)):!!lo&&rr(n,new dt(n.state.doc.resolve(t<0?a:a+s.nodeSize))))}}function uo(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Ni(n){let t=n.pmViewDesc;return t&&t.size==0&&(n.nextSibling||n.nodeName!="BR")}function As(n){let t=n.domSelection(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i,o,s=!1;for(Je&&e.nodeType==1&&r<uo(e)&&Ni(e.childNodes[r])&&(s=!0);;)if(r>0){if(e.nodeType!=1)break;{let a=e.childNodes[r-1];if(Ni(a))i=e,o=--r;else{if(a.nodeType!=3)break;e=a,r=e.nodeValue.length}}}else{if(Ql(e))break;{let a=e.previousSibling;for(;a&&Ni(a);)i=e.parentNode,o=ye(a),a=a.previousSibling;if(a)e=a,r=uo(e);else{if(e=e.parentNode,e==n.dom)break;r=0}}}s?Rs(n,t,e,r):i&&Rs(n,t,i,o)}function Ds(n){let t=n.domSelection(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i,o,s=uo(e);for(;;)if(r<s){if(e.nodeType!=1||!Ni(e.childNodes[r]))break;i=e,o=++r}else{if(Ql(e))break;{let a=e.nextSibling;for(;a&&Ni(a);)i=a.parentNode,o=ye(a)+1,a=a.nextSibling;if(a)e=a,r=0,s=uo(e);else{if(e=e.parentNode,e==n.dom)break;r=s=0}}}i&&Rs(n,t,i,o)}function Ql(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function Rs(n,t,e,r){if(Cs(t)){let o=document.createRange();o.setEnd(e,r),o.setStart(e,r),t.removeAllRanges(),t.addRange(o)}else t.extend&&t.extend(e,r);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Mn(n)},50)}function Xl(n,t,e){let r=n.state.selection;if(r instanceof dt&&!r.empty||e.indexOf("s")>-1||Ee&&e.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let s=Ls(n.state,t);if(s&&s instanceof at)return rr(n,s)}if(!i.parent.inlineContent){let s=t<0?i:o,a=r instanceof Zt?G.near(s,t):G.findFrom(s,t);return!!a&&rr(n,a)}return!1}function Zl(n,t){if(!(n.state.selection instanceof dt))return!0;let{$head:e,$anchor:r,empty:i}=n.state.selection;if(!e.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let o=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return t<0?s.delete(e.pos-o.nodeSize,e.pos):s.delete(e.pos,e.pos+o.nodeSize),n.dispatch(s),!0}return!1}function tc(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function qh(n,t){let e=t.keyCode,r=function(i){let o="";return i.ctrlKey&&(o+="c"),i.metaKey&&(o+="m"),i.altKey&&(o+="a"),i.shiftKey&&(o+="s"),o}(t);return e==8||Ee&&e==72&&r=="c"?Zl(n,-1)||As(n):e==46||Ee&&e==68&&r=="c"?Zl(n,1)||Ds(n):e==13||e==27||(e==37||Ee&&e==66&&r=="c"?Yl(n,-1,r)||As(n):e==39||Ee&&e==70&&r=="c"?Yl(n,1,r)||Ds(n):e==38||Ee&&e==80&&r=="c"?Xl(n,-1,r)||As(n):e==40||Ee&&e==78&&r=="c"?function(i){if(!ce||i.state.selection.$head.parentOffset>0)return!1;let{focusNode:o,focusOffset:s}=i.domSelection();if(o&&o.nodeType==1&&s==0&&o.firstChild&&o.firstChild.contentEditable=="false"){let a=o.firstChild;tc(i,a,"true"),setTimeout(()=>tc(i,a,"false"),20)}return!1}(n)||Xl(n,1,r)||Ds(n):r==(Ee?"m":"c")&&(e==66||e==73||e==89||e==90))}function ec(n,t){let e=[],{content:r,openStart:i,openEnd:o}=t;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let p=r.firstChild;e.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let s=n.someProp("clipboardSerializer")||Ne.fromSchema(n.state.schema),a=cc(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c,u=l.firstChild,d=0;for(;u&&u.nodeType==1&&(c=ac[u.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let h=a.createElement(c[p]);for(;l.firstChild;)h.appendChild(l.firstChild);l.appendChild(h),d++}u=l.firstChild}return u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${d?` -${d}`:""} ${JSON.stringify(e)}`),{dom:l,text:n.someProp("clipboardTextSerializer",p=>p(t))||t.content.textBetween(0,t.content.size,`

`)}}function nc(n,t,e,r,i){let o,s,a=i.parent.type.spec.code;if(!e&&!t)return null;let l=t&&(r||a||!e);if(l){if(n.someProp("transformPastedText",p=>{t=p(t,a||r)}),a)return t?new j(S.from(n.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0):j.empty;let d=n.someProp("clipboardTextParser",p=>p(t,i,r));if(d)s=d;else{let p=i.marks(),{schema:h}=n.state,f=Ne.fromSchema(h);o=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=o.appendChild(document.createElement("p"));m&&g.appendChild(f.serializeNode(h.text(m,p)))})}}else n.someProp("transformPastedHTML",d=>{e=d(e)}),o=function(d){let p=/^(\s*<meta [^>]*>)*/.exec(d);p&&(d=d.slice(p[0].length));let h,f=cc().createElement("div"),m=/<([a-z][^>\s]+)/i.exec(d);if((h=m&&ac[m[1].toLowerCase()])&&(d=h.map(g=>"<"+g+">").join("")+d+h.map(g=>"</"+g+">").reverse().join("")),f.innerHTML=d,h)for(let g=0;g<h.length;g++)f=f.querySelector(h[g])||f;return f}(e),lo&&function(d){let p=d.querySelectorAll(oe?"span:not([class]):not([style])":"span.Apple-converted-space");for(let h=0;h<p.length;h++){let f=p[h];f.childNodes.length==1&&f.textContent==" "&&f.parentNode&&f.parentNode.replaceChild(d.ownerDocument.createTextNode(" "),f)}}(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0&&o.firstChild;d--)o=o.firstChild;if(s||(s=(n.someProp("clipboardParser")||n.someProp("domParser")||lt.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!(!l&&!u),context:i,ruleFromNode:p=>p.nodeName!="BR"||p.nextSibling||!p.parentNode||$h.test(p.parentNode.nodeName)?null:{ignore:!0}})),u)s=function(d,p){if(!d.size)return d;let h,f=d.content.firstChild.type.schema;try{h=JSON.parse(p)}catch{return d}let{content:m,openStart:g,openEnd:w}=d;for(let C=h.length-2;C>=0;C-=2){let E=f.nodes[h[C]];if(!E||E.hasRequiredAttrs())break;m=S.from(E.create(h[C+1],m)),g++,w++}return new j(m,g,w)}(sc(s,+u[1],+u[2]),u[4]);else if(s=j.maxOpen(function(d,p){if(d.childCount<2)return d;for(let h=p.depth;h>=0;h--){let f,m=p.node(h).contentMatchAt(p.index(h)),g=[];if(d.forEach(w=>{if(!g)return;let C,E=m.findWrapping(w.type);if(!E)return g=null;if(C=g.length&&f.length&&ic(E,f,w,g[g.length-1],0))g[g.length-1]=C;else{g.length&&(g[g.length-1]=oc(g[g.length-1],f.length));let L=rc(w,E);g.push(L),m=m.matchType(L.type),f=E}}),g)return S.from(g)}return d}(s.content,i),!0),s.openStart||s.openEnd){let d=0,p=0;for(let h=s.content.firstChild;d<s.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=s.content.lastChild;p<s.openEnd&&!h.type.spec.isolating;p++,h=h.lastChild);s=sc(s,d,p)}return n.someProp("transformPasted",d=>{s=d(s)}),s}const $h=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function rc(n,t,e=0){for(let r=t.length-1;r>=e;r--)n=t[r].create(null,S.from(n));return n}function ic(n,t,e,r,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let o=ic(n,t,e,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?e.type:n[i+1]))return r.copy(r.content.append(S.from(rc(e,n,i+1))))}}function oc(n,t){if(t==0)return n;let e=n.content.replaceChild(n.childCount-1,oc(n.lastChild,t-1)),r=n.contentMatchAt(n.childCount).fillBefore(S.empty,!0);return n.copy(e.append(r))}function Ps(n,t,e,r,i,o){let s=t<0?n.firstChild:n.lastChild,a=s.content;return i<r-1&&(a=Ps(a,t,e,r,i+1,o)),i>=e&&(a=t<0?s.contentMatchAt(0).fillBefore(a,n.childCount>1||o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(S.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,s.copy(a))}function sc(n,t,e){return t<n.openStart&&(n=new j(Ps(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new j(Ps(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const ac={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let lc=null;function cc(){return lc||(lc=document.implementation.createHTMLDocument("title"))}const ue={};let se={};class jh{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ir(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function Fs(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>Bs(n,r))})}function Bs(n,t){return n.someProp("handleDOMEvents",e=>{let r=e[t.type];return!!r&&(r(n,t)||t.defaultPrevented)})}function Vh(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||e.nodeType==11||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function po(n){return{left:n.clientX,top:n.clientY}}function Hs(n,t,e,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(t,a=>s>o.depth?a(n,e,o.nodeAfter,o.before(s),i,!0):a(n,e,o.node(s),o.before(s),i,!1)))return!0;return!1}function Br(n,t,e){n.focused||n.focus();let r=n.state.tr.setSelection(t);r.setMeta("pointer",!0),n.dispatch(r)}function Uh(n,t,e,r,i){return Hs(n,"handleClickOn",t,e,r)||n.someProp("handleClick",o=>o(n,t,r))||(i?function(o,s){if(s==-1)return!1;let a,l,c=o.state.selection;c instanceof at&&(a=c.node);let u=o.state.doc.resolve(s);for(let d=u.depth+1;d>0;d--){let p=d>u.depth?u.nodeAfter:u.node(d);if(at.isSelectable(p)){l=a&&c.$from.depth>0&&d>=c.$from.depth&&u.before(c.$from.depth+1)==c.$from.pos?u.before(c.$from.depth):u.before(d);break}}return l!=null&&(Br(o,at.create(o.state.doc,l)),!0)}(n,e):function(o,s){if(s==-1)return!1;let a=o.state.doc.resolve(s),l=a.nodeAfter;return!!(l&&l.isAtom&&at.isSelectable(l))&&(Br(o,new at(a)),!0)}(n,e))}function Wh(n,t,e,r){return Hs(n,"handleDoubleClickOn",t,e,r)||n.someProp("handleDoubleClick",i=>i(n,t,r))}function Kh(n,t,e,r){return Hs(n,"handleTripleClickOn",t,e,r)||n.someProp("handleTripleClick",i=>i(n,t,r))||function(i,o,s){if(s.button!=0)return!1;let a=i.state.doc;if(o==-1)return!!a.inlineContent&&(Br(i,dt.create(a,0,a.content.size)),!0);let l=a.resolve(o);for(let c=l.depth+1;c>0;c--){let u=c>l.depth?l.nodeAfter:l.node(c),d=l.before(c);if(u.inlineContent)Br(i,dt.create(a,d+1,d+1+u.content.size));else{if(!at.isSelectable(u))continue;Br(i,at.create(a,d))}return!0}}(n,e,r)}function zs(n){return ho(n)}se.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=e.keyCode==16||e.shiftKey,!dc(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!Ye||!oe||e.keyCode!=13))if(e.keyCode!=229&&n.domObserver.forceFlush(),!Rr||e.keyCode!=13||e.ctrlKey||e.altKey||e.metaKey)n.someProp("handleKeyDown",r=>r(n,e))||qh(n,e)?e.preventDefault():ir(n,"key");else{let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,Pr(13,"Enter"))),n.input.lastIOSEnter=0)},200)}},se.keyup=(n,t)=>{t.keyCode==16&&(n.input.shiftKey=!1)},se.keypress=(n,t)=>{let e=t;if(dc(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||Ee&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e)))return void e.preventDefault();let r=n.state.selection;if(!(r instanceof dt&&r.$from.sameParent(r.$to))){let i=String.fromCharCode(e.charCode);n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i))||n.dispatch(n.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}};const uc=Ee?"metaKey":"ctrlKey";ue.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let r=zs(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&function(a,l){let c=l.x-a.clientX,u=l.y-a.clientY;return c*c+u*u<100}(e,n.input.lastClick)&&!e[uc]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:o};let s=n.posAtCoords(po(e));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new Gh(n,s,e,!!r)):(o=="doubleClick"?Wh:Kh)(n,s.pos,s.inside,e)?e.preventDefault():ir(n,"pointer"))};class Gh{constructor(t,e,r,i){let o,s;if(this.view=t,this.pos=e,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[uc],this.allowDefault=r.shiftKey,e.inside>-1)o=t.state.doc.nodeAt(e.inside),s=e.inside;else{let u=t.state.doc.resolve(e.pos);o=u.parent,s=u.depth?u.before():0}const a=i?null:r.target,l=a?t.docView.nearestDesc(a,!0):null;this.target=l?l.dom:null;let{selection:c}=t.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof at&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Je||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),ir(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Mn(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(po(t))),this.allowDefault||!e?ir(this.view,"pointer"):Uh(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||ce&&this.mightDrag&&!this.mightDrag.node.isAtom||oe&&!(this.view.state.selection instanceof dt)&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Br(this.view,G.near(this.view.state.doc.resolve(e.pos))),t.preventDefault()):ir(this.view,"pointer")}move(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),ir(this.view,"pointer"),t.buttons==0&&this.done()}}function dc(n,t){return!!n.composing||!!(ce&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500)&&(n.input.compositionEndedAt=-2e8,!0)}ue.touchdown=n=>{zs(n),ir(n,"pointer")},ue.contextmenu=n=>zs(n);const Jh=Ye?5e3:-1;function pc(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>ho(n),t))}function hc(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=function(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function ho(n,t=!1){if(!(Ye&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),hc(n),t||n.docView&&n.docView.dirty){let e=ql(n);return e&&!e.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(e)):n.updateState(n.state),!0}return!1}}se.compositionstart=se.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||e.marks(),ho(n,!0),n.markCursor=null;else if(ho(n),Je&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let r=n.domSelection();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){r.collapse(s,s.nodeValue.length);break}i=s,o=-1}}n.input.composing=!0}pc(n,Jh)},se.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,pc(n,20))};const Hr=ve&&En<15||Rr&&Mh<604;function _s(n,t,e,r){let i=nc(n,t,e,n.input.shiftKey,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,r,i||j.empty)))return!0;if(!i)return!1;let o=function(a){return a.openStart==0&&a.openEnd==0&&a.content.childCount==1?a.content.firstChild:null}(i),s=o?n.state.tr.replaceSelectionWith(o,n.input.shiftKey):n.state.tr.replaceSelection(i);return n.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}ue.copy=se.cut=(n,t)=>{let e=t,r=n.state.selection,i=e.type=="cut";if(r.empty)return;let o=Hr?null:e.clipboardData,s=r.content(),{dom:a,text:l}=ec(n,s);o?(e.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):function(c,u){if(!c.dom.parentNode)return;let d=c.dom.parentNode.appendChild(document.createElement("div"));d.appendChild(u),d.style.cssText="position: fixed; left: -10000px; top: 10px";let p=getSelection(),h=document.createRange();h.selectNodeContents(u),c.dom.blur(),p.removeAllRanges(),p.addRange(h),setTimeout(()=>{d.parentNode&&d.parentNode.removeChild(d),c.focus()},50)}(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},se.paste=(n,t)=>{let e=t;if(n.composing&&!Ye)return;let r=Hr?null:e.clipboardData;r&&_s(n,r.getData("text/plain"),r.getData("text/html"),e)?e.preventDefault():function(i,o){if(!i.dom.parentNode)return;let s=i.input.shiftKey||i.state.selection.$from.parent.type.spec.code,a=i.dom.parentNode.appendChild(document.createElement(s?"textarea":"div"));s||(a.contentEditable="true"),a.style.cssText="position: fixed; left: -10000px; top: 10px",a.focus(),setTimeout(()=>{i.focus(),a.parentNode&&a.parentNode.removeChild(a),s?_s(i,a.value,null,o):_s(i,a.textContent,a.innerHTML,o)},50)}(n,e)};class Yh{constructor(t,e){this.slice=t,this.move=e}}const fc=Ee?"altKey":"ctrlKey";ue.dragstart=(n,t)=>{let e=t,r=n.input.mouseDown;if(r&&r.done(),!e.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(po(e));if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof at?i.to-1:i.to))){if(r&&r.mightDrag)n.dispatch(n.state.tr.setSelection(at.create(n.state.doc,r.mightDrag.pos)));else if(e.target&&e.target.nodeType==1){let c=n.docView.nearestDesc(e.target,!0);c&&c.node.type.spec.draggable&&c!=n.docView&&n.dispatch(n.state.tr.setSelection(at.create(n.state.doc,c.posBefore)))}}let s=n.state.selection.content(),{dom:a,text:l}=ec(n,s);e.dataTransfer.clearData(),e.dataTransfer.setData(Hr?"Text":"text/html",a.innerHTML),e.dataTransfer.effectAllowed="copyMove",Hr||e.dataTransfer.setData("text/plain",l),n.dragging=new Yh(s,!e[fc])},ue.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)},se.dragover=se.dragenter=(n,t)=>t.preventDefault(),se.drop=(n,t)=>{let e=t,r=n.dragging;if(n.dragging=null,!e.dataTransfer)return;let i=n.posAtCoords(po(e));if(!i)return;let o=n.state.doc.resolve(i.pos);if(!o)return;let s=r&&r.slice;s?n.someProp("transformPasted",f=>{s=f(s)}):s=nc(n,e.dataTransfer.getData(Hr?"Text":"text/plain"),Hr?null:e.dataTransfer.getData("text/html"),!1,o);let a=!(!r||e[fc]);if(n.someProp("handleDrop",f=>f(n,e,s||j.empty,a)))return void e.preventDefault();if(!s)return;e.preventDefault();let l=s?function(f,m,g){let w=f.resolve(m);if(!g.content.size)return m;let C=g.content;for(let E=0;E<g.openStart;E++)C=C.firstChild.content;for(let E=1;E<=(g.openStart==0&&g.size?2:1);E++)for(let L=w.depth;L>=0;L--){let P=L==w.depth?0:w.pos<=(w.start(L+1)+w.end(L+1))/2?-1:1,A=w.index(L)+(P>0?1:0),H=w.node(L),B=!1;if(E==1)B=H.canReplace(A,A,C);else{let z=H.contentMatchAt(A).findWrapping(C.firstChild.type);B=z&&H.canReplaceWith(A,A,z[0])}if(B)return P==0?w.pos:P<0?w.before(L+1):w.after(L+1)}return null}(n.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);let c=n.state.tr;a&&c.deleteSelection();let u=c.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,p=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(p))return;let h=c.doc.resolve(u);if(d&&at.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new at(h));else{let f=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,g,w,C)=>f=C),c.setSelection(Os(n,h,c.doc.resolve(f)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))},ue.focus=n=>{n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelection())&&Mn(n)},20))},ue.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)},ue.beforeinput=(n,t)=>{if(oe&&Ye&&t.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:e}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=e||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,Pr(8,"Backspace")))))return;let{$cursor:r}=n.state.selection;r&&r.pos>0&&n.dispatch(n.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let n in se)ue[n]=se[n];function Oi(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class qs{constructor(t,e){this.toDOM=t,this.spec=e||or,this.side=this.spec.side||0}map(t,e,r,i){let{pos:o,deleted:s}=t.mapResult(e.from+i,this.side<0?-1:1);return s?null:new de(o-r,o-r,this)}valid(){return!0}eq(t){return this==t||t instanceof qs&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Oi(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class In{constructor(t,e){this.attrs=t,this.spec=e||or}map(t,e,r,i){let o=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-r,s=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new de(o,s,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof In&&Oi(this.attrs,t.attrs)&&Oi(this.spec,t.spec)}static is(t){return t.type instanceof In}destroy(){}}class $s{constructor(t,e){this.attrs=t,this.spec=e||or}map(t,e,r,i){let o=t.mapResult(e.from+i,1);if(o.deleted)return null;let s=t.mapResult(e.to+i,-1);return s.deleted||s.pos<=o.pos?null:new de(o.pos-r,s.pos-r,this)}valid(t,e){let r,{index:i,offset:o}=t.content.findIndex(e.from);return o==e.from&&!(r=t.child(i)).isText&&o+r.nodeSize==e.to}eq(t){return this==t||t instanceof $s&&Oi(this.attrs,t.attrs)&&Oi(this.spec,t.spec)}destroy(){}}class de{constructor(t,e,r){this.from=t,this.to=e,this.type=r}copy(t,e){return new de(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,r){return this.type.map(t,this,e,r)}static widget(t,e,r){return new de(t,t,new qs(e,r))}static inline(t,e,r,i){return new de(t,e,new In(r,i))}static node(t,e,r,i){return new de(t,e,new $s(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof In}}const zr=[],or={};class Rt{constructor(t,e){this.local=t.length?t:zr,this.children=e.length?e:zr}static create(t,e){return e.length?fo(e,t,0,or):te}find(t,e,r){let i=[];return this.findInner(t??0,e??1e9,i,0,r),i}findInner(t,e,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=e&&a.to>=t&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<e&&this.children[s+1]>t){let a=this.children[s]+1;this.children[s+2].findInner(t-a,e-a,r,i+a,o)}}map(t,e,r){return this==te||t.maps.length==0?this:this.mapInner(t,e,0,0,r||or)}mapInner(t,e,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(t,r,i);l&&l.type.valid(e,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?function(a,l,c,u,d,p,h){let f=a.slice(),m=(w,C,E,L)=>{for(let P=0;P<f.length;P+=3){let A,H=f[P+1];if(H<0||w>H+p)continue;let B=f[P]+p;C>=B?f[P+1]=w<=B?-2:-1:E>=d&&(A=L-E-(C-w))&&(f[P]+=A,f[P+1]+=A)}};for(let w=0;w<c.maps.length;w++)c.maps[w].forEach(m);let g=!1;for(let w=0;w<f.length;w+=3)if(f[w+1]<0){if(f[w+1]==-2){g=!0,f[w+1]=-1;continue}let C=c.map(a[w]+p),E=C-d;if(E<0||E>=u.content.size){g=!0;continue}let L=c.map(a[w+1]+p,-1)-d,{index:P,offset:A}=u.content.findIndex(E),H=u.maybeChild(P);if(H&&A==E&&A+H.nodeSize==L){let B=f[w+2].mapInner(c,H,C+1,a[w]+p+1,h);B!=te?(f[w]=E,f[w+1]=L,f[w+2]=B):(f[w+1]=-2,g=!0)}else g=!0}if(g){let w=function(E,L,P,A,H,B,z){function q(_,Y){for(let K=0;K<_.local.length;K++){let ot=_.local[K].map(A,H,Y);ot?P.push(ot):z.onRemove&&z.onRemove(_.local[K].spec)}for(let K=0;K<_.children.length;K+=3)q(_.children[K+2],_.children[K]+Y+1)}for(let _=0;_<E.length;_+=3)E[_+1]==-1&&q(E[_+2],L[_]+B+1);return P}(f,a,l,c,d,p,h),C=fo(w,u,0,h);l=C.local;for(let E=0;E<f.length;E+=3)f[E+1]<0&&(f.splice(E,3),E-=3);for(let E=0,L=0;E<C.children.length;E+=3){let P=C.children[E];for(;L<f.length&&f[L]<P;)L+=3;f.splice(L,0,C.children[E],C.children[E+1],C.children[E+2])}}return new Rt(l.sort(sr),f)}(this.children,s||[],t,e,r,i,o):s?new Rt(s.sort(sr),zr):te}add(t,e){return e.length?this==te?Rt.create(t,e):this.addInner(t,e,0):this}addInner(t,e,r){let i,o=0;t.forEach((a,l)=>{let c,u=l+r;if(c=gc(e,a,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,c,u+1):i.splice(o,0,l,l+a.nodeSize,fo(c,a,u+1,or)),o+=3}});let s=mc(o?vc(e):e,-r);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||s.splice(a--,1);return new Rt(s.length?this.local.concat(s).sort(sr):this.local,i||this.children)}remove(t){return t.length==0||this==te?this:this.removeInner(t,0)}removeInner(t,e){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+e,l=r[o+1]+e;for(let u,d=0;d<t.length;d++)(u=t[d])&&u.from>a&&u.to<l&&(t[d]=null,(s||(s=[])).push(u));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(s,a+1);c!=te?r[o+2]=c:(r.splice(o,3),o-=3)}if(i.length){for(let o,s=0;s<t.length;s++)if(o=t[s])for(let a=0;a<i.length;a++)i[a].eq(o,e)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Rt(i,r):te}forChild(t,e){if(this==te)return this;if(e.isLeaf)return Rt.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=t){this.children[a]==t&&(r=this.children[a+2]);break}let o=t+1,s=o+e.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof In){let c=Math.max(o,l.from)-o,u=Math.min(s,l.to)-o;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new Rt(i.sort(sr),zr);return r?new Nn([a,r]):a}return r||te}eq(t){if(this==t)return!0;if(!(t instanceof Rt)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return js(this.localsInner(t))}localsInner(t){if(this==te)return zr;if(t.inlineContent||!this.local.some(In.is))return this.local;let e=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof In||e.push(this.local[r]);return e}}Rt.empty=new Rt([],[]),Rt.removeOverlap=js;const te=Rt.empty;class Nn{constructor(t){this.members=t}map(t,e){const r=this.members.map(i=>i.map(t,e,or));return Nn.from(r)}forChild(t,e){if(e.isLeaf)return Rt.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(t,e);o!=te&&(o instanceof Nn?r=r.concat(o.members):r.push(o))}return Nn.from(r)}eq(t){if(!(t instanceof Nn)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(t);if(o.length)if(e){r&&(e=e.slice(),r=!1);for(let s=0;s<o.length;s++)e.push(o[s])}else e=o}return e?js(r?e:e.sort(sr)):zr}static from(t){switch(t.length){case 0:return te;case 1:return t[0];default:return new Nn(t)}}}function mc(n,t){if(!t||!n.length)return n;let e=[];for(let r=0;r<n.length;r++){let i=n[r];e.push(new de(i.from+t,i.to+t,i.type))}return e}function gc(n,t,e){if(t.isLeaf)return null;let r=e+t.nodeSize,i=null;for(let o,s=0;s<n.length;s++)(o=n[s])&&o.from>e&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function vc(n){let t=[];for(let e=0;e<n.length;e++)n[e]!=null&&t.push(n[e]);return t}function fo(n,t,e,r){let i=[],o=!1;t.forEach((a,l)=>{let c=gc(n,a,l+e);if(c){o=!0;let u=fo(c,a,e+l+1,r);u!=te&&i.push(l,l+a.nodeSize,u)}});let s=mc(o?vc(n):n,-e).sort(sr);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new Rt(s,i):te}function sr(n,t){return n.from-t.from||n.to-t.to}function js(n){let t=n;for(let e=0;e<t.length-1;e++){let r=t[e];if(r.from!=r.to)for(let i=e+1;i<t.length;i++){let o=t[i];if(o.from!=r.from){o.from<r.to&&(t==n&&(t=n.slice()),t[e]=r.copy(r.from,o.from),yc(t,i,r.copy(o.from,r.to)));break}o.to!=r.to&&(t==n&&(t=n.slice()),t[i]=o.copy(o.from,r.to),yc(t,i+1,o.copy(r.to,o.to)))}}return t}function yc(n,t,e){for(;t<n.length&&sr(e,n[t])>0;)t++;n.splice(t,0,e)}function Vs(n){let t=[];return n.someProp("decorations",e=>{let r=e(n.state);r&&r!=te&&t.push(r)}),n.cursorWrapper&&t.push(Rt.create(n.state.doc,[n.cursorWrapper.deco])),Nn.from(t)}const Qh={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Xh=ve&&En<=11;class Zh{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class tf{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Zh,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);ve&&En<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Xh&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Qh)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Gl(this.view)){if(this.suppressingSelectionUpdates)return Mn(this.view);if(ve&&En<=11&&!this.view.state.selection.empty){let t=this.view.domSelection();if(t.focusNode&&Ti(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelection())}ignoreSelectionChange(t){if(t.rangeCount==0)return!0;let e=t.getRangeAt(0).commonAncestorContainer,r=this.view.docView.nearestDesc(e);return r&&r.ignoreMutation({type:"selection",target:e.nodeType==3?e.parentNode:e})?(this.setCurSelection(),!0):void 0}flush(){if(!this.view.docView||this.flushingSoon>-1)return;let t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);let e=this.view.domSelection(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&Gl(this.view)&&!this.ignoreSelectionChange(e),i=-1,o=-1,s=!1,a=[];if(this.view.editable)for(let l=0;l<t.length;l++){let c=this.registerMutation(t[l],a);c&&(i=i<0?c.from:Math.min(c.from,i),o=o<0?c.to:Math.max(c.to,o),c.typeOver&&(s=!0))}if(Je&&a.length>1){let l=a.filter(c=>c.nodeName=="BR");if(l.length==2){let c=l[0],u=l[1];c.parentNode&&c.parentNode.parentNode==u.parentNode?u.remove():c.remove()}}(i>-1||r)&&(i>-1&&(this.view.docView.markDirty(i,o),function(l){bc||(bc=!0,getComputedStyle(l.dom).whiteSpace=="normal"&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))}(this.view)),this.handleDOMChange(i,o,s,a),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||Mn(this.view),this.currentSelection.set(e))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(let c=0;c<t.addedNodes.length;c++)e.push(t.addedNodes[c]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};let i=t.previousSibling,o=t.nextSibling;if(ve&&En<=11&&t.addedNodes.length)for(let c=0;c<t.addedNodes.length;c++){let{previousSibling:u,nextSibling:d}=t.addedNodes[c];(!u||Array.prototype.indexOf.call(t.addedNodes,u)<0)&&(i=u),(!d||Array.prototype.indexOf.call(t.addedNodes,d)<0)&&(o=d)}let s=i&&i.parentNode==t.target?ye(i)+1:0,a=r.localPosFromDOM(t.target,s,-1),l=o&&o.parentNode==t.target?ye(o):t.target.childNodes.length;return{from:a,to:r.localPosFromDOM(t.target,l,1)}}return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let bc=!1;function ef(n){let t=n.pmViewDesc;if(t)return t.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(ce&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(n.parentNode.lastChild==n||ce&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}function nf(n,t,e,r,i){if(t<0){let B=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,z=ql(n,B);if(z&&!n.state.selection.eq(z)){let q=n.state.tr.setSelection(z);B=="pointer"?q.setMeta("pointer",!0):B=="key"&&q.scrollIntoView(),n.dispatch(q)}return}let o=n.state.doc.resolve(t),s=o.sharedDepth(e);t=o.before(s+1),e=n.state.doc.resolve(e).after(s+1);let a=n.state.selection,l=function(B,z,q){let _,{node:Y,fromOffset:K,toOffset:ot,from:pt,to:Tt}=B.docView.parseRange(z,q),ne=B.domSelection(),ft=ne.anchorNode;if(ft&&B.dom.contains(ft.nodeType==1?ft:ft.parentNode)&&(_=[{node:ft,offset:ne.anchorOffset}],Cs(ne)||_.push({node:ne.focusNode,offset:ne.focusOffset})),oe&&B.input.lastKeyCode===8)for(let pn=ot;pn>K;pn--){let Hn=Y.childNodes[pn-1],fr=Hn.pmViewDesc;if(Hn.nodeName=="BR"&&!fr){ot=pn;break}if(!fr||fr.size)break}let dn=B.state.doc,Me=B.someProp("domParser")||lt.fromSchema(B.state.schema),Bn=dn.resolve(pt),ri=null,ii=Me.parse(Y,{topNode:Bn.parent,topMatch:Bn.parent.contentMatchAt(Bn.index()),topOpen:!0,from:K,to:ot,preserveWhitespace:Bn.parent.type.whitespace!="pre"||"full",findPositions:_,ruleFromNode:ef,context:Bn});if(_&&_[0].pos!=null){let pn=_[0].pos,Hn=_[1]&&_[1].pos;Hn==null&&(Hn=pn),ri={anchor:pn+pt,head:Hn+pt}}return{doc:ii,sel:ri,from:pt,to:Tt}}(n,t,e);if(oe&&n.cursorWrapper&&l.sel&&l.sel.anchor==n.cursorWrapper.deco.from&&l.sel.head==l.sel.anchor){let B=n.cursorWrapper.deco.type.toDOM.nextSibling,z=B&&B.nodeValue?B.nodeValue.length:1;l.sel={anchor:l.sel.anchor+z,head:l.sel.anchor+z}}let c,u,d=n.state.doc,p=d.slice(l.from,l.to);n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(c=n.state.selection.to,u="end"):(c=n.state.selection.from,u="start"),n.input.lastKeyCode=null;let h=function(B,z,q,_,Y){let K=B.findDiffStart(z,q);if(K==null)return null;let{a:ot,b:pt}=B.findDiffEnd(z,q+B.size,q+z.size);return Y=="end"&&(_-=ot+Math.max(0,K-Math.min(ot,pt))-K),ot<K&&B.size<z.size?(K-=_<=K&&_>=ot?K-_:0,pt=K+(pt-ot),ot=K):pt<K&&(K-=_<=K&&_>=pt?K-_:0,ot=K+(ot-pt),pt=K),{start:K,endA:ot,endB:pt}}(p.content,l.doc.content,l.from,c,u);if((Rr&&n.input.lastIOSEnter>Date.now()-225||Ye)&&i.some(B=>B.nodeName=="DIV"||B.nodeName=="P")&&(!h||h.endA>=h.endB)&&n.someProp("handleKeyDown",B=>B(n,Pr(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(!h){if(!(r&&a instanceof dt&&!a.empty&&a.$head.sameParent(a.$anchor))||n.composing||l.sel&&l.sel.anchor!=l.sel.head){if(l.sel){let B=wc(n,n.state.doc,l.sel);B&&!B.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(B))}return}h={start:a.from,endA:a.to,endB:a.to}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&h.start==h.endB&&n.state.selection instanceof dt&&(h.start>n.state.selection.from&&h.start<=n.state.selection.from+2&&n.state.selection.from>=l.from?h.start=n.state.selection.from:h.endA<n.state.selection.to&&h.endA>=n.state.selection.to-2&&n.state.selection.to<=l.to&&(h.endB+=n.state.selection.to-h.endA,h.endA=n.state.selection.to)),ve&&En<=11&&h.endB==h.start+1&&h.endA==h.start&&h.start>l.from&&l.doc.textBetween(h.start-l.from-1,h.start-l.from+1)=="  "&&(h.start--,h.endA--,h.endB--);let f,m=l.doc.resolveNoCache(h.start-l.from),g=l.doc.resolveNoCache(h.endB-l.from),w=d.resolve(h.start),C=m.sameParent(g)&&m.parent.inlineContent&&w.end()>=h.endA;if((Rr&&n.input.lastIOSEnter>Date.now()-225&&(!C||i.some(B=>B.nodeName=="DIV"||B.nodeName=="P"))||!C&&m.pos<l.doc.content.size&&(f=G.findFrom(l.doc.resolve(m.pos+1),1,!0))&&f.head==g.pos)&&n.someProp("handleKeyDown",B=>B(n,Pr(13,"Enter"))))return void(n.input.lastIOSEnter=0);if(n.state.selection.anchor>h.start&&function(B,z,q,_,Y){if(!_.parent.isTextblock||q-z<=Y.pos-_.pos||Us(_,!0,!1)<Y.pos)return!1;let K=B.resolve(z);if(K.parentOffset<K.parent.content.size||!K.parent.isTextblock)return!1;let ot=B.resolve(Us(K,!0,!0));return!(!ot.parent.isTextblock||ot.pos>q||Us(ot,!0,!1)<q)&&_.parent.content.cut(_.parentOffset).eq(ot.parent.content)}(d,h.start,h.endA,m,g)&&n.someProp("handleKeyDown",B=>B(n,Pr(8,"Backspace"))))return void(Ye&&oe&&n.domObserver.suppressSelectionUpdates());oe&&Ye&&h.endB==h.start&&(n.input.lastAndroidDelete=Date.now()),Ye&&!C&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&l.sel&&l.sel.anchor==l.sel.head&&l.sel.head==h.endA&&(h.endB-=2,g=l.doc.resolveNoCache(h.endB-l.from),setTimeout(()=>{n.someProp("handleKeyDown",function(B){return B(n,Pr(13,"Enter"))})},20));let E,L,P,A=h.start,H=h.endA;if(C){if(m.pos==g.pos)ve&&En<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Mn(n),20)),E=n.state.tr.delete(A,H),L=d.resolve(h.start).marksAcross(d.resolve(h.endA));else if(h.endA==h.endB&&(P=function(B,z){let q,_,Y,K=B.firstChild.marks,ot=z.firstChild.marks,pt=K,Tt=ot;for(let ft=0;ft<ot.length;ft++)pt=ot[ft].removeFromSet(pt);for(let ft=0;ft<K.length;ft++)Tt=K[ft].removeFromSet(Tt);if(pt.length==1&&Tt.length==0)_=pt[0],q="add",Y=ft=>ft.mark(_.addToSet(ft.marks));else{if(pt.length!=0||Tt.length!=1)return null;_=Tt[0],q="remove",Y=ft=>ft.mark(_.removeFromSet(ft.marks))}let ne=[];for(let ft=0;ft<z.childCount;ft++)ne.push(Y(z.child(ft)));if(S.from(ne).eq(B))return{mark:_,type:q}}(m.parent.content.cut(m.parentOffset,g.parentOffset),w.parent.content.cut(w.parentOffset,h.endA-w.start()))))E=n.state.tr,P.type=="add"?E.addMark(A,H,P.mark):E.removeMark(A,H,P.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let B=m.parent.textBetween(m.parentOffset,g.parentOffset);if(n.someProp("handleTextInput",z=>z(n,A,H,B)))return;E=n.state.tr.insertText(B,A,H)}}if(E||(E=n.state.tr.replace(A,H,l.doc.slice(h.start-l.from,h.endB-l.from))),l.sel){let B=wc(n,E.doc,l.sel);B&&!(oe&&Ye&&n.composing&&B.empty&&(h.start!=h.endB||n.input.lastAndroidDelete<Date.now()-100)&&(B.head==A||B.head==E.mapping.map(H)-1)||ve&&B.empty&&B.head==A)&&E.setSelection(B)}L&&E.ensureMarks(L),n.dispatch(E.scrollIntoView())}function wc(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:Os(n,t.resolve(e.anchor),t.resolve(e.head))}function Us(n,t,e){let r=n.depth,i=t?n.end():n.pos;for(;r>0&&(t||n.indexAfter(r)==n.node(r).childCount);)r--,i++,t=!1;if(e){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}class Ws{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new jh,this.prevDirectPlugins=[],this.pluginViews=[],this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(Tc),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Cc(this),xc(this),this.nodeViews=Ec(this),this.docView=Pl(this.state.doc,kc(this),Vs(this),this.dom,this),this.domObserver=new tf(this,(r,i,o,s)=>nf(this,r,i,o,s)),this.domObserver.start(),function(r){for(let i in ue){let o=ue[i];r.dom.addEventListener(i,r.input.eventHandlers[i]=s=>{!Vh(r,s)||Bs(r,s)||!r.editable&&s.type in se||o(r,s)})}ce&&r.dom.addEventListener("input",()=>null),Fs(r)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Fs(this),this._props=t,t.plugins&&(t.plugins.forEach(Tc),this.directPlugins=t.plugins),this.updateStateInner(t.state,!0)}setProps(t){let e={};for(let r in this._props)e[r]=this._props[r];e.state=this.state;for(let r in t)e[r]=t[r];this.update(e)}updateState(t){this.updateStateInner(t,this.state.plugins!=t.plugins)}updateStateInner(t,e){let r=this.state,i=!1,o=!1;if(t.storedMarks&&this.composing&&(hc(this),o=!0),this.state=t,e){let d=Ec(this);(function(p,h){let f=0,m=0;for(let g in p){if(p[g]!=h[g])return!0;f++}for(let g in h)m++;return f!=m})(d,this.nodeViews)&&(this.nodeViews=d,i=!0),Fs(this)}this.editable=Cc(this),xc(this);let s=Vs(this),a=kc(this),l=e?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",c=i||!this.docView.matchesNode(t.doc,a,s);!c&&t.selection.eq(r.selection)||(o=!0);let u=l=="preserve"&&o&&this.dom.style.overflowAnchor==null&&function(d){let p,h,f=d.dom.getBoundingClientRect(),m=Math.max(0,f.top);for(let g=(f.left+f.right)/2,w=m+1;w<Math.min(innerHeight,f.bottom);w+=5){let C=d.root.elementFromPoint(g,w);if(!C||C==d.dom||!d.dom.contains(C))continue;let E=C.getBoundingClientRect();if(E.top>=m-20){p=C,h=E.top;break}}return{refDOM:p,refTop:h,stack:Tl(d.dom)}}(this);if(o){this.domObserver.stop();let d=c&&(ve||oe)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&function(p,h){let f=Math.min(p.$anchor.sharedDepth(p.head),h.$anchor.sharedDepth(h.head));return p.$anchor.start(f)!=h.$anchor.start(f)}(r.selection,t.selection);if(c){let p=oe?this.trackWrites=this.domSelection().focusNode:null;!i&&this.docView.update(t.doc,a,s,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Pl(t.doc,a,s,this.dom,this)),p&&!this.trackWrites&&(d=!0)}d||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelection())&&function(p){let h=p.docView.domFromPos(p.state.selection.anchor,0),f=p.domSelection();return Ti(h.node,h.offset,f.anchorNode,f.anchorOffset)}(this))?Mn(this,d):(Wl(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),l=="reset")this.dom.scrollTop=0;else if(l=="to selection"){let d=this.domSelection().focusNode;if(!this.someProp("handleScrollToSelection",p=>p(this)))if(t.selection instanceof at){let p=this.docView.domAfterPos(t.selection.from);p.nodeType==1&&El(this,p.getBoundingClientRect(),d)}else El(this,this.coordsAtPos(t.selection.head,1),d)}else u&&function({refDOM:d,refTop:p,stack:h}){let f=d?d.getBoundingClientRect().top:0;Sl(h,f==0?0:f-p)}(u)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let e=0;e<this.pluginViews.length;e++){let r=this.pluginViews[e];r.update&&r.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let r=this.directPlugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let r=this.state.plugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}}someProp(t,e){let r,i=this._props&&this._props[t];if(i!=null&&(r=e?e(i):i))return r;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[t];if(a!=null&&(r=e?e(a):a))return r}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[t];if(a!=null&&(r=e?e(a):a))return r}}hasFocus(){return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(Fr)return t.focus(Fr);let e=Tl(t);t.focus(Fr==null?{get preventScroll(){return Fr={preventScroll:!0},!0}}:void 0),Fr||(Fr=!1,Sl(e,0))}(this.dom),Mn(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let e=this.dom.parentNode;e;e=e.parentNode)if(e.nodeType==9||e.nodeType==11&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return t||document}posAtCoords(t){return Ah(this,t)}coordsAtPos(t,e=1){return Nl(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,r=-1){let i=this.docView.posFromDOM(t,e,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return Ph(this,e||this.state,t)}destroy(){this.docView&&(function(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Vs(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(t){return function(e,r){Bs(e,r)||!ue[r.type]||!e.editable&&r.type in se||ue[r.type](e,r)}(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelection(){return this.root.getSelection()}}function kc(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),t.translate="no",n.someProp("attributes",e=>{if(typeof e=="function"&&(e=e(n.state)),e)for(let r in e)r=="class"&&(t.class+=" "+e[r]),r=="style"?t.style=(t.style?t.style+";":"")+e[r]:t[r]||r=="contenteditable"||r=="nodeName"||(t[r]=String(e[r]))}),[de.node(0,n.state.doc.content.size,t)]}function xc(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:de.widget(n.state.selection.head,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Cc(n){return!n.someProp("editable",t=>t(n.state)===!1)}function Ec(n){let t=Object.create(null);function e(r){for(let i in r)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=r[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function Tc(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}for(var rf=b(354),rn=b.n(rf),On={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},mo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},Sc=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),of=typeof navigator<"u"&&/Apple Computer/.test(navigator.vendor),sf=typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent),Mc=typeof navigator<"u"&&/Mac/.test(navigator.platform),af=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),lf=Sc&&(Mc||+Sc[1]<57)||sf&&Mc,Kt=0;Kt<10;Kt++)On[48+Kt]=On[96+Kt]=String(Kt);for(Kt=1;Kt<=24;Kt++)On[Kt+111]="F"+Kt;for(Kt=65;Kt<=90;Kt++)On[Kt]=String.fromCharCode(Kt+32),mo[Kt]=String.fromCharCode(Kt);for(var Ks in On)mo.hasOwnProperty(Ks)||(mo[Ks]=On[Ks]);const cf=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function uf(n){let t,e,r,i,o=n.split(/-(?!$)/),s=o[o.length-1];s=="Space"&&(s=" ");for(let a=0;a<o.length-1;a++){let l=o[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))t=!0;else if(/^(c|ctrl|control)$/i.test(l))e=!0;else if(/^s(hift)?$/i.test(l))r=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);cf?i=!0:e=!0}}return t&&(s="Alt-"+s),e&&(s="Ctrl-"+s),i&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function Gs(n,t,e){return t.altKey&&(n="Alt-"+n),t.ctrlKey&&(n="Ctrl-"+n),t.metaKey&&(n="Meta-"+n),e!==!1&&t.shiftKey&&(n="Shift-"+n),n}function Li(n){return new le({props:{handleKeyDown:df(n)}})}function df(n){let t=function(e){let r=Object.create(null);for(let i in e)r[uf(i)]=e[i];return r}(n);return function(e,r){let i,o=function(l){var c=!(lf&&(l.ctrlKey||l.altKey||l.metaKey)||(of||af)&&l.shiftKey&&l.key&&l.key.length==1)&&l.key||(l.shiftKey?mo:On)[l.keyCode]||l.key||"Unidentified";return c=="Esc"&&(c="Escape"),c=="Del"&&(c="Delete"),c=="Left"&&(c="ArrowLeft"),c=="Up"&&(c="ArrowUp"),c=="Right"&&(c="ArrowRight"),c=="Down"&&(c="ArrowDown"),c}(r),s=o.length==1&&o!=" ",a=t[Gs(o,r,!s)];if(a&&a(e.state,e.dispatch,e))return!0;if(s&&(r.shiftKey||r.altKey||r.metaKey||o.charCodeAt(0)>127)&&(i=On[r.keyCode])&&i!=o){let l=t[Gs(i,r,!0)];if(l&&l(e.state,e.dispatch,e))return!0}else if(s&&r.shiftKey){let l=t[Gs(o,r,!0)];if(l&&l(e.state,e.dispatch,e))return!0}return!1}}const Js=(n,t)=>!n.selection.empty&&(t&&t(n.tr.deleteSelection().scrollIntoView()),!0);function _r(n,t,e=!1){for(let r=n;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(e&&r.childCount!=1)return!1}return!1}function Ic(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}const Nc=(n,t,e)=>{let{$cursor:r}=n.selection;if(!r||(e?!e.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size))return!1;let i=Oc(r);if(!i)return!1;let o=i.nodeAfter;if(Dc(n,i,t))return!0;if(r.parent.content.size==0&&(_r(o,"start")||at.isSelectable(o))){let s=Lr(n.doc,r.before(),r.after(),j.empty);if(s&&s.slice.size<s.to-s.from){if(t){let a=n.tr.step(s);a.setSelection(_r(o,"start")?G.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):at.create(a.doc,a.mapping.map(i.pos))),t(a.scrollIntoView())}return!0}}return!(!o.isAtom||i.depth!=r.depth-1)&&(t&&t(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0)};function Oc(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const Lc=(n,t)=>{let{$head:e,$anchor:r}=n.selection;return!(!e.parent.type.spec.code||!e.sameParent(r))&&(t&&t(n.tr.insertText(`
`).scrollIntoView()),!0)};function Ys(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const Qs=(n,t)=>{let{$head:e,$anchor:r}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(r))return!1;let i=e.node(-1),o=e.indexAfter(-1),s=Ys(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(t){let a=e.after(),l=n.tr.replaceWith(a,a,s.createAndFill());l.setSelection(G.near(l.doc.resolve(a),1)),t(l.scrollIntoView())}return!0},pf=(n,t)=>{let{$from:e,$to:r}=n.selection;if(n.selection instanceof at&&n.selection.node.isBlock)return!(!e.parentOffset||!Ge(n.doc,e.pos))&&(t&&t(n.tr.split(e.pos).scrollIntoView()),!0);if(!e.parent.isBlock)return!1;if(t){let i=r.parentOffset==r.parent.content.size,o=n.tr;(n.selection instanceof dt||n.selection instanceof Zt)&&o.deleteSelection();let s=e.depth==0?null:Ys(e.node(-1).contentMatchAt(e.indexAfter(-1))),a=i&&s?[{type:s}]:void 0,l=Ge(o.doc,o.mapping.map(e.pos),1,a);if(a||l||!Ge(o.doc,o.mapping.map(e.pos),1,s?[{type:s}]:void 0)||(s&&(a=[{type:s}]),l=!0),l&&(o.split(o.mapping.map(e.pos),1,a),!i&&!e.parentOffset&&e.parent.type!=s)){let c=o.mapping.map(e.before()),u=o.doc.resolve(c);s&&e.node(-1).canReplaceWith(u.index(),u.index()+1,s)&&o.setNodeMarkup(o.mapping.map(e.before()),s)}t(o.scrollIntoView())}return!0},Ac=(n,t)=>(t&&t(n.tr.setSelection(new Zt(n.doc))),!0);function Dc(n,t,e){let r,i,o=t.nodeBefore,s=t.nodeAfter;if(o.type.spec.isolating||s.type.spec.isolating)return!1;if(function(d,p,h){let f=p.nodeBefore,m=p.nodeAfter,g=p.index();return!(!(f&&m&&f.type.compatibleContent(m.type))||(!f.content.size&&p.parent.canReplace(g-1,g)?(h&&h(d.tr.delete(p.pos-f.nodeSize,p.pos).scrollIntoView()),0):!p.parent.canReplace(g,g+1)||!m.isTextblock&&!io(d.doc,p.pos)||(h&&h(d.tr.clearIncompatible(p.pos,f.type,f.contentMatchAt(f.childCount)).join(p.pos).scrollIntoView()),0)))}(n,t,e))return!0;let a=t.parent.canReplace(t.index(),t.index()+1);if(a&&(r=(i=o.contentMatchAt(o.childCount)).findWrapping(s.type))&&i.matchType(r[0]||s.type).validEnd){if(e){let d=t.pos+s.nodeSize,p=S.empty;for(let m=r.length-1;m>=0;m--)p=S.from(r[m].create(null,p));p=S.from(o.copy(p));let h=n.tr.step(new Mt(t.pos-1,d,t.pos,d,new j(p,1,0),r.length,!0)),f=d+2*r.length;io(h.doc,f)&&h.join(f),e(h.scrollIntoView())}return!0}let l=G.findFrom(t,1),c=l&&l.$from.blockRange(l.$to),u=c&&Yn(c);if(u!=null&&u>=t.depth)return e&&e(n.tr.lift(c,u).scrollIntoView()),!0;if(a&&_r(s,"start",!0)&&_r(o,"end")){let d=o,p=[];for(;p.push(d),!d.isTextblock;)d=d.lastChild;let h=s,f=1;for(;!h.isTextblock;h=h.firstChild)f++;if(d.canReplace(d.childCount,d.childCount,h.content)){if(e){let m=S.empty;for(let g=p.length-1;g>=0;g--)m=S.from(p[g].copy(m));e(n.tr.step(new Mt(t.pos-p.length,t.pos+s.nodeSize,t.pos+f,t.pos+s.nodeSize-f,new j(m,p.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Rc(n){return function(t,e){let r=t.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return!!i.node(o).isTextblock&&(e&&e(t.tr.setSelection(dt.create(t.doc,n<0?i.start(o):i.end(o)))),!0)}}const hf=Rc(-1),ff=Rc(1);function mf(n,t=null){return function(e,r){let{$from:i,$to:o}=e.selection,s=i.blockRange(o),a=s&&function(l,c,u=null,d=l){let p=function(f,m){let{parent:g,startIndex:w,endIndex:C}=f,E=g.contentMatchAt(w).findWrapping(m);if(!E)return null;let L=E.length?E[0]:m;return g.canReplaceWith(w,C,L)?E:null}(l,c),h=p&&function(f,m){let{parent:g,startIndex:w,endIndex:C}=f,E=g.child(w),L=m.contentMatch.findWrapping(E.type);if(!L)return null;let P=(L.length?L[L.length-1]:m).contentMatch;for(let A=w;P&&A<C;A++)P=P.matchType(g.child(A).type);return P&&P.validEnd?L:null}(d,c);return h?p.map(Qn).concat({type:c,attrs:u}).concat(h.map(Qn)):null}(s,n,t);return!!a&&(r&&r(e.tr.wrap(s,a).scrollIntoView()),!0)}}function Xs(n,t=null){return function(e,r){let{from:i,to:o}=e.selection,s=!1;return e.doc.nodesBetween(i,o,(a,l)=>{if(s)return!1;if(a.isTextblock&&!a.hasMarkup(n,t))if(a.type==n)s=!0;else{let c=e.doc.resolve(l),u=c.index();s=c.parent.canReplaceWith(u,u+1,n)}}),!!s&&(r&&r(e.tr.setBlockType(i,o,n,t).scrollIntoView()),!0)}}function Ai(n,t=null){return function(e,r){let{empty:i,$cursor:o,ranges:s}=e.selection;if(i&&!o||!function(a,l,c){for(let u=0;u<l.length;u++){let{$from:d,$to:p}=l[u],h=d.depth==0&&a.type.allowsMarkType(c);if(a.nodesBetween(d.pos,p.pos,f=>{if(h)return!1;h=f.inlineContent&&f.type.allowsMarkType(c)}),h)return!0}return!1}(e.doc,s,n))return!1;if(r)if(o)n.isInSet(e.storedMarks||o.marks())?r(e.tr.removeStoredMark(n)):r(e.tr.addStoredMark(n.create(t)));else{let a=!1,l=e.tr;for(let c=0;!a&&c<s.length;c++){let{$from:u,$to:d}=s[c];a=e.doc.rangeHasMark(u.pos,d.pos,n)}for(let c=0;c<s.length;c++){let{$from:u,$to:d}=s[c];if(a)l.removeMark(u.pos,d.pos,n);else{let p=u.pos,h=d.pos,f=u.nodeAfter,m=d.nodeBefore,g=f&&f.isText?/^\s*/.exec(f.text)[0].length:0,w=m&&m.isText?/\s*$/.exec(m.text)[0].length:0;p+g<h&&(p+=g,h-=w),l.addMark(p,h,n.create(t))}}r(l.scrollIntoView())}return!0}}function go(...n){return function(t,e,r){for(let i=0;i<n.length;i++)if(n[i](t,e,r))return!0;return!1}}let Zs=go(Js,(n,t,e)=>{let{$cursor:r}=n.selection;if(!r||(e?!e.endOfTextblock("backward",n):r.parentOffset>0))return!1;let i=Ic(r);if(!i){let s=r.blockRange(),a=s&&Yn(s);return a!=null&&(t&&t(n.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(!o.type.spec.isolating&&Dc(n,i,t))return!0;if(r.parent.content.size==0&&(_r(o,"end")||at.isSelectable(o))){let s=Lr(n.doc,r.before(),r.after(),j.empty);if(s&&s.slice.size<s.to-s.from){if(t){let a=n.tr.step(s);a.setSelection(_r(o,"end")?G.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):at.create(a.doc,i.pos-o.nodeSize)),t(a.scrollIntoView())}return!0}}return!(!o.isAtom||i.depth!=r.depth-1)&&(t&&t(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0)},(n,t,e)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=Ic(r)}let s=o&&o.nodeBefore;return!(!s||!at.isSelectable(s))&&(t&&t(n.tr.setSelection(at.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)}),Pc=go(Js,Nc,(n,t,e)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=Oc(r)}let s=o&&o.nodeAfter;return!(!s||!at.isSelectable(s))&&(t&&t(n.tr.setSelection(at.create(n.doc,o.pos)).scrollIntoView()),!0)});const on={Enter:go(Lc,(n,t)=>{let e=n.selection,{$from:r,$to:i}=e;if(e instanceof Zt||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=Ys(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(t){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(s,o.createAndFill());a.setSelection(dt.create(a.doc,s+1)),t(a.scrollIntoView())}return!0},(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let o=e.before();if(Ge(n.doc,o))return t&&t(n.tr.split(o).scrollIntoView()),!0}let r=e.blockRange(),i=r&&Yn(r);return i!=null&&(t&&t(n.tr.lift(r,i).scrollIntoView()),!0)},pf),"Mod-Enter":Qs,Backspace:Zs,"Mod-Backspace":Zs,"Shift-Backspace":Zs,Delete:Pc,"Mod-Delete":Pc,"Mod-a":Ac},Fc={"Ctrl-h":on.Backspace,"Alt-Backspace":on["Mod-Backspace"],"Ctrl-d":on.Delete,"Ctrl-Alt-Backspace":on["Mod-Delete"],"Alt-Delete":on["Mod-Delete"],"Alt-d":on["Mod-Delete"],"Ctrl-a":hf,"Ctrl-e":ff};for(let n in on)Fc[n]=on[n];const Bc=(typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!(typeof os>"u"||!os.platform)&&os.platform()=="darwin")?Fc:on;class Ln{constructor(t,e){var r;this.match=t,this.match=t,this.handler=typeof e=="string"?(r=e,function(i,o,s,a){let l=r;if(o[1]){let c=o[0].lastIndexOf(o[1]);l+=o[0].slice(c+o[1].length);let u=(s+=c)-a;u>0&&(l=o[0].slice(c-u,c)+l,s=a)}return i.tr.insertText(l,s,a)}):e}}function Hc({rules:n}){let t=new le({state:{init:()=>null,apply(e,r){return e.getMeta(this)||(e.selectionSet||e.docChanged?null:r)}},props:{handleTextInput:(e,r,i,o)=>zc(e,r,i,o,n,t),handleDOMEvents:{compositionend:e=>{setTimeout(()=>{let{$cursor:r}=e.state.selection;r&&zc(e,r.pos,r.pos,"",n,t)})}}},isInputRules:!0});return t}function zc(n,t,e,r,i,o){if(n.composing)return!1;let s=n.state,a=s.doc.resolve(t);if(a.parent.type.spec.code)return!1;let l=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,null,"")+r;for(let c=0;c<i.length;c++){let u=i[c].match.exec(l),d=u&&i[c].handler(s,u,t-(u[0].length-r.length),e);if(d)return n.dispatch(d.setMeta(o,{transform:d,from:t,to:e,text:r})),!0}return!1}const gf=(n,t)=>{let e=n.plugins;for(let r=0;r<e.length;r++){let i,o=e[r];if(o.spec.isInputRules&&(i=o.getState(n))){if(t){let s=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l--)s.step(a.steps[l].invert(a.docs[l]));if(i.text){let l=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else s.delete(i.from,i.to);t(s)}return!0}}return!1};new Ln(/--$/,""),new Ln(/\.\.\.$/,""),new Ln(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,""),new Ln(/"$/,""),new Ln(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,""),new Ln(/'$/,"");var vo=200,Gt=function(){};Gt.prototype.append=function(n){return n.length?(n=Gt.from(n),!this.length&&n||n.length<vo&&this.leafAppend(n)||this.length<vo&&n.leafPrepend(this)||this.appendInner(n)):this},Gt.prototype.prepend=function(n){return n.length?Gt.from(n).append(this):this},Gt.prototype.appendInner=function(n){return new vf(this,n)},Gt.prototype.slice=function(n,t){return n===void 0&&(n=0),t===void 0&&(t=this.length),n>=t?Gt.empty:this.sliceInner(Math.max(0,n),Math.min(this.length,t))},Gt.prototype.get=function(n){if(!(n<0||n>=this.length))return this.getInner(n)},Gt.prototype.forEach=function(n,t,e){t===void 0&&(t=0),e===void 0&&(e=this.length),t<=e?this.forEachInner(n,t,e,0):this.forEachInvertedInner(n,t,e,0)},Gt.prototype.map=function(n,t,e){t===void 0&&(t=0),e===void 0&&(e=this.length);var r=[];return this.forEach(function(i,o){return r.push(n(i,o))},t,e),r},Gt.from=function(n){return n instanceof Gt?n:n&&n.length?new _c(n):Gt.empty};var _c=function(n){function t(r){n.call(this),this.values=r}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(r,i){return r==0&&i==this.length?this:new t(this.values.slice(r,i))},t.prototype.getInner=function(r){return this.values[r]},t.prototype.forEachInner=function(r,i,o,s){for(var a=i;a<o;a++)if(r(this.values[a],s+a)===!1)return!1},t.prototype.forEachInvertedInner=function(r,i,o,s){for(var a=i-1;a>=o;a--)if(r(this.values[a],s+a)===!1)return!1},t.prototype.leafAppend=function(r){if(this.length+r.length<=vo)return new t(this.values.concat(r.flatten()))},t.prototype.leafPrepend=function(r){if(this.length+r.length<=vo)return new t(r.flatten().concat(this.values))},e.length.get=function(){return this.values.length},e.depth.get=function(){return 0},Object.defineProperties(t.prototype,e),t}(Gt);Gt.empty=new _c([]);var vf=function(n){function t(e,r){n.call(this),this.left=e,this.right=r,this.length=e.length+r.length,this.depth=Math.max(e.depth,r.depth)+1}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,r,i,o){var s=this.left.length;return!(r<s&&this.left.forEachInner(e,r,Math.min(i,s),o)===!1)&&!(i>s&&this.right.forEachInner(e,Math.max(r-s,0),Math.min(this.length,i)-s,o+s)===!1)&&void 0},t.prototype.forEachInvertedInner=function(e,r,i,o){var s=this.left.length;return!(r>s&&this.right.forEachInvertedInner(e,r-s,Math.max(i,s)-s,o+s)===!1)&&!(i<s&&this.left.forEachInvertedInner(e,Math.min(r,s),i,o)===!1)&&void 0},t.prototype.sliceInner=function(e,r){if(e==0&&r==this.length)return this;var i=this.left.length;return r<=i?this.left.slice(e,r):e>=i?this.right.slice(e-i,r-i):this.left.slice(e,i).append(this.right.slice(0,r-i))},t.prototype.leafAppend=function(e){var r=this.right.leafAppend(e);if(r)return new t(this.left,r)},t.prototype.leafPrepend=function(e){var r=this.left.leafPrepend(e);if(r)return new t(r,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(Gt),qc=Gt;class Pe{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(this.eventCount==0)return null;let r,i,o=this.items.length;for(;;o--)if(this.items.get(o-1).selection){--o;break}e&&(r=this.remapping(o,this.items.length),i=r.maps.length);let s,a,l=t.tr,c=[],u=[];return this.items.forEach((d,p)=>{if(!d.step)return r||(r=this.remapping(o,p+1),i=r.maps.length),i--,void u.push(d);if(r){u.push(new Xe(d.map));let h,f=d.step.map(r.slice(i));f&&l.maybeStep(f).doc&&(h=l.mapping.maps[l.mapping.maps.length-1],c.push(new Xe(h,void 0,void 0,c.length+u.length))),i--,h&&r.appendMap(h,i)}else l.maybeStep(d.step);return d.selection?(s=r?d.selection.map(r.slice(i)):d.selection,a=new Pe(this.items.slice(0,o).append(u.reverse().concat(c)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:a,transform:l,selection:s}}addTransform(t,e,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<t.steps.length;u++){let d,p=t.steps[u].invert(t.docs[u]),h=new Xe(t.mapping.maps[u],p,e);(d=l&&l.merge(h))&&(h=d,u?o.pop():a=a.slice(0,a.length-1)),o.push(h),e&&(s++,e=void 0),i||(l=h)}let c=s-r.depth;return c>yf&&(a=function(u,d){let p;return u.forEach((h,f)=>{if(h.selection&&d--==0)return p=f,!1}),u.slice(p)}(a,c),s-=c),new Pe(a.append(o),s)}remapping(t,e){let r=new ie;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=t?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},t,e),r}addMaps(t){return this.eventCount==0?this:new Pe(this.items.append(t.map(e=>new Xe(e))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-e),o=t.mapping,s=t.steps.length,a=this.eventCount;this.items.forEach(p=>{p.selection&&a--},i);let l=e;this.items.forEach(p=>{let h=o.getMirror(--l);if(h==null)return;s=Math.min(s,h);let f=o.maps[h];if(p.step){let m=t.steps[h].invert(t.docs[h]),g=p.selection&&p.selection.map(o.slice(l+1,h));g&&a++,r.push(new Xe(f,m,g))}else r.push(new Xe(f))},i);let c=[];for(let p=e;p<s;p++)c.push(new Xe(o.maps[p]));let u=this.items.slice(0,i).append(c).append(r),d=new Pe(u,a);return d.emptyItemCount()>500&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let t=0;return this.items.forEach(e=>{e.step||t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),r=e.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=t)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(e.slice(r)),c=l&&l.getMap();if(r--,c&&e.appendMap(c,r),l){let u=s.selection&&s.selection.map(e.slice(r));u&&o++;let d,p=new Xe(c.invert(),l,u),h=i.length-1;(d=i.length&&i[h].merge(p))?i[h]=d:i.push(p)}}else s.map&&r--},this.items.length,0),new Pe(qc.from(i.reverse()),o)}}Pe.empty=new Pe(qc.empty,0);class Xe{constructor(t,e,r,i){this.map=t,this.step=e,this.selection=r,this.mirrorOffset=i}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new Xe(e.getMap().invert(),e,this.selection)}}}class An{constructor(t,e,r,i){this.done=t,this.undone=e,this.prevRanges=r,this.prevTime=i}}const yf=20;function $c(n){let t=[];return n.forEach((e,r,i,o)=>t.push(i,o)),t}function ta(n,t){if(!n)return null;let e=[];for(let r=0;r<n.length;r+=2){let i=t.map(n[r],1),o=t.map(n[r+1],-1);i<=o&&e.push(i,o)}return e}function jc(n,t,e,r){let i=yo(t),o=sn.get(t).spec.config,s=(r?n.undone:n.done).popEvent(t,i);if(!s)return;let a=s.selection.resolve(s.transform.doc),l=(r?n.done:n.undone).addTransform(s.transform,t.selection.getBookmark(),o,i),c=new An(r?l:s.remaining,r?s.remaining:l,null,0);e(s.transform.setSelection(a).setMeta(sn,{redo:r,historyState:c}).scrollIntoView())}let ea=!1,Vc=null;function yo(n){let t=n.plugins;if(Vc!=t){ea=!1,Vc=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){ea=!0;break}}return ea}const sn=new Ei("history"),bf=new Ei("closeHistory");function Uc(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new le({key:sn,state:{init:()=>new An(Pe.empty,Pe.empty,null,0),apply:(t,e,r)=>function(i,o,s,a){let l,c=s.getMeta(sn);if(c)return c.historyState;s.getMeta(bf)&&(i=new An(i.done,i.undone,null,0));let u=s.getMeta("appendedTransaction");if(s.steps.length==0)return i;if(u&&u.getMeta(sn))return u.getMeta(sn).redo?new An(i.done.addTransform(s,void 0,a,yo(o)),i.undone,$c(s.mapping.maps[s.steps.length-1]),i.prevTime):new An(i.done,i.undone.addTransform(s,void 0,a,yo(o)),null,i.prevTime);if(s.getMeta("addToHistory")===!1||u&&u.getMeta("addToHistory")===!1)return(l=s.getMeta("rebased"))?new An(i.done.rebased(s,l),i.undone.rebased(s,l),ta(i.prevRanges,s.mapping),i.prevTime):new An(i.done.addMaps(s.mapping.maps),i.undone.addMaps(s.mapping.maps),ta(i.prevRanges,s.mapping),i.prevTime);{let d=i.prevTime==0||!u&&(i.prevTime<(s.time||0)-a.newGroupDelay||!function(h,f){if(!f)return!1;if(!h.docChanged)return!0;let m=!1;return h.mapping.maps[0].forEach((g,w)=>{for(let C=0;C<f.length;C+=2)g<=f[C+1]&&w>=f[C]&&(m=!0)}),m}(s,i.prevRanges)),p=u?ta(i.prevRanges,s.mapping):$c(s.mapping.maps[s.steps.length-1]);return new An(i.done.addTransform(s,d?o.selection.getBookmark():void 0,a,yo(o)),Pe.empty,p,s.time)}}(e,r,t,n)},config:n,props:{handleDOMEvents:{beforeinput(t,e){let r=e.inputType,i=r=="historyUndo"?Di:r=="historyRedo"?na:null;return!!i&&(e.preventDefault(),i(t.state,t.dispatch))}}}})}const Di=(n,t)=>{let e=sn.getState(n);return!(!e||e.done.eventCount==0)&&(t&&jc(e,n,t,!1),!0)},na=(n,t)=>{let e=sn.getState(n);return!(!e||e.undone.eventCount==0)&&(t&&jc(e,n,t,!0),!0)};function bo(n,t){var e=n.nodes.paragraph;return t?e.create(null,gn()(t)?n.text(t):t):e.createAndFill()}function Jt(n,t,e){return n.text(t,e)}function wt(n,t,e){e===void 0&&(e=t);var r=n.doc.content.size,i=r>0?r-1:1;return dt.create(n.doc,Math.min(t,i),Math.min(e,i))}function ra(n,t,e){var r=t.pos;return n.replaceWith(r,r,bo(e)),n.setSelection(wt(n,r+1))}function wo(n){for(var t=n.state,e=n.from,r=n.startIndex,i=n.endIndex,o=n.createText,s=t.tr,a=t.doc,l=t.schema,c=r;c<=i;c+=1){var u=a.child(c),d=u.nodeSize,p=u.textContent,h=u.content,f=o(p),m=f?Jt(l,f):S.empty,g=s.mapping.map(e),w=g+h.size;s.replaceWith(g,w,m),e+=d}return s}function ia(n,t,e,r){var i=e.length;n.split(t).delete(t-i,t).insert(n.mapping.map(t),r).setSelection(wt(n,n.mapping.map(t)-i))}function Ri(n){return n.sourcepos[0][0]}function ko(n){return n.sourcepos[1][0]}function xo(n){return n.sourcepos[0][1]}function Dn(n){return n.sourcepos[1][1]}function wf(n){var t=n.type;return t==="strike"||t==="strong"||t==="emph"||t==="code"||t==="link"||t==="image"}function ar(n){return n&&(n.type==="item"||n.type==="list")}function Wc(n){return ar(n)&&n.listData.type==="ordered"}function kf(n){return ar(n)&&n.listData.type!=="ordered"}function Kc(n){return n&&(n.type==="tableCell"||n.type==="tableDelimCell")}function qr(n,t,e){for(e===void 0&&(e=!0),n=e?n:n.parent;n&&n.type!=="document";){if(t(n))return n;n=n.parent}return null}function $t(n,t){return[n[0],n[1]+t]}function Rn(n,t){return[n[0],t]}function xf(n){var t=n.firstChild.literal;switch(n.type){case"emph":return"*"+t+"*";case"strong":return"**"+t+"**";case"strike":return"~~"+t+"~~";case"code":return"`"+t+"`";case"link":case"image":var e=n,r=e.destination,i=e.title;return(n.type==="link"?"":"!")+"["+t+"]("+r+(i?' "'+i+'"':"")+")";default:return null}}function Cf(n){switch(n.type){case"document":case"blockQuote":case"list":case"item":case"paragraph":case"heading":case"emph":case"strong":case"strike":case"link":case"image":case"table":case"tableHead":case"tableBody":case"tableRow":case"tableCell":case"tableDelimRow":case"customInline":return!0;default:return!1}}function Ef(n){for(var t=[],e=n.walker(),r=null;r=e.next();){var i=r.node;i.type==="text"&&t.push(i.literal)}return t.join("")}var Co=[],Gc={},Jc=/\$\$widget\d+\s/;function Eo(n){var t=n.search(Jc);if(t!==-1){var e=n.substring(t).replace(Jc,"").replace("$$","");n=n.substring(0,t),n+=Eo(e)}return n}function Yc(n,t){return"$$"+n+" "+t+"$$"}function Qc(n,t){var e=Gc[n],r=e.rule,i=e.toDOM,o=Eo(t).match(r);return o&&(t=o[0]),i(t)}function Tf(){return Co}function Sf(n){(Co=n).forEach(function(t,e){Gc["widget"+e]=t})}function oa(n,t,e,r){return n.concat(lr(t,e,r))}function lr(n,t,e){e===void 0&&(e=0);var r=[],i=(Co[e]||{}).rule,o=e+1;if(n=Eo(n),i&&i.test(n)){for(var s=void 0;(s=n.search(i))!==-1;){var a=n.substring(0,s);a&&(r=oa(r,a,t,o));var l=(n=n.substring(s)).match(i)[0],c="widget"+e;r.push(t.nodes.widget.create({info:c},t.text(Yc(c,l)))),n=n.substring(l.length)}n&&(r=oa(r,n,t,o))}else n&&(r=e<Co.length-1?oa(r,n,t,o):[t.text(n)]);return r}function Xc(n){for(var t,e="",r=n.walker();t=r.next();){var i=t.node;t.entering&&(i!==n&&i.type!=="text"?(e+=xf(i),r.resumeAt(n,!1),r.next()):i.type==="text"&&(e+=i.literal))}return e}function Zc(){return{deleteSelection:function(){return Js},selectAll:function(){return Ac},undo:function(){return Di},redo:function(){return na}}}var Mf=b(322),sa=b.n(Mf),If=b(714),tu=b.n(If),Nf=b(471),Of=b.n(Nf),Lf="[A-Za-z][A-Za-z0-9-]*",eu=`(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^"'=<>\`\\x00-\\x20]+|'[^']*'|"[^"]*"))?)`,nu="<("+Lf+")("+eu+")*\\s*/?>",ru="(?:"+nu+"|</([A-Za-z][A-Za-z0-9-]*)\\s*[>])",$r=new RegExp("^"+ru,"i"),aa=/<br\s*\/*>/i,Af=/<! ---->|<!--(?:-?[^>-])(?:-?[^-])*-->/,iu="</p><p>";function la(n,t,e){var r=parseInt(n.left,10),i=parseInt(n.top,10),o=parseInt(n.width,10)+parseInt(n.paddingLeft,10)+parseInt(n.paddingRight,10),s=parseInt(n.height,10)+parseInt(n.paddingTop,10)+parseInt(n.paddingBottom,10);return t>=r&&t<=r+o&&e>=i&&e<=i+s}var ou="toastui-editor-";function J(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];for(var e=[],r=0,i=n;r<i.length;r++){var o=i[r],s=void 0;(s=Array.isArray(o)?o[0]?o[1]:null:o)&&e.push(""+ou+s)}return e.join(" ")}function Pt(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return n.map(function(e){return ou+"md-"+e}).join(" ")}function To(n){return n&&n.nodeType===Node.ELEMENT_NODE}function cr(n){n.parentNode&&n.parentNode.removeChild(n)}function ca(n,t,e){_t()(e)&&(e=!tu()(n,t)),(e?me():re())(n,t)}function su(n,t){var e=document.createElement("div");gn()(n)?e.innerHTML=n:e.appendChild(n);var r=e.firstChild;return t&&t.appendChild(r),r}function ua(n){var t=window.getComputedStyle(n);return["margin-left","margin-right"].reduce(function(e,r){return e+parseInt(t.getPropertyValue(r),10)},0)+n.offsetWidth}function Ze(n,t){var e;for(e=gn()(t)?function(r){return Of()(r,t)}:function(r){return r===t};n&&n!==document;){if(To(n)&&e(n))return n;n=n.parentNode}return null}function au(n,t){for(var e=0,r=0;n&&n!==t&&(e+=n.offsetTop,r+=n.offsetLeft,n.offsetParent!==t.offsetParent);)n=n.offsetParent;return{offsetTop:e,offsetLeft:r}}function da(n,t){Object.keys(n).forEach(function(e){Nr(n[e])?t.removeAttribute(e):t.setAttribute(e,n[e])})}function pa(n){var t=n;return t=(t=t.replace(/<img class="ProseMirror-separator" alt="">/g,"")).replace(/ class="ProseMirror-trailingBreak"/g,"")}var lu=new Ei("widget"),Df=function(){function n(t,e){var r=this;this.popup=null,this.removeWidget=function(){r.popup&&(r.rootEl.removeChild(r.popup),r.popup=null)},this.rootEl=t.dom.parentElement,this.eventEmitter=e,this.eventEmitter.listen("blur",this.removeWidget),this.eventEmitter.listen("loadUI",function(){r.rootEl=Ze(t.dom.parentElement,"."+J("defaultUI"))}),this.eventEmitter.listen("removePopupWidget",this.removeWidget)}return n.prototype.update=function(t){var e=lu.getState(t.state);if(this.removeWidget(),e){var r=e.node,i=e.style,o=t.coordsAtPos(e.pos),s=o.top,a=o.left,l=o.bottom-s,c=this.rootEl.getBoundingClientRect(),u=s-c.top;ae()(r,{opacity:"0"}),this.rootEl.appendChild(r),ae()(r,{position:"absolute",left:a-c.left+5+"px",top:(i==="bottom"?u+l-5:u-l)+"px",opacity:"1"}),this.popup=r,t.focus()}},n.prototype.destroy=function(){this.eventEmitter.removeEventHandler("blur",this.removeWidget)},n}();function Rf(n){return new le({key:lu,state:{init:function(){return null},apply:function(t){return t.getMeta("widget")}},view:function(t){return new Df(t,n)}})}var Pf=b(893),ha=b.n(Pf);function fa(n,t,e){n.emit("addImageBlobHook",t,function(r,i){n.emit("command","addImage",{imageUrl:r,altText:i||t.name||"image"})},e)}function cu(n){var t=rn()(n).filter(function(r){return r.type.indexOf("image")!==-1});if(t.length===1){var e=t[0];if(e)return e.getAsFile()}return null}function Ff(n){var t=n.eventEmitter;return new le({props:{handleDOMEvents:{drop:function(e,r){var i,o=(i=r.dataTransfer)===null||i===void 0?void 0:i.files;return o&&ha()(o,function(s){return s.type.indexOf("image")===-1||(r.preventDefault(),r.stopPropagation(),fa(t,s,r.type),!1)}),!0}}}})}var bt=function(){function n(){}return Object.defineProperty(n.prototype,"type",{get:function(){return"node"},enumerable:!1,configurable:!0}),n.prototype.setContext=function(t){this.context=t},n}();function uu(n){var t=document.createElement("span"),e=Qc(n.attrs.info,n.textContent);return t.className="tui-widget",t.appendChild(e),{dom:t}}function ma(n){return n.type.name==="widget"}var du=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"widget"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{attrs:{info:{default:null}},group:"inline",inline:!0,content:"text*",selectable:!1,atom:!0,toDOM:function(){return["span",{class:"tui-widget"},0]},parseDOM:[{tag:"span.tui-widget",getAttrs:function(e){return{info:e.textContent.match(/\$\$(widget\d+)/)[1]}}}]}},enumerable:!1,configurable:!0}),t}(bt),Bf=function(){function n(t){this.timer=null,this.el=document.createElement("div"),this.el.className="toastui-editor",this.eventEmitter=t,this.placeholder={text:""}}return n.prototype.createState=function(){return Zn.create({schema:this.schema,plugins:this.createPlugins()})},n.prototype.initEvent=function(){var t=this,e=t.eventEmitter,r=t.view,i=t.editorType;r.dom.addEventListener("focus",function(){return e.emit("focus",i)}),r.dom.addEventListener("blur",function(){return e.emit("blur",i)})},n.prototype.emitChangeEvent=function(t){this.eventEmitter.emit("caretChange",this.editorType),t.docChanged&&this.eventEmitter.emit("change",this.editorType)},Object.defineProperty(n.prototype,"defaultPlugins",{get:function(){var t,e=this.createInputRules(),r=M(M([],this.keymaps),[Li(v({"Shift-Enter":Bc.Enter},Bc)),Uc(),(t=this.placeholder,new le({props:{decorations:function(i){var o=i.doc;if(t.text&&o.childCount===1&&o.firstChild.isTextblock&&o.firstChild.content.size===0){var s=document.createElement("span");return me()(s,"placeholder"),t.className&&me()(s,t.className),s.textContent=t.text,Rt.create(o,[de.widget(1,s)])}return null}}})),Rf(this.eventEmitter),Ff(this.context)]);return e?r.concat(e):r},enumerable:!1,configurable:!0}),n.prototype.createInputRules=function(){var t=Tf().map(function(e){var r=e.rule;return new Ln(r,function(i,o,s,a){var l=i.schema,c=i.tr,u=i.doc,d=o.input.match(new RegExp(r,"g")),p=u.resolve(s),h=p.parent,f=0;if(ma(h)&&(h=p.node(p.depth-1)),h.forEach(function(w){return ma(w)&&(f+=1)}),d.length>f){var m=At(d),g=lr(m,l);return c.replaceWith(a-m.length+1,a,g)}return null})});return t.length?Hc({rules:t}):null},n.prototype.clearTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},n.prototype.createSchema=function(){return new V({nodes:this.specs.nodes,marks:this.specs.marks})},n.prototype.createKeymaps=function(t){var e=Zc(),r=e.undo,i=e.redo,o=this.specs.keymaps(t),s={"Mod-z":r(),"Shift-Mod-z":i()};return t?o.concat(Li(s)):o},n.prototype.createCommands=function(){return this.specs.commands(this.view)},n.prototype.createPluginProps=function(){var t=this;return this.extraPlugins.map(function(e){return e(t.eventEmitter)})},n.prototype.focus=function(){var t=this;this.clearTimer(),this.timer=setTimeout(function(){t.view.focus(),t.view.dispatch(t.view.state.tr.scrollIntoView())})},n.prototype.blur=function(){this.view.dom.blur()},n.prototype.destroy=function(){var t=this;this.clearTimer(),this.view.destroy(),Object.keys(this).forEach(function(e){delete t[e]})},n.prototype.moveCursorToStart=function(t){var e=this.view.state.tr;this.view.dispatch(e.setSelection(wt(e,1)).scrollIntoView()),t&&this.focus()},n.prototype.moveCursorToEnd=function(t){var e=this.view.state.tr;this.view.dispatch(e.setSelection(wt(e,e.doc.content.size-1)).scrollIntoView()),t&&this.focus()},n.prototype.setScrollTop=function(t){this.view.dom.scrollTop=t},n.prototype.getScrollTop=function(){return this.view.dom.scrollTop},n.prototype.setPlaceholder=function(t){this.placeholder.text=t,this.view.dispatch(this.view.state.tr.scrollIntoView())},n.prototype.setHeight=function(t){ae()(this.el,{height:t+"px"})},n.prototype.setMinHeight=function(t){ae()(this.el,{minHeight:t+"px"})},n.prototype.getElement=function(){return this.el},n}(),pu=Bf,Hf=b(294),Te=b.n(Hf),zf=["Enter","Shift-Enter","Mod-Enter","Tab","Shift-Tab","Delete","Backspace","Mod-Delete","Mod-Backspace","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Mod-d","Mod-D","Alt-ArrowUp","Alt-ArrowDown"];function So(n,t,e){return n.focus(),t(e)(n.state,n.dispatch,n)}var _f=function(){function n(t){this.specs=t}return Object.defineProperty(n.prototype,"nodes",{get:function(){return this.specs.filter(function(t){return t.type==="node"}).reduce(function(t,e){var r,i=e.name,o=e.schema;return v(v({},t),((r={})[i]=o,r))},{})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"marks",{get:function(){return this.specs.filter(function(t){return t.type==="mark"}).reduce(function(t,e){var r,i=e.name,o=e.schema;return v(v({},t),((r={})[i]=o,r))},{})},enumerable:!1,configurable:!0}),n.prototype.commands=function(t,e){var r=this.specs.filter(function(o){return o.commands}).reduce(function(o,s){var a={},l=s.commands();return Te()(l)?a[s.name]=function(c){return So(t,l,c)}:Object.keys(l).forEach(function(c){a[c]=function(u){return So(t,l[c],u)}}),v(v({},o),a)},{}),i=Zc();return Object.keys(i).forEach(function(o){r[o]=function(s){return So(t,i[o],s)}}),e&&Object.keys(e).forEach(function(o){r[o]=function(s){return So(t,e[o],s)}}),r},n.prototype.keymaps=function(t){return this.specs.filter(function(e){return e.keymaps}).map(function(e){return e.keymaps()}).map(function(e){return t||Object.keys(e).forEach(function(r){St(zf,r)||delete e[r]}),Li(e)})},n.prototype.setContext=function(t){this.specs.forEach(function(e){e.setContext(t)})},n}(),hu=_f;function fu(n){var t=n.from,e=n.to;return n instanceof Zt?[t+1,e-1]:[t,e]}function mu(n){return n.index(0)+1}function jr(n,t,e){e===void 0&&(e=1);var r=0;return n.forEach(function(i,o){ma(i)&&o+2<t&&(r+=2*e)}),r}function Mo(n,t,e){e===void 0&&(e=t);var r=t===e,i=n.resolve(t),o=mu(i),s=o,a=i.start(1),l=a;if(!r){var c=n.resolve(e===n.content.size?e-1:e);l=c.start(1),s=mu(c),c.pos===n.content.size&&(e=n.content.size-2)}var u=Math.max(t-a+1,1),d=Math.max(e-l+1,1);return[[o,u+jr(n.child(o-1),u,-1)],[s,d+jr(n.child(s-1),d,-1)]]}function gu(n,t){for(var e=[],r=0,i=0;r<t;r+=1){var o=n.child(r);e[r]=i,i+=o.nodeSize}return e}function ur(n,t,e){var r=gu(n,e[0]),i=t[0]-1,o=e[0]-1,s=n.child(i),a=n.child(o),l=r[i],c=r[o];return l+=t[1]+jr(s,t[1]-1),c+=e[1]+jr(a,e[1]-1),[l,Math.min(c,n.content.size)]}function Ft(n){var t=n.$from,e=n.$to,r=n.from,i=n.to,o=t.doc;return n instanceof Zt&&(t=o.resolve(r+1),e=o.resolve(i-1)),t.depth===0&&(e=t=o.resolve(r-1)),{startFromOffset:t.start(1),endFromOffset:e.start(1),startToOffset:t.end(1),endToOffset:e.end(1),startIndex:t.index(0),endIndex:e.index(0),from:t.pos,to:e.pos}}function Io(n,t){for(var e=1,r=1,i=0,o=0;i<n.childCount;i+=1){var s=n.child(i).nodeSize;if(e=o+1,r=o+s-1,i===t)break;o+=s}return{startOffset:e,endOffset:r}}var vu="heading",No="link",Oo="code",Lo="meta",dr="delimiter",ga="markedText",yu={strong:2,emph:1,strike:2};function gt(n,t,e,r){return{start:n,end:t,spec:{type:e,attrs:r}}}function va(n,t,e){var r=n.type,i=$t(t,yu[r]),o=$t(e,-yu[r]);return[gt(i,o,r),gt(t,i,dr),gt(o,e,dr)]}function bu(n,t,e,r){return[gt(n,t,No),gt(Rn(n,e[1]+1),Rn(t,r),No,{desc:!0}),gt(Rn(t,r+2),$t(t,-1),No,{url:!0})]}function wu(n,t,e,r){var i={start:t,end:e,spec:{attrs:{className:r+"-line-background",codeStart:t[0],codeEnd:e[0]}},lineBackground:!0};return n.type!=="item"&&n.type!=="blockQuote"?[v(v({},i),{end:t,spec:{attrs:{className:r+"-line-background start"}}}),v(v({},i),{start:[Math.min(t[0]+1,e[0]),t[1]]})]:null}function ku(n,t){for(var e=[];n;){var r=n.type;r!=="paragraph"&&r!=="codeBlock"||e.push(gt([Ri(n),xo(n)-1],[ko(n),Dn(n)+1],t)),n=n.next}return e}var xu={heading:function(n,t,e){var r=n.level,i=n.headingType,o=[gt(t,e,vu,{level:r})];return i==="atx"?o.push(gt(t,$t(t,r),dr)):o.push(gt(Rn(e,0),e,vu,{seText:!0})),o},strong:va,emph:va,strike:va,link:function(n,t,e){var r=n.lastChild,i=n.extendedAutolink,o=r?Dn(r)+1:2;return i?[gt(t,e,No,{desc:!0})]:bu(t,e,t,o)},image:function(n,t,e){var r=n.lastChild,i=r?Dn(r)+1:3,o=$t(t,1);return M([gt(t,o,Lo)],bu(t,e,o,i))},code:function(n,t,e){var r=n.tickCount,i=$t(t,r),o=$t(e,-r);return[gt(t,e,Oo),gt(t,i,Oo,{start:!0}),gt(i,o,Oo,{marked:!0}),gt(o,e,Oo,{end:!0})]},codeBlock:function(n,t,e,r){var i=n.fenceOffset,o=n.fenceLength,s=n.fenceChar,a=n.info,l=n.infoPadding,c=n.parent,u=i+o,d=[gt(Rn(t,1),e,"codeBlock")];s&&d.push(gt(t,$t(t,u),dr)),a&&d.push(gt($t(t,o),$t(t,o+l+a.length),Lo)),new RegExp("^(\\s{0,4})("+s+"{"+o+",})").test(r)&&d.push(gt(Rn(e,1),e,dr));var p=wu(c,t,e,"code-block");return p?d.concat(p):d},blockQuote:function(n,t,e){var r=n.parent&&n.parent.type!=="blockQuote"?[gt(t,e,"blockQuote")]:[];if(n.firstChild){var i=[];n.firstChild.type==="paragraph"?i=function(o){for(var s=[];o;)s.push(gt([Ri(o),xo(o)],[ko(o),Dn(o)+1],ga)),o=o.next;return s}(n.firstChild.firstChild):n.firstChild.type==="list"&&(i=ku(n.firstChild,ga)),r=M(M([],r),i)}return r},item:function(n,t){var e=n.listData,r=e.padding,i=e.task,o=function(a){for(var l=0;a.parent.parent&&a.parent.parent.type==="item";)a=a.parent.parent,l+=1;return["listItem",v(v({},[{odd:!0},{even:!0}][l%2]),{listStyle:!0})]}(n),s=[gt.apply(void 0,M([t,$t(t,r)],o))];return i&&(s.push(gt($t(t,r),$t(t,r+3),"taskDelimiter")),s.push(gt($t(t,r+1),$t(t,r+2),Lo))),s.concat(ku(n.firstChild,ga))},customBlock:function(n,t,e){var r=n,i=r.offset,o=r.syntaxLength,s=r.info,a=r.parent,l=i+o,c=[gt(Rn(t,1),e,"customBlock")];c.push(gt(t,$t(t,l),dr)),s&&c.push(gt($t(t,l),$t(t,o+s.length),Lo)),c.push(gt(Rn(e,1),e,dr));var u=wu(a,t,e,"custom-block");return u?c.concat(u):c}},Cu={thematicBreak:"thematicBreak",table:"table",tableCell:"tableCell",htmlInline:"html"};function qf(n,t,e,r){var i=n.type;return Te()(xu[i])?xu[i](n,t,e,r):Cu[i]?[gt(t,e,Cu[i])]:null}var Pi={};function $f(n){var t=n.schema,e=n.toastMark;return new le({appendTransaction:function(r,i,o){var s=r[0],a=o.tr;if(s.docChanged){var l=[];s.getMeta("editResult").forEach(function(c){var u=c.nodes,d=c.removedNodeRange;if(u.length){l=l.concat(function(B,z){var q=B.doc,_=z[0].sourcepos[0],Y=At(z).sourcepos[1],K=[_[0],_[1]],ot=[Y[0],Y[1]+1],pt=[];return function(Tt,ne,ft){var dn=[];Pi={};for(var Me=ne[0]-1;Me<ft[0];Me+=1){var Bn=Tt.child(Me),ri=Bn.attrs.codeEnd,ii=Bn.attrs.codeStart;if(ii&&ri&&!St(dn,ii)){dn.push(ii),ri=Math.min(ri,Tt.childCount);for(var pn=ii-1,Hn=ft[0],fr=pn;fr<Hn;fr+=1)Pi[fr]=!0}}}(q,_,Y),pt.push({start:K,end:ot}),pt}(a,u));for(var p=0,h=u;p<h.length;p++)for(var f=h[p].walker(),m=f.next();m;){var g=m.node;m.entering&&(l=l.concat(Vf(g,e))),m=f.next()}}else if(d)for(var w=a.doc.childCount-1,C=d.line,E=C[0],L=C[1],P=Math.min(E,w),A=Math.min(L,w),H=P;H<=A;H+=1)Pi[H]=!0}),function(c,u,d){var p=c.doc,h=u.nodes.paragraph,f=gu(p,p.childCount);d.forEach(function(m){var g=m.start,w=m.end,C=m.spec,E=m.lineBackground,L=Math.min(g[0],p.childCount)-1,P=Math.min(w[0],p.childCount)-1,A=p.child(L),H=p.child(P),B=f[L],z=f[P];B+=g[1]+jr(A,g[1]-1),z+=w[1]+jr(H,w[1]-1),C?E?function(q,_,Y,K,ot){ot===void 0&&(ot={});for(var pt=K.startIndex,Tt=K.endIndex,ne=K.from,ft=K.to,dn=!1,Me=pt;Me<=Tt;Me+=1)delete Pi[Me],dn=jf(_,Me,ot);dn&&q.setBlockType(ne,ft,Y,ot)}(c,p,h,{from:B,to:z,startIndex:L,endIndex:P},C.attrs):c.addMark(B,z,u.mark(C.type,C.attrs)):c.removeMark(B,z)}),function(m,g,w){Object.keys(Pi).forEach(function(C){var E=Number(C),L=Math.min(Number(C)+1,m.doc.childCount-1),P=g[E],A=g[L]-1;E===L&&(A+=2),m.setBlockType(P,A,w)})}(c,f,h)}(a,t,l)}return a.setMeta("widget",s.getMeta("widget"))}})}function jf(n,t,e){return Object.keys(e).some(function(r){return e[r]!==n.child(t).attrs[r]})}function Vf(n,t){var e=t.getLineTexts(),r=[Ri(n),xo(n)],i=[ko(n),Dn(n)+1],o=qf(n,r,i,e[i[0]-1]);return o??[]}var Uf=["taskList","orderedList","bulletList","table","strong","emph","strike","heading","thematicBreak","blockQuote","code","codeBlock","indent","outdent"];function Wf(n){var t={indent:{active:!1,disabled:!0},outdent:{active:!1,disabled:!0}},e=!0;return function(r,i,o){for(o===void 0&&(o=!0),r=o?r:r.parent;r&&r.type!=="document";)i(r),r=r.parent}(n,function(r){var i=function(o){var s=o.type;return ar(o)?o.listData.task?"taskList":o.listData.type==="ordered"?"orderedList":"bulletList":s.indexOf("table")!==-1?"table":St(Uf,s)?s:null}(r);i&&(i==="bulletList"||i==="orderedList"?e&&(t[i]={active:!0},t.indent.disabled=!1,t.outdent.disabled=!1,e=!1):t[i]={active:!0})}),t}function Kf(n){var t=n.toastMark,e=n.eventEmitter;return new le({view:function(){return{update:function(r,i){var o=r.state,s=o.doc,a=o.selection;if(!(i&&i.doc.eq(s)&&i.selection.eq(a))){var l=a.from,c=o.doc.resolve(l).start(),u=l-c;l===c&&(u+=1);var d=[o.doc.content.findIndex(l).index+1,u],p=t.findNodeAtPosition(d),h=Wf(p);e.emit("changeToolbarState",{cursorPos:d,mdNode:p,toolbarState:h}),e.emit("setFocusedNode",p)}}}}})}var Gf=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"doc"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"block+"}},enumerable:!1,configurable:!0}),t}(bt),Jf=function(){function n(){}return Object.defineProperty(n.prototype,"type",{get:function(){return"mark"},enumerable:!1,configurable:!0}),n.prototype.setContext=function(t){this.context=t},n}(),kt=Jf;function be(n,t){return Pn(n,t-1)}function Pn(n,t){return n.child(t).textContent}var Fi=/^\s*> ?/,Yf=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"blockQuote"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("block-quote")},0]}}},enumerable:!1,configurable:!0}),t.prototype.createBlockQuoteText=function(e,r){return r?e.replace(Fi,"").trim():"> "+e.trim()},t.prototype.extendBlockQuote=function(){var e=this;return function(r,i){var o=r.selection,s=r.doc,a=r.tr,l=r.schema,c=Ft(o),u=c.endFromOffset,d=c.endToOffset,p=c.endIndex,h=c.to,f=Pn(s,p);if(Fi.test(f)&&h>u&&o.empty){if(!f.replace(Fi,"").trim())a.deleteRange(u,d).split(a.mapping.map(d));else{var m=f.slice(h-u).trim();ia(a,d,m,Jt(l,e.createBlockQuoteText(m)))}return i(a),!0}return!1}},t.prototype.commands=function(){var e=this;return function(){return function(r,i){var o=r.selection,s=r.doc,a=Ft(o),l=a.startFromOffset,c=a.endToOffset,u=a.startIndex,d=a.endIndex,p=Fi.test(Pn(s,u)),h=wo({state:r,startIndex:u,endIndex:d,from:l,createText:function(f){return e.createBlockQuoteText(f,p)}});return i(h.setSelection(wt(h,h.mapping.map(c)))),!0}}},t.prototype.keymaps=function(){var e=this.commands()();return{"alt-q":e,"alt-Q":e,Enter:this.extendBlockQuote()}},t}(kt),pr=/(^\s*)([-*+] |[\d]+\. )/,ya=/(^\s*)([\d])+\.( \[[ xX]])? /,an=/^(\s*)((\d+)([.)]\s(?:\[(?:x|\s)\]\s)?))(.*)/,Ao=/(^\s*)([-*+]|[\d]+\.)( \[[ xX]])? /,Qf=/^(\s*)([-*+]+(\s(?:\[(?:x|\s)\]\s)?))(.*)/,Xf=/(^\s*)([-*+] |[\d]+\. )(\[[ xX]] )/,Zf=/(^\s*)([-*+])( \[[ xX]]) /;function ba(n){return ya.test(n)?"ordered":"bullet"}function wa(n){for(var t=0;n&&n.type!=="document";)n.type==="list"&&(t+=1),n=n.parent;return t}function ka(n,t,e,r){for(var i=n.getLineTexts().length,o=[],s=t;r?s<i:s>1;){s=r?s+1:s-1;var a=n.findFirstNodeAtLine(s),l=wa(a);if(l===e)o.push({line:s,depth:e,mdNode:a});else if(l<e)break}return o}function Eu(n,t,e,r){r===void 0&&(r=0);var i=Number.MAX_VALUE,o=0,s=t.map(function(a,l){var c=a.line;i=Math.min(c-1,i),o=Math.max(c-1,o);var u=be(n,c);return u=e==="bullet"?function(d){if(!pr.test(d))return"* "+d;var p=ba(d);return p==="bullet"&&Ao.test(d)?d=d.replace(Zf,"$1$2 "):p==="ordered"&&(d=d.replace(ya,"$1* ")),d}(u):function(d,p){if(!pr.test(d))return p+". "+d;var h=ba(d);if(h==="bullet"||h==="ordered"&&Ao.test(d))d=d.replace(Ao,"$1"+p+". ");else if(h==="ordered"){var f=an.exec(d)[3];Number(f)!==p&&(d=d.replace(ya,"$1"+p+". "))}return d}(u,l+1+r),{text:u,line:c}});return{changedResults:s,firstIndex:i,lastIndex:o}}function Tu(n,t){var e,r,i,o,s,a,l,c=(r=(e=t).toastMark,i=e.mdNode,o=e.line,s=wa(i),a=ka(r,o,s,!1).reverse(),l=ka(r,o,s,!0),a.concat([{line:o,depth:s,mdNode:i}]).concat(l));return Eu(t.doc,c,n)}var tm={bullet:function(n){return Tu("bullet",n)},ordered:function(n){return Tu("ordered",n)},task:function(n){var t=n.mdNode,e=n.doc,r=n.line,i=be(e,r);return t.listData.task?i=i.replace(Xf,"$1$2"):ar(t)&&(i=i.replace(pr,"$1$2[ ] ")),{changedResults:[{text:i,line:r}]}}},em={bullet:function(n){var t=n.doc,e=n.line;return{changedResults:[{text:"* "+be(t,e),line:e}]}},ordered:function(n){for(var t=n.toastMark,e=n.doc,r=n.line,i=n.startLine,o=be(e,r),s=1,a=i,l=0,c=i-1;c>0;c-=1){var u=t.findFirstNodeAtLine(c),d=be(e,c)&&!!qr(u,function(g){return ar(g)}),p=an.exec(be(e,c));if(!p&&!d)break;if(p||!d){var h=p,f=h[1],m=h[3];if(!f){s=Number(m),a=c;break}}else l+=1}return{changedResults:[{text:s+r-a-l+". "+o,line:r}]}},task:function(n){var t=n.doc,e=n.line;return{changedResults:[{text:"* [ ] "+be(t,e),line:e}]}}},nm={bullet:function(n){var t=n.line,e=be(n.doc,t),r=Qf.exec(e);return{listSyntax:""+r[1]+r[2]}},ordered:function(n){var t=n.toastMark,e=n.line,r=n.mdNode,i=n.doc,o=wa(r),s=be(i,e),a=an.exec(s),l=a[1],c=a[3],u=a[4],d=Number(c)+1,p=""+l+d+u,h=ka(t,e,o,!0).filter(function(f){var m=an.exec(be(i,f.line));return m&&m[1].length===l.length&&!!qr(f.mdNode,function(g){return Wc(g)})});return v({listSyntax:p},Eu(i,h,"ordered",d))}};function Su(n,t,e,r,i){for(var o=[],s=be(n,e),a=an.exec(s);a;){var l=a[1],c=a[4],u=a[5],d=l.length;if(d===i)o.push(Jt(t,""+l+r+c+u)),r+=1,e+=1;else if(d>i){var p=Su(n,t,e,1,d);e=p.line,o=o.concat(p.nodes)}if(d<i||e>n.childCount)break;s=be(n,e),a=an.exec(s)}return{nodes:o,line:e}}var Mu=/(^\s{1,4})(.*)/;function Iu(n,t,e){return n<t||pr.test(e)||Fi.test(e)}function Nu(n,t,e){var r=e.$from;r.depth===0&&(r=n.resolve(r.pos-1));var i=r.node(1),o=r.start(1),s=i.content.size;return i.rangeHasMark(0,s,t.marks.table)&&r.pos-o!==s&&r.pos!==o}function Ou(n,t){var e=t.from,r=t.to;if(t.type==="indent")e+=4,r+=4*(t.lineLen+1);else{var i=t.spaceLenList;e-=i[0];for(var o=0;o<i.length;o+=1)r-=i[o]}return wt(n,e,r)}var rm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"paragraph"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"inline*",attrs:{className:{default:null},codeStart:{default:null},codeEnd:{default:null}},selectable:!1,group:"block",parseDOM:[{tag:"div"}],toDOM:function(e){var r=e.attrs;return r.className?["div",{class:Pt(r.className)},0]:["div",0]}}},enumerable:!1,configurable:!0}),t.prototype.reorderList=function(e,r){for(var i=this.context,o=i.view,s=i.toastMark,a=i.schema,l=o.state,c=l.tr,u=l.selection,d=l.doc,p=s.findFirstNodeAtLine(e),h=p;p&&!kf(p)&&p.parent.type!=="document";)if(Wc(p=p.parent)){h=p;break}h&&(e=h.sourcepos[0][0]);var f=an.exec(be(d,e)),m=f[1],g=f[3],w=m.length,C=Su(d,a,e,Number(g),w),E=C.line,L=C.nodes;r=Math.max(r,E-1);for(var P=Io(d,e-1).startOffset,A=e-1;A<=r-1;A+=1){var H=d.child(A),B=H.nodeSize,z=H.content,q=c.mapping.map(P),_=q+z.size;c.replaceWith(q,_,L[A-e+1]),P+=B}var Y=wt(c,u.from,u.to);o.dispatch(c.setSelection(Y))},t.prototype.indent=function(e){var r=this;return e===void 0&&(e=!1),function(){return function(i,o){var s=i.schema,a=i.selection,l=i.doc,c=Ft(a),u=c.from,d=c.to,p=c.startFromOffset,h=c.startIndex,f=c.endIndex;if(e&&Nu(l,s,a))return!1;var m=Pn(l,h);if(e&&Iu(u,d,m)||!e&&pr.test(m)){var g=wo({state:i,from:p,startIndex:h,endIndex:f,createText:function(C){return"    "+C}}),w={type:"indent",from:u,to:d,lineLen:f-h};o(g.setSelection(Ou(g,w))),an.test(m)&&r.reorderList(h+1,f+1)}else e&&o(i.tr.insert(d,Jt(s,"    ")));return!0}}},t.prototype.outdent=function(e){var r=this;return e===void 0&&(e=!1),function(){return function(i,o){var s=i.selection,a=i.doc,l=i.schema,c=Ft(s),u=c.from,d=c.to,p=c.startFromOffset,h=c.startIndex,f=c.endIndex;if(e&&Nu(a,l,s))return!1;var m=Pn(a,h);if(e&&Iu(u,d,m)||!e&&pr.test(m)){var g=[],w=wo({state:i,from:p,startIndex:h,endIndex:f,createText:function(A){var H=Mu.exec(A);return g.push(H?H[1].length:0),A.replace(Mu,"$2")}}),C={type:"outdent",from:u,to:d,spaceLenList:g};o(w.setSelection(Ou(w,C))),an.test(m)&&r.reorderList(h+1,f+1)}else if(e){var E=m.slice(0,d-p),L=E.replace(/\s{1,4}$/,""),P=d-(E.length-L.length);o(i.tr.delete(P,d))}return!0}}},t.prototype.deleteLines=function(){var e=this;return function(r,i){var o=e.context.view,s=Ft(r.selection),a=s.startFromOffset,l=s.endToOffset;return go(function(){return i(r.tr.deleteRange(a,l)),!0},Nc)(r,i,o)}},t.prototype.moveDown=function(){return function(e,r){var i=e.doc,o=e.tr,s=e.selection,a=e.schema,l=Ft(s),c=l.startFromOffset,u=l.endToOffset,d=l.endIndex;if(d<i.content.childCount-1){var p=i.child(d+1),h=p.nodeSize,f=p.textContent;return o.delete(u,u+h).split(c).insert(o.mapping.map(c)-2,Jt(a,f)),r(o),!0}return!1}},t.prototype.moveUp=function(){return function(e,r){var i=e.tr,o=e.doc,s=e.selection,a=e.schema,l=Ft(s),c=l.startFromOffset,u=l.endToOffset,d=l.startIndex;if(d>0){var p=o.child(d-1),h=p.nodeSize,f=p.textContent;return i.delete(c-h,c).split(i.mapping.map(u)).insert(i.mapping.map(u),Jt(a,f)),r(i),!0}return!1}},t.prototype.commands=function(){return{indent:this.indent(),outdent:this.outdent()}},t.prototype.keymaps=function(){return{Tab:this.indent(!0)(),"Shift-Tab":this.outdent(!0)(),"Mod-d":this.deleteLines(),"Mod-D":this.deleteLines(),"Alt-ArrowUp":this.moveUp(),"Alt-ArrowDown":this.moveDown()}},t}(bt),im=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"text"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{group:"inline"}},enumerable:!1,configurable:!0}),t}(bt),om=/^#{1,6}\s/,sm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"heading"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{attrs:{level:{default:1},seText:{default:!1}},toDOM:function(e){var r=e.attrs,i="heading|heading"+r.level;return r.seText&&(i+="|delimiter|setext"),["span",{class:Pt.apply(void 0,i.split("|"))},0]}}},enumerable:!1,configurable:!0}),t.prototype.createHeadingText=function(e,r,i){for(var o=r.replace(i,"").trim(),s="";e>0;)s+="#",e-=1;return s+" "+o},t.prototype.commands=function(){var e=this;return function(r){return function(i,o){var s=r.level,a=Ft(i.selection),l=a.startFromOffset,c=a.endToOffset,u=wo({state:i,from:l,startIndex:a.startIndex,endIndex:a.endIndex,createText:function(d){var p=d.match(om),h=p?p[0]:"";return e.createHeadingText(s,d,h)}});return o(u.setSelection(wt(u,u.mapping.map(c)))),!0}}},t}(kt),xa="```",am=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"codeBlock"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("code-block")},0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(){return function(e,r){var i=e.selection,o=e.schema,s=e.tr,a=Ft(i),l=a.startFromOffset,c=a.endToOffset,u=Jt(o,xa);return s.insert(l,u).split(l+xa.length),s.split(s.mapping.map(c)).insert(s.mapping.map(c),u),r(s.setSelection(wt(s,s.mapping.map(c)-(xa.length+2)))),!0}}},t.prototype.keepIndentation=function(){var e=this;return function(r,i){var o=r.selection,s=r.tr,a=r.doc,l=r.schema,c=e.context.toastMark,u=Ft(o),d=u.startFromOffset,p=u.endToOffset,h=u.endIndex,f=u.from,m=u.to,g=Pn(a,h);if(f===m&&g.trim()){var w=g.match(/^\s+/);if(function(L){return L&&L.type==="codeBlock"}(c.findFirstNodeAtLine(h+1))&&w){var C=w[0],E=g.slice(m-d);return ia(s,p,E,Jt(l,C+E)),i(s),!0}}return!1}},t.prototype.keymaps=function(){var e=this.commands()();return{"Shift-Mod-p":e,"Shift-Mod-P":e,Enter:this.keepIndentation()}},t}(kt),lm=/\||\s/g;function Do(n,t){for(var e="|",r=0;r<n;r+=1)e+=t?" --- |":"  |";return e}var cm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"table"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("table")},0]}}},enumerable:!1,configurable:!0}),t.prototype.extendTable=function(){var e=this;return function(r,i){var o=r.selection,s=r.doc,a=r.tr,l=r.schema;if(!o.empty)return!1;var c=Ft(o),u=c.endFromOffset,d=c.endToOffset,p=c.endIndex,h=c.to,f=Pn(s,p),m=[p+1,h-u+1],g=qr(e.context.toastMark.findNodeAtPosition(m),function(E){return Kc(E)&&(E.parent.type==="tableDelimRow"||E.parent.parent.type==="tableBody")});if(g){var w=!f.replace(lm,"").trim(),C=Do(g.parent.parent.parent.columns.length);return w?a.deleteRange(u,d).split(a.mapping.map(d)):a.split(d).insert(a.mapping.map(d),Jt(l,C)).setSelection(wt(a,a.mapping.map(d)-2)),i(a),!0}return!1}},t.prototype.moveTableCell=function(e){var r=this;return function(i,o){var s=i.selection,a=i.tr,l=Ft(s),c=l.endFromOffset,u=[l.endIndex+1,l.to-c],d=qr(r.context.toastMark.findNodeAtPosition(u),function(E){return Kc(E)});if(d){var p=d.parent,h=function(E){return E?{type:"next",parentType:"tableHead",childType:"firstChild"}:{type:"prev",parentType:"tableBody",childType:"lastChild"}}(e),f=h.type,m=h.parentType,g=h.childType,w=Dn(d);if(d[f])w=Dn(d[f])-1;else{var C=p[f]||p.parent.type!==m?p[f]:p.parent[f][g];f==="next"?w+=(C?Dn(C[g]):0)+2:f==="prev"&&(w=C?-4:0)}return o(a.setSelection(wt(a,c+w))),!0}return!1}},t.prototype.addTable=function(){return function(e){return function(r,i){var o=r.selection,s=r.tr,a=r.schema,l=e,c=l.columnCount,u=l.rowCount,d=Ft(o).endToOffset,p=function(f){return[Do(f),Do(f,!0)]}(c),h=function(f,m){for(var g=[],w=0;w<m;w+=1)g.push(Do(f));return g}(c,u-1);return M(M([],p),h).forEach(function(f){s.split(s.mapping.map(d)).insert(s.mapping.map(d),Jt(a,f))}),i(s.setSelection(wt(s,d+4))),!0}}},t.prototype.commands=function(){return{addTable:this.addTable()}},t.prototype.keymaps=function(){return{Enter:this.extendTable(),Tab:this.moveTableCell(!0),"Shift-Tab":this.moveTableCell(!1)}},t}(kt),um=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"thematicBreak"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("thematic-break")},0]}}},enumerable:!1,configurable:!0}),t.prototype.hr=function(){return function(){return function(e,r){var i=e.selection,o=e.schema,s=e.tr,a=Ft(i),l=a.from,c=a.to,u=a.endToOffset,d=Jt(o,"***");return s.split(l).replaceWith(s.mapping.map(l),s.mapping.map(c),d).split(s.mapping.map(c)).setSelection(wt(s,s.mapping.map(u))),r(s),!0}}},t.prototype.commands=function(){return{hr:this.hr()}},t.prototype.keymaps=function(){var e=this.hr()();return{"Mod-l":e,"Mod-L":e}},t}(kt);function dm(n,t){var e=n.type;return t<=n.sourcepos[0][0]&&(e==="codeBlock"||e==="heading"||e.match("table"))}var pm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"listItem"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{attrs:{odd:{default:!1},even:{default:!1},listStyle:{default:!1}},toDOM:function(e){var r=e.attrs,i=r.odd,o=r.even,s="list-item";return r.listStyle&&(s+="|list-item-style"),i&&(s+="|list-item-odd"),o&&(s+="|list-item-even"),["span",{class:Pt.apply(void 0,s.split("|"))},0]}}},enumerable:!1,configurable:!0}),t.prototype.extendList=function(){var e=this;return function(r,i){var o=r.selection,s=r.doc,a=r.schema,l=r.tr,c=e.context.toastMark,u=Ft(o),d=u.to,p=u.startFromOffset,h=u.endFromOffset,f=u.endIndex,m=u.endToOffset,g=Pn(s,f);if(!pr.test(g)||o.from===p||!o.empty)return!1;if(!g.replace(Ao,"").trim())l.deleteRange(h,m).split(l.mapping.map(m));else{var w=ba(g),C=c.findFirstNodeAtLine(f+1),E=g.slice(d-h),L={toastMark:c,mdNode:C,doc:s,line:f+1},P=nm[w](L),A=P.listSyntax,H=P.changedResults;if(H?.length){l.split(d),H.unshift({text:A+E,line:f+1}),e.changeToListPerLine(l,H,{from:d,startLine:H[0].line,endLine:At(H).line});var B=l.mapping.map(m)-E.length;l.setSelection(wt(l,B))}else ia(l,m,E,Jt(a,A+E))}return i(l),!0}},t.prototype.toList=function(e){var r=this;return function(){return function(i,o){for(var s=i.doc,a=i.tr,l=i.selection,c=r.context.toastMark,u=Ft(l),d=u.startIndex+1,p=u.endIndex+1,h=u.endToOffset,f=[],m=d;m<=p;m+=1){var g=c.findFirstNodeAtLine(m);if(g&&dm(g,m))break;if(f.indexOf(m)===-1){var w={toastMark:c,mdNode:g,doc:s,line:m,startLine:d},C=(ar(g)?tm[e](w):em[e](w)).changedResults,E=r.changeToListPerLine(a,C,{from:Io(s,C[0].line-1).startOffset,startLine:C[0].line,endLine:At(C).line,indexDiff:1});h=Math.max(E,h),C&&(f=f.concat(C.map(function(L){return L.line})))}}return o(a.setSelection(wt(a,a.mapping.map(h)))),!0}}},t.prototype.changeToListPerLine=function(e,r,i){for(var o=i.from,s=i.startLine,a=i.endLine,l=i.indexDiff,c=l===void 0?0:l,u=0,d=function(f){var m=e.doc.child(f),g=m.nodeSize,w=m.content,C=e.mapping.map(o),E=C+w.size,L=r.filter(function(P){return P.line-c===f})[0];L&&(e.replaceWith(C,E,Jt(p.context.schema,L.text)),u=Math.max(u,o+w.size)),o+=g},p=this,h=s-c;h<=a-c;h+=1)d(h);return u},t.prototype.toggleTask=function(){var e=this;return function(r,i){for(var o=r.selection,s=r.tr,a=r.doc,l=r.schema,c=e.context.toastMark,u=Ft(o),d=u.startIndex,p=u.endIndex,h=null,f=d;f<=p;f+=1){var m=c.findFirstNodeAtLine(f+1);if(ar(m)&&m.listData.task){var g=m.listData,w=g.checked,C=g.padding,E=w?" ":"x",L=m.sourcepos[0],P=Io(a,L[0]-1).startOffset;P+=L[1]+C,h=s.replaceWith(P,P+1,l.text(E))}}return!!h&&(i(h),!0)}},t.prototype.commands=function(){return{bulletList:this.toList("bullet"),orderedList:this.toList("ordered"),taskList:this.toList("task")}},t.prototype.keymaps=function(){var e=this.toList("bullet")(),r=this.toList("ordered")(),i=this.toList("task")(),o=this.toggleTask();return{"Mod-u":e,"Mod-U":e,"Mod-o":r,"Mod-O":r,"alt-t":i,"alt-T":i,"Shift-Ctrl-x":o,"Shift-Ctrl-X":o,Enter:this.extendList()}},t}(kt);function Ro(n,t){return function(){return function(e,r){var i=e.tr,o=e.selection,s=Te()(n)?n:function(E){return n.test(E)},a=t.length,l=i.doc,c=fu(o),u=c[0],d=c[1],p=Math.max(u-a,1),h=Math.min(d+a,l.content.size-1),f=o.content(),m=f.content.textBetween(0,f.content.size,`
`),g=l.textBetween(p,u,`
`),w=l.textBetween(d,h,`
`);if(m=""+g+m+w,g&&w&&s(m))i.delete(h-a,h).delete(p,p+a);else{i.insertText(t,d).insertText(t,u);var C=o.empty?wt(i,u+a):wt(i,u+a,d+a);i.setSelection(C)}return r(i),!0}}}var hm=/^(\*{2}|_{2}).*([\s\S]*)\1$/m,fm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"strong"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("strong")},0]}}},enumerable:!1,configurable:!0}),t.prototype.bold=function(){return Ro(hm,"**")},t.prototype.commands=function(){return{bold:this.bold()}},t.prototype.keymaps=function(){var e=this.bold()();return{"Mod-b":e,"Mod-B":e}},t}(kt),mm=/^(~{2}).*([\s\S]*)\1$/m,gm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"strike"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("strike")},0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return Ro(mm,"~~")},t.prototype.keymaps=function(){var e=this.commands()();return{"Mod-s":e,"Mod-S":e}},t}(kt),vm=/^(\*|_).*([\s\S]*)\1$/m,ym=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"emph"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("emph")},0]}}},enumerable:!1,configurable:!0}),t.prototype.italic=function(){return Ro(vm,"*")},t.prototype.commands=function(){return{italic:this.italic()}},t.prototype.keymaps=function(){var e=this.italic()();return{"Mod-i":e,"Mod-I":e}},t}(kt),bm=/^(`).*([\s\S]*)\1$/m,wm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"code"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{attrs:{start:{default:!1},end:{default:!1},marked:{default:!1}},toDOM:function(e){var r=e.attrs,i="code";return r.start&&(i+="|delimiter|start"),r.end&&(i+="|delimiter|end"),r.marked&&(i+="|marked-text"),["span",{class:Pt.apply(void 0,i.split("|"))},0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return Ro(bm,"`")},t.prototype.keymaps=function(){var e=this.commands()();return{"Shift-Mod-c":e,"Shift-Mod-C":e}},t}(kt),km=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"link"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{attrs:{url:{default:!1},desc:{default:!1}},toDOM:function(e){var r=e.attrs,i="link";return r.url&&(i+="|link-url|marked-text"),r.desc&&(i+="|link-desc|marked-text"),["span",{class:Pt.apply(void 0,i.split("|"))},0]}}},enumerable:!1,configurable:!0}),t.prototype.addLinkOrImage=function(e){return function(r){return function(i,o){var s=i.selection,a=i.tr,l=i.schema,c=fu(s),u=c[0],d=c[1],p=r,h=p.linkText,f=p.altText,m=p.linkUrl,g=p.imageUrl,w=h,C=m,E="";return e==="image"&&(w=f,C=g,E="!"),E+="["+(w=Le(w))+"]("+C+")",o(a.replaceWith(u,d,Jt(l,E))),!0}}},t.prototype.commands=function(){return{addImage:this.addLinkOrImage("image"),addLink:this.addLinkOrImage("link")}},t}(kt),xm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"taskDelimiter"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("delimiter","list-item")},0]}}},enumerable:!1,configurable:!0}),t}(kt),Cm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"delimiter"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("delimiter")},0]}}},enumerable:!1,configurable:!0}),t}(kt),Em=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"meta"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("meta")},0]}}},enumerable:!1,configurable:!0}),t}(kt),Tm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"markedText"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("marked-text")},0]}}},enumerable:!1,configurable:!0}),t}(kt),Sm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"tableCell"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("table-cell")},0]}}},enumerable:!1,configurable:!0}),t}(kt),Mm=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"html"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("html")},0]}}},enumerable:!1,configurable:!0}),t}(kt),Lu="$$",Im=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"customBlock"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{toDOM:function(){return["span",{class:Pt("custom-block")},0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(e){return function(r,i){var o=r.selection,s=r.schema,a=r.tr,l=Ft(o),c=l.startFromOffset,u=l.endToOffset;if(!e?.info)return!1;var d="$$"+e.info,p=Jt(s,d),h=Jt(s,Lu);return a.insert(c,p).split(c+d.length),a.split(a.mapping.map(u)).insert(a.mapping.map(u),h),i(a.setSelection(wt(a,a.mapping.map(u)-(Lu.length+2)))),!0}}},t}(kt),Nm=/x|backspace/i,Om=/^\[(\s*)(x?)(\s*)\](?:\s+)/i,Ca="cut",Au=/\r\n|\n|\r/,Lm=function(n){function t(e,r){var i=n.call(this,e)||this,o=r.toastMark,s=r.useCommandShortcut,a=s===void 0||s,l=r.mdPlugins,c=l===void 0?[]:l;return i.editorType="markdown",i.el.classList.add("md-mode"),i.toastMark=o,i.extraPlugins=c,i.specs=i.createSpecs(),i.schema=i.createSchema(),i.context=i.createContext(),i.keymaps=i.createKeymaps(a),i.view=i.createView(),i.commands=i.createCommands(),i.specs.setContext(v(v({},i.context),{view:i.view})),i.createClipboard(),i.eventEmitter.listen("changePreviewTabWrite",function(u){return i.toggleActive(!0,u)}),i.eventEmitter.listen("changePreviewTabPreview",function(){return i.toggleActive(!1)}),i.initEvent(),i}return k(t,n),t.prototype.toggleActive=function(e,r){ca(this.el,"active",e),e?r||this.focus():this.blur()},t.prototype.createClipboard=function(){var e=this;this.clipboard=document.createElement("textarea"),this.clipboard.className=J("pseudo-clipboard"),this.clipboard.addEventListener("paste",function(r){var i=r.clipboardData||window.clipboardData,o=i&&i.items;if(o){var s=rn()(o).some(function(l){return l.kind==="string"&&l.type==="text/rtf"});if(!s){var a=cu(o);a&&(r.preventDefault(),fa(e.eventEmitter,a,r.type))}}}),this.clipboard.addEventListener("input",function(r){var i=r.target.value;e.replaceSelection(i),r.preventDefault(),r.target.value=""}),this.el.insertBefore(this.clipboard,this.view.dom)},t.prototype.createContext=function(){return{toastMark:this.toastMark,schema:this.schema,eventEmitter:this.eventEmitter}},t.prototype.createSpecs=function(){return new hu([new Gf,new rm,new du,new im,new sm,new Yf,new am,new Im,new cm,new Sm,new um,new pm,new fm,new gm,new ym,new wm,new km,new Cm,new xm,new Tm,new Em,new Mm])},t.prototype.createPlugins=function(){return M([$f(this.context),Kf(this.context),(e=this.context,r=e.schema,i=e.toastMark,new le({props:{handleDOMEvents:{keyup:function(o,s){var a,l=o.state,c=l.doc,u=l.tr,d=l.selection;if(d.empty&&Nm.test(s.key)){var p=Ft(d),h=p.startIndex,f=p.startFromOffset,m=[h+1,p.from-f+1],g=qr(i.findNodeAtPosition(m),function(_){var Y;return _.type==="paragraph"&&((Y=_.parent)===null||Y===void 0?void 0:Y.type)==="item"});if(!((a=g?.firstChild)===null||a===void 0)&&a.literal){var w=g.firstChild,C=w.literal.match(Om);if(C){var E=w.sourcepos[0],L=C[1],P=C[2],A=C[3],H=L.length+A.length,B=Io(c,E[0]-1).startOffset,z=E[1]+B;if(P){var q=H?H+1:0;u.replaceWith(z,q+z,r.text(P)),o.dispatch(u)}else H||(u.insertText(" ",z),o.dispatch(u))}}}return!1}}}}))],this.createPluginProps()).concat(this.defaultPlugins);var e,r,i},t.prototype.createView=function(){var e=this;return new Ws(this.el,{state:this.createState(),dispatchTransaction:function(r){e.updateMarkdown(r);var i=e.view.state.applyTransaction(r).state;e.view.updateState(i),e.emitChangeEvent(r)},handleKeyDown:function(r,i){return(i.metaKey||i.ctrlKey)&&i.key.toUpperCase()==="V"&&e.clipboard.focus(),e.eventEmitter.emit("keydown",e.editorType,i),!1},handleDOMEvents:{copy:function(r,i){return e.captureCopy(i)},cut:function(r,i){return e.captureCopy(i,Ca)},scroll:function(){return e.eventEmitter.emit("scroll","editor"),!0},keyup:function(r,i){return e.eventEmitter.emit("keyup",e.editorType,i),!1}},nodeViews:{widget:uu}})},t.prototype.createCommands=function(){return this.specs.commands(this.view)},t.prototype.captureCopy=function(e,r){e.preventDefault();var i=this.view.state,o=i.selection,s=i.tr;if(o.empty)return!0;var a=this.getChanged(o.content());return e.clipboardData?e.clipboardData.setData("text/plain",a):window.clipboardData.setData("Text",a),r===Ca&&this.view.dispatch(s.deleteSelection().scrollIntoView().setMeta("uiEvent",Ca)),!0},t.prototype.updateMarkdown=function(e){var r=this;e.docChanged&&e.steps.forEach(function(i,o){if(i.slice&&!(i instanceof Mt)){var s=e.docs[o],a=[i.from,i.to],l=Mo(s,a[0],a[1]),c=l[0],u=l[1],d=r.getChanged(i.slice);c[0]===u[0]&&c[1]===u[1]&&d===""&&(d=`
`);var p=r.toastMark.editMarkdown(c,u,d);r.eventEmitter.emit("updatePreview",p),e.setMeta("editResult",p).scrollIntoView()}})},t.prototype.getChanged=function(e){var r="",i=e.content.size;return e.content.nodesBetween(0,i,function(o,s){o.isText?r+=o.text.slice(Math.max(0,s)-s,i-s):o.isBlock&&s>0&&(r+=`
`)}),r},t.prototype.setSelection=function(e,r){r===void 0&&(r=e);var i=this.view.state.tr,o=ur(i.doc,e,r),s=o[0],a=o[1];this.view.dispatch(i.setSelection(wt(i,s,a)).scrollIntoView())},t.prototype.replaceSelection=function(e,r,i){var o,s=this.view.state,a=s.tr,l=s.schema,c=s.doc,u=e.split(Au).map(function(m){return bo(l,lr(m,l))}),d=new j(S.from(u),1,1);if(this.focus(),r&&i){var p=ur(c,r,i),h=p[0],f=p[1];o=a.replaceRange(h,f,d)}else o=a.replaceSelection(d);this.view.dispatch(o.scrollIntoView())},t.prototype.deleteSelection=function(e,r){var i,o=this.view.state,s=o.tr,a=o.doc;if(e&&r){var l=ur(a,e,r),c=l[0],u=l[1];i=s.deleteRange(c,u)}else i=s.deleteSelection();this.view.dispatch(i.scrollIntoView())},t.prototype.getSelectedText=function(e,r){var i=this.view.state,o=i.doc,s=i.selection,a=s.from,l=s.to;if(e&&r){var c=ur(o,e,r);a=c[0],l=c[1]}return o.textBetween(a,l,`
`)},t.prototype.getSelection=function(){var e=this.view.state.selection,r=e.from,i=e.to;return Mo(this.view.state.tr.doc,r,i)},t.prototype.setMarkdown=function(e,r){r===void 0&&(r=!0);var i=e.split(Au),o=this.view.state,s=o.tr,a=o.doc,l=o.schema,c=i.map(function(u){return bo(l,lr(u,l))});this.view.dispatch(s.replaceWith(0,a.content.size,c)),r&&this.moveCursorToEnd(!0)},t.prototype.addWidget=function(e,r,i){var o=this.view.state,s=o.tr,a=o.doc,l=o.selection,c=i?ur(a,i,i)[0]:l.to;this.view.dispatch(s.setMeta("widget",{pos:c,node:e,style:r}))},t.prototype.replaceWithWidget=function(e,r,i){var o=this.view.state,s=o.tr,a=o.schema,l=ur(o.doc,e,r),c=lr(i,a);this.view.dispatch(s.replaceWith(l[0],l[1],c))},t.prototype.getRangeInfoOfNode=function(e){var r=this.view.state,i=r.doc,o=r.selection,s=e||Mo(i,o.from)[0],a=this.toastMark.findNodeAtPosition(s);return a.type==="text"&&a.parent.type!=="paragraph"&&(a=a.parent),a.sourcepos[1][1]+=1,{range:a.sourcepos,type:a.type}},t.prototype.getMarkdown=function(){return this.toastMark.getLineTexts().map(function(e){return Eo(e)}).join(`
`)},t.prototype.getToastMark=function(){return this.toastMark},t}(pu),Am=Lm,Dm=b(349),Du=b.n(Dm),Rm=b(348),Ru=b.n(Rm),Ea=function(n,t){return Ea=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},Ea(n,t)};function Se(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}Ea(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Yt=function(){return Yt=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},Yt.apply(this,arguments)};function Ta(n,t,e){if(arguments.length===2)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))}var Vr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:b.g!==void 0?b.g:typeof self<"u"?self:{},Pu={};function Po(n,t,e){var r,i,o,s,a,l="";for(typeof t!="string"&&(e=t,t=Po.defaultChars),e===void 0&&(e=!0),a=function(c){var u,d,p=Pu[c];if(p)return p;for(p=Pu[c]=[],u=0;u<128;u++)d=String.fromCharCode(u),/^[0-9a-z]$/i.test(d)?p.push(d):p.push("%"+("0"+u.toString(16).toUpperCase()).slice(-2));for(u=0;u<c.length;u++)p[c.charCodeAt(u)]=c[u];return p}(t),r=0,i=n.length;r<i;r++)if(o=n.charCodeAt(r),e&&o===37&&r+2<i&&/^[0-9a-f]{2}$/i.test(n.slice(r+1,r+3)))l+=n.slice(r,r+3),r+=2;else if(o<128)l+=a[o];else if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&r+1<i&&(s=n.charCodeAt(r+1))>=56320&&s<=57343){l+=encodeURIComponent(n[r]+n[r+1]),r++;continue}l+="%EF%BF%BD"}else l+=encodeURIComponent(n[r]);return l}Po.defaultChars=";/?:@&=+$,-_.!~*'()#",Po.componentChars="-_.!~*'()";var Pm=Po,Sa={},ln={},Fu={Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:" ",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",amp:"&",AMP:"&",andand:"",And:"",and:"",andd:"",andslope:"",andv:"",ang:" ",ange:"",angle:" ",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angmsd:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",apacir:"",ap:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",barwed:"",Barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",because:"",Because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxdl:"",boxdL:"",boxDl:"",boxDL:"",boxdr:"",boxdR:"",boxDr:"",boxDR:"",boxh:"",boxH:"",boxhd:"",boxHd:"",boxhD:"",boxHD:"",boxhu:"",boxHu:"",boxhU:"",boxHU:"",boxminus:"",boxplus:"",boxtimes:" ",boxul:"",boxuL:"",boxUl:"",boxUL:"",boxur:"",boxuR:"",boxUr:"",boxUR:"",boxv:"",boxV:"",boxvh:"",boxvH:"",boxVh:"",boxVH:"",boxvl:"",boxvL:"",boxVl:"",boxVL:"",boxvr:"",boxvR:"",boxVr:"",boxVR:" ",bprime:"",breve:"",Breve:"",brvbar:"",bscr:"",Bscr:"",bsemi:"",bsim:"",bsime:"",bsolb:"",bsol:"\\",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",capand:"",capbrcup:"",capcap:"",cap:"",Cap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",centerdot:"",CenterDot:"",cfr:" ",Cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cir:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",colon:":",Colon:"",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",conint:"",Conint:"",ContourIntegral:"",copf:"",Copf:"",coprod:"",Coproduct:"",copy:"",COPY:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",cross:"",Cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",cupbrcap:"",cupcap:"",CupCap:"",cup:"",Cup:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",dagger:" ",Dagger:"",daleth:"",darr:"",Darr:"",dArr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",ddagger:"",ddarr:"",DD:"",dd:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",diamond:"",Diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrowBar:"",downarrow:"",DownArrow:"",Downarrow:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVectorBar:"",DownLeftVector:"",DownRightTeeVector:"",DownRightVectorBar:"",DownRightVector:"",DownTeeArrow:"",DownTee:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",Ecirc:"",ecirc:"",ecir:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",edot:"",eDot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp13:"",emsp14:"",emsp:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",escr:"",Escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",exponentiale:"",ExponentialE:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",forall:"",ForAll:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",fscr:"",Fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:" ",gdot:"",ge:"",gE:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",gescc:"",ges:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",gg:"",Gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gla:"",gl:"",glE:"",glj:"",gnap:"",gnapprox:"",gne:"",gnE:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",gtcc:"",gtcir:"",gt:">",GT:">",Gt:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",harrcir:"",harr:"",hArr:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",hfr:"",Hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",hopf:"",Hopf:"",horbar:"",HorizontalLine:"",hscr:"",Hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",ifr:"",Ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",Im:"",imof:"",imped:"",Implies:"",incare:"",in:"",infin:"",infintie:"",inodot:"",intcal:"",int:"",Int:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",iscr:"",Iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",lang:"",Lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",larrb:"",larrbfs:"",larr:"",Larr:"",lArr:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",latail:"",lAtail:"",lat:"",late:"",lates:"",lbarr:"",lBarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",le:"",lE:"",LeftAngleBracket:"",LeftArrowBar:"",leftarrow:"",LeftArrow:"",Leftarrow:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVectorBar:"",LeftDownVector:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",leftrightarrow:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTeeArrow:"",LeftTee:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangleBar:"",LeftTriangle:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:" ",LeftUpVectorBar:"",LeftUpVector:"",LeftVectorBar:"",LeftVector:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",lescc:"",les:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",llarr:"",ll:"",Ll:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoustache:"",lmoust:"",lnap:"",lnapprox:"",lne:"",lnE:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",longleftarrow:"",LongLeftArrow:"",Longleftarrow:"",longleftrightarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longmapsto:"",longrightarrow:"",LongRightArrow:"",Longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",lscr:"",Lscr:"",lsh:"",Lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",ltcc:"",ltcir:"",lt:"<",LT:"<",Lt:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:" ",maltese:" ",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",midast:"*",midcir:"",mid:"",middot:"",minusb:"",minus:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",mscr:"",Mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:" ",nap:"",napE:"",napid:"",napos:"",napprox:"",natural:"",naturals:"",natur:"",nbsp:" ",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",nearhk:"",nearr:"",neArr:"",nearrow:"",ne:" ",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nharr:"",nhArr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlarr:"",nlArr:"",nldr:"",nlE:"",nle:"",nleftarrow:"",nLeftarrow:"",nleftrightarrow:"",nLeftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:" ",NonBreakingSpace:" ",nopf:"",Nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:" ",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangleBar:"",NotLeftTriangle:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:" ",NotReverseElement:"",NotRightTriangleBar:"",NotRightTriangle:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",nparallel:"",npar:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:" ",nprec:"",npreceq:"",npre:"",nrarrc:"",nrarr:"",nrArr:"",nrarrw:"",nrightarrow:"",nRightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nvdash:"",nvDash:"",nVdash:"",nVDash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwarr:"",nwArr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",Ocirc:"",ocirc:"",ocir:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:" ",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",orarr:"",Or:"",or:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",otimesas:"",Otimes:"",otimes:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",para:"",parallel:"",par:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:" ",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plusacir:"",plusb:"",pluscir:"",plus:"+",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",popf:"",Popf:"",pound:"",prap:"",Pr:"",pr:"",prcue:"",precapprox:"",prec:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",pre:"",prE:"",precsim:"",prime:"",Prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportional:"",Proportion:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",qopf:"",Qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",quot:'"',QUOT:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",rang:"",Rang:"",rangd:"",range:"",rangle:"",raquo:"",rarrap:"",rarrb:"",rarrbfs:" ",rarrc:"",rarr:"",Rarr:" ",rArr:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",ratail:"",rAtail:"",ratio:"",rationals:"",rbarr:"",rBarr:"",RBarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:" ",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",real:"",realine:"",realpart:"",reals:"",Re:"",rect:"",reg:"",REG:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",rfr:"",Rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrowBar:"",rightarrow:"",RightArrow:"",Rightarrow:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVectorBar:"",RightDownVector:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTeeArrow:"",RightTee:"",RightTeeVector:"",rightthreetimes:"",RightTriangleBar:"",RightTriangle:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVectorBar:"",RightUpVector:"",RightVectorBar:"",RightVector:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoustache:"",rmoust:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",ropf:"",Ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",rscr:"",Rscr:"",rsh:"",Rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",scap:"",Scaron:" ",scaron:"",Sc:"",sc:"",sccue:"",sce:"",scE:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdotb:"",sdot:"",sdote:"",searhk:"",searr:"",seArr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:" ",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",solbar:"",solb:"",sol:"/",Sopf:"",sopf:"",spades:" ",spadesuit:" ",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",square:"",Square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squ:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",sub:"",Sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",subset:"",Subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succapprox:"",succ:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",sum:"",Sum:"",sung:"",sup1:"",sup2:"",sup3:"",sup:"",Sup:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",supset:"",Supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swarr:"",swArr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",therefore:"",Therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",ThinSpace:"",thinsp:"",thkap:"",thksim:"",THORN:"",thorn:"",tilde:"",Tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",timesbar:"",timesb:" ",times:"",timesd:"",tint:"",toea:"",topbot:"",topcir:"",top:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",trade:"",TRADE:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:" ",Uacute:"",uacute:"",uarr:"",Uarr:"",uArr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrowBar:"",uparrow:"",UpArrow:"",Uparrow:"",UpArrowDownArrow:"",updownarrow:"",UpDownArrow:"",Updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",upsi:"",Upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTeeArrow:"",UpTee:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",varr:"",vArr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",vBar:"",Vbar:"",vBarv:"",Vcy:"",vcy:"",vdash:"",vDash:"",Vdash:"",VDash:"",Vdashl:"",veebar:"",vee:"",Vee:"",veeeq:"",vellip:"",verbar:"|",Verbar:"",vert:"|",Vert:"",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",wedge:"",Wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xharr:"",xhArr:"",Xi:"",xi:"",xlarr:"",xlArr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrarr:"",xrArr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",yuml:"",Yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",zfr:"",Zfr:"",ZHcy:"",zhcy:"",zigrarr:"",zopf:"",Zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""},Fm={Aacute:"",aacute:"",Acirc:"",acirc:"",acute:"",AElig:"",aelig:"",Agrave:"",agrave:" ",amp:"&",AMP:"&",Aring:"",aring:"",Atilde:"",atilde:"",Auml:"",auml:"",brvbar:"",Ccedil:"",ccedil:"",cedil:"",cent:"",copy:"",COPY:"",curren:"",deg:"",divide:"",Eacute:"",eacute:"",Ecirc:"",ecirc:"",Egrave:"",egrave:"",ETH:"",eth:"",Euml:"",euml:"",frac12:"",frac14:"",frac34:"",gt:">",GT:">",Iacute:"",iacute:"",Icirc:"",icirc:"",iexcl:"",Igrave:"",igrave:"",iquest:"",Iuml:"",iuml:"",laquo:"",lt:"<",LT:"<",macr:"",micro:"",middot:"",nbsp:" ",not:"",Ntilde:"",ntilde:"",Oacute:"",oacute:"",Ocirc:"",ocirc:"",Ograve:"",ograve:"",ordf:"",ordm:"",Oslash:"",oslash:"",Otilde:"",otilde:"",Ouml:"",ouml:"",para:"",plusmn:"",pound:"",quot:'"',QUOT:'"',raquo:"",reg:"",REG:"",sect:"",shy:"",sup1:"",sup2:"",sup3:"",szlig:"",THORN:"",thorn:"",times:"",Uacute:"",uacute:"",Ucirc:"",ucirc:"",Ugrave:"",ugrave:"",uml:"",Uuml:"",uuml:"",Yacute:"",yacute:"",yen:"",yuml:""},Bu={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'},Ma={},Bm=Vr&&Vr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ma,"__esModule",{value:!0});var Hu=Bm({0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376}),Hm=String.fromCodePoint||function(n){var t="";return n>65535&&(n-=65536,t+=String.fromCharCode(n>>>10&1023|55296),n=56320|1023&n),t+=String.fromCharCode(n)};Ma.default=function(n){return n>=55296&&n<=57343||n>1114111?"":(n in Hu.default&&(n=Hu.default[n]),Hm(n))};var Fo=Vr&&Vr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ln,"__esModule",{value:!0}),ln.decodeHTML=ln.decodeHTMLStrict=ln.decodeXML=void 0;var Ia=Fo(Fu),zm=Fo(Fm),_m=Fo(Bu),zu=Fo(Ma),qm=/&(?:[a-zA-Z0-9]+|#[xX][\da-fA-F]+|#\d+);/g;function _u(n){var t=$u(n);return function(e){return String(e).replace(qm,t)}}ln.decodeXML=_u(_m.default),ln.decodeHTMLStrict=_u(Ia.default);var qu=function(n,t){return n<t?1:-1};function $u(n){return function(t){if(t.charAt(1)==="#"){var e=t.charAt(2);return e==="X"||e==="x"?zu.default(parseInt(t.substr(3),16)):zu.default(parseInt(t.substr(2),10))}return n[t.slice(1,-1)]||t}}ln.decodeHTML=function(){for(var n=Object.keys(zm.default).sort(qu),t=Object.keys(Ia.default).sort(qu),e=0,r=0;e<t.length;e++)n[r]===t[e]?(t[e]+=";?",r++):t[e]+=";";var i=new RegExp("&(?:"+t.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),o=$u(Ia.default);function s(a){return a.substr(-1)!==";"&&(a+=";"),o(a)}return function(a){return String(a).replace(i,s)}}();var we={},ju=Vr&&Vr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(we,"__esModule",{value:!0}),we.escapeUTF8=we.escape=we.encodeNonAsciiHTML=we.encodeHTML=we.encodeXML=void 0;var Vu=Gu(ju(Bu).default),Uu=Ju(Vu);we.encodeXML=Xu(Vu);var Wu,Ku,Na=Gu(ju(Fu).default),$m=Ju(Na);function Gu(n){return Object.keys(n).sort().reduce(function(t,e){return t[n[e]]="&"+e+";",t},{})}function Ju(n){for(var t=[],e=[],r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];o.length===1?t.push("\\"+o):e.push(o)}t.sort();for(var s=0;s<t.length-1;s++){for(var a=s;a<t.length-1&&t[a].charCodeAt(1)+1===t[a+1].charCodeAt(1);)a+=1;var l=1+a-s;l<3||t.splice(s,l,t[s]+"-"+t[a])}return e.unshift("["+t.join("")+"]"),new RegExp(e.join("|"),"g")}we.encodeHTML=(Wu=Na,Ku=$m,function(n){return n.replace(Ku,function(t){return Wu[t]}).replace(Yu,Bo)}),we.encodeNonAsciiHTML=Xu(Na);var Yu=/(?:[\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,jm=String.prototype.codePointAt!=null?function(n){return n.codePointAt(0)}:function(n){return 1024*(n.charCodeAt(0)-55296)+n.charCodeAt(1)-56320+65536};function Bo(n){return"&#x"+(n.length>1?jm(n):n.charCodeAt(0)).toString(16).toUpperCase()+";"}var Qu=new RegExp(Uu.source+"|"+Yu.source,"g");function Xu(n){return function(t){return t.replace(Qu,function(e){return n[e]||Bo(e)})}}we.escape=function(n){return n.replace(Qu,Bo)},we.escapeUTF8=function(n){return n.replace(Uu,Bo)},function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.decodeXMLStrict=n.decodeHTML5Strict=n.decodeHTML4Strict=n.decodeHTML5=n.decodeHTML4=n.decodeHTMLStrict=n.decodeHTML=n.decodeXML=n.encodeHTML5=n.encodeHTML4=n.escapeUTF8=n.escape=n.encodeNonAsciiHTML=n.encodeHTML=n.encodeXML=n.encode=n.decodeStrict=n.decode=void 0;var t=ln,e=we;n.decode=function(o,s){return(!s||s<=0?t.decodeXML:t.decodeHTML)(o)},n.decodeStrict=function(o,s){return(!s||s<=0?t.decodeXML:t.decodeHTMLStrict)(o)},n.encode=function(o,s){return(!s||s<=0?e.encodeXML:e.encodeHTML)(o)};var r=we;Object.defineProperty(n,"encodeXML",{enumerable:!0,get:function(){return r.encodeXML}}),Object.defineProperty(n,"encodeHTML",{enumerable:!0,get:function(){return r.encodeHTML}}),Object.defineProperty(n,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return r.encodeNonAsciiHTML}}),Object.defineProperty(n,"escape",{enumerable:!0,get:function(){return r.escape}}),Object.defineProperty(n,"escapeUTF8",{enumerable:!0,get:function(){return r.escapeUTF8}}),Object.defineProperty(n,"encodeHTML4",{enumerable:!0,get:function(){return r.encodeHTML}}),Object.defineProperty(n,"encodeHTML5",{enumerable:!0,get:function(){return r.encodeHTML}});var i=ln;Object.defineProperty(n,"decodeXML",{enumerable:!0,get:function(){return i.decodeXML}}),Object.defineProperty(n,"decodeHTML",{enumerable:!0,get:function(){return i.decodeHTML}}),Object.defineProperty(n,"decodeHTMLStrict",{enumerable:!0,get:function(){return i.decodeHTMLStrict}}),Object.defineProperty(n,"decodeHTML4",{enumerable:!0,get:function(){return i.decodeHTML}}),Object.defineProperty(n,"decodeHTML5",{enumerable:!0,get:function(){return i.decodeHTML}}),Object.defineProperty(n,"decodeHTML4Strict",{enumerable:!0,get:function(){return i.decodeHTMLStrict}}),Object.defineProperty(n,"decodeHTML5Strict",{enumerable:!0,get:function(){return i.decodeHTMLStrict}}),Object.defineProperty(n,"decodeXMLStrict",{enumerable:!0,get:function(){return i.decodeXML}})}(Sa);var Zu="&(?:#x[a-f0-9]{1,6}|#[0-9]{1,7}|[a-z][a-z0-9]{1,31});",Vm=/[\\&]/,Oa="[!\"#$%&'()*+,./:;<=>?@[\\\\\\]^_`{|}~-]",Um=new RegExp("\\\\"+Oa+"|"+Zu,"gi"),td=new RegExp('[&<>"]',"g"),Wm=function(n){return n.charCodeAt(0)===92?n.charAt(1):Sa.decodeHTML(n)};function Bi(n){return Vm.test(n)?n.replace(Um,Wm):n}function Ho(n){try{return Pm(n)}catch{return n}}function Km(n){switch(n){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";default:return n}}function Ur(n){return td.test(n)?n.replace(td,Km):n}function La(n,t){for(var e=[],r=0;r<t;r++)e.push(n);return e.join("")}function ed(n){return!n||!/[^ \t]+/.test(n)}var Gm=function(){function n(t){this.current=t,this.root=t,this.entering=!0}return n.prototype.next=function(){var t=this.current,e=this.entering;if(t===null)return null;var r=Aa(t);return e&&r?t.firstChild?(this.current=t.firstChild,this.entering=!0):this.entering=!1:t===this.root?this.current=null:t.next===null?(this.current=t.parent,this.entering=!1):(this.current=t.next,this.entering=!0),{entering:e,node:t}},n.prototype.resumeAt=function(t,e){this.current=t,this.entering=e===!0},n}();function Aa(n){switch(n.type){case"document":case"blockQuote":case"list":case"item":case"paragraph":case"heading":case"emph":case"strong":case"strike":case"link":case"image":case"table":case"tableHead":case"tableBody":case"tableRow":case"tableCell":case"tableDelimRow":case"customInline":return!0;default:return!1}}var Jm=1,zo={};function Da(n){delete zo[n]}var Hi=function(){function n(t,e){this.parent=null,this.prev=null,this.next=null,this.firstChild=null,this.lastChild=null,this.literal=null,this.id=t==="document"?-1:Jm++,this.type=t,this.sourcepos=e,zo[this.id]=this}return n.prototype.isContainer=function(){return Aa(this)},n.prototype.unlink=function(){this.prev?this.prev.next=this.next:this.parent&&(this.parent.firstChild=this.next),this.next?this.next.prev=this.prev:this.parent&&(this.parent.lastChild=this.prev),this.parent=null,this.next=null,this.prev=null},n.prototype.replaceWith=function(t){this.insertBefore(t),this.unlink()},n.prototype.insertAfter=function(t){t.unlink(),t.next=this.next,t.next&&(t.next.prev=t),t.prev=this,this.next=t,this.parent&&(t.parent=this.parent,t.next||(t.parent.lastChild=t))},n.prototype.insertBefore=function(t){t.unlink(),t.prev=this.prev,t.prev&&(t.prev.next=t),t.next=this,this.prev=t,t.parent=this.parent,t.prev||(t.parent.firstChild=t)},n.prototype.appendChild=function(t){t.unlink(),t.parent=this,this.lastChild?(this.lastChild.next=t,t.prev=this.lastChild,this.lastChild=t):(this.firstChild=t,this.lastChild=t)},n.prototype.prependChild=function(t){t.unlink(),t.parent=this,this.firstChild?(this.firstChild.prev=t,t.next=this.firstChild,this.firstChild=t):(this.firstChild=t,this.lastChild=t)},n.prototype.walker=function(){return new Gm(this)},n}(),cn=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.open=!0,i.lineOffsets=null,i.stringContent=null,i.lastLineBlank=!1,i.lastLineChecked=!1,i.type=e,i}return Se(t,n),t}(Hi),Ym=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.listData=null,e}return Se(t,n),t}(cn),Qm=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.level=0,e.headingType="atx",e}return Se(t,n),t}(cn),Xm=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.isFenced=!1,e.fenceChar=null,e.fenceLength=0,e.fenceOffset=-1,e.info=null,e.infoPadding=0,e}return Se(t,n),t}(cn),Zm=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.columns=[],e}return Se(t,n),t}(cn),tg=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.startIdx=0,e.endIdx=0,e.paddingLeft=0,e.paddingRight=0,e.ignored=!1,e}return Se(t,n),t}(cn),eg=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.title="",e.dest="",e.label="",e}return Se(t,n),t}(cn),ng=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.syntaxLength=0,e.offset=-1,e.info="",e}return Se(t,n),t}(cn),rg=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.htmlBlockType=-1,e}return Se(t,n),t}(cn),ig=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.destination=null,e.title=null,e.extendedAutolink=!1,e}return Se(t,n),t}(Hi),og=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.tickCount=0,e}return Se(t,n),t}(Hi),sg=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.info="",e}return Se(t,n),t}(Hi);function Et(n,t){switch(n){case"heading":return new Qm(n,t);case"list":case"item":return new Ym(n,t);case"link":case"image":return new ig(n,t);case"codeBlock":return new Xm(n,t);case"htmlBlock":return new rg(n,t);case"table":return new Zm(n,t);case"tableCell":return new tg(n,t);case"document":case"paragraph":case"blockQuote":case"thematicBreak":case"tableRow":case"tableBody":case"tableHead":case"frontMatter":return new cn(n,t);case"code":return new og(n,t);case"refDef":return new eg(n,t);case"customBlock":return new ng(n,t);case"customInline":return new sg(n,t);default:return new Hi(n,t)}}function nd(n){return n.type==="codeBlock"}function rd(n){return n.type==="list"}function Wr(n){return n.type==="refDef"}function id(n){return n.type==="customBlock"}function Bt(n,t){var e=Et("text",t);return e.literal=n,e}var Ra,od="[A-Za-z][A-Za-z0-9-]*",ag="<"+od+`(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^"'=<>\`\\x00-\\x20]+|'[^']*'|"[^"]*"))?)*\\s*/?>`,lg="</"+od+"\\s*[>]",cg=new RegExp(`^(?:<[A-Za-z][A-Za-z0-9-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^"'=<>\`\\x00-\\x20]+|'[^']*'|"[^"]*"))?)*\\s*/?>|</[A-Za-z][A-Za-z0-9-]*\\s*[>]|<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->|[<][?].*?[?][>]|<![A-Z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)`,"i");if(String.fromCodePoint)Ra=function(n){try{return String.fromCodePoint(n)}catch(t){if(t instanceof RangeError)return"";throw t}};else{var ug=String.fromCharCode,dg=Math.floor;Ra=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e,r,i=16384,o=[],s=-1,a=n.length;if(!a)return"";for(var l="";++s<a;){var c=Number(n[s]);if(!isFinite(c)||c<0||c>1114111||dg(c)!==c)return"";c<=65535?o.push(c):(e=55296+((c-=65536)>>10),r=c%1024+56320,o.push(e,r)),(s+1===a||o.length>i)&&(l+=ug.apply(void 0,o),o.length=0)}return l}}var Pa=Ra;function pg(n){var t=/\)+$/.exec(n);if(t){for(var e=0,r=0,i=n;r<i.length;r++){var o=i[r];o==="("?e<0?e=1:e+=1:o===")"&&(e-=1)}if(e<0){var s=Math.min(-e,t[0].length);return n.substring(0,n.length-s)}}return n}function hg(n){return n.replace(/&[A-Za-z0-9]+;$/,"")}function fg(n){return Ta(Ta([],function(t){for(var e,r=new RegExp("(www|https?://).(?:[w-]+.)*[A-Za-z0-9-]+.[A-Za-z0-9-]+[^<\\s]*[^<?!.,:*_?~\\s]","g"),i=[];e=r.exec(t);){var o=hg(pg(e[0])),s=e[1]==="www"?"http://":"";i.push({text:o,range:[e.index,e.index+o.length-1],url:""+s+o})}return i}(n)),function(t){for(var e,r=new RegExp("[\\w.+-]+@(?:[\\w-]+\\.)+[\\w-]+","g"),i=[];e=r.exec(t);){var o=e[0];/[_-]+$/.test(o)||i.push({text:o,range:[e.index,e.index+o.length-1],url:"mailto:"+o})}return i}(n)).sort(function(t,e){return t.range[0]-e.range[0]})}function _o(n){return n[n.length-1]}function sd(n){return n.slice(1,n.length-1).trim().replace(/[ \t\r\n]+/," ").toLowerCase().toUpperCase()}function qo(n,t){Object.keys(n).forEach(function(e){t(e,n[e])})}function Kr(n){return!Object.keys(n).length}var Fa=126,Gr=39,Jr=34,Yr=36,Ba="\\\\"+Oa,ad=new RegExp(/[!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E42\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC9\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDF3C-\uDF3E]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]/),mg=new RegExp('^(?:"('+Ba+`|[^"\\x00])*"|'(`+Ba+"|[^'\\x00])*'|\\(("+Ba+"|[^()\\x00])*\\))"),gg=/^(?:<(?:[^<>\n\\\x00]|\\.)*>)/,ld=new RegExp("^"+Oa),vg=new RegExp("^"+Zu,"i"),yg=/`+/,bg=/^`+/,wg=/\.\.\./g,kg=/--+/g,xg=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,Cg=/^<[A-Za-z][A-Za-z0-9.+-]{1,31}:[^<>\x00-\x20]*>/i,Eg=/^ *(?:\n *)?/,Ha=/^[ \t\n\x0b\x0c\x0d]/,cd=/^\s/,Tg=/ *$/,Sg=/^ */,ud=/^ *(?:\n|$)/,Mg=/^\[(?:[^\\\[\]]|\\.){0,1000}\]/,Ig=/^[^\n`\[\]\\!<&*_'"~$]+/m,Ng=function(){function n(t){this.subject="",this.delimiters=null,this.brackets=null,this.pos=0,this.lineStartNum=0,this.lineIdx=0,this.lineOffsets=[0],this.linePosOffset=0,this.refMap={},this.refLinkCandidateMap={},this.refDefCandidateMap={},this.options=t}return n.prototype.sourcepos=function(t,e){var r=this.linePosOffset+this.lineOffsets[this.lineIdx],i=this.lineStartNum+this.lineIdx,o=[i,t+r];return typeof e=="number"?[o,[i,e+r]]:o},n.prototype.nextLine=function(){this.lineIdx+=1,this.linePosOffset=-this.pos},n.prototype.match=function(t){var e=t.exec(this.subject.slice(this.pos));return e===null?null:(this.pos+=e.index+e[0].length,e[0])},n.prototype.peek=function(){return this.pos<this.subject.length?this.subject.charCodeAt(this.pos):-1},n.prototype.spnl=function(){return this.match(Eg),!0},n.prototype.parseBackticks=function(t){var e=this.pos+1,r=this.match(bg);if(r===null)return!1;for(var i,o=this.pos;(i=this.match(yg))!==null;)if(i===r){var s=this.subject.slice(o,this.pos-r.length),a=this.sourcepos(e,this.pos),l=s.split(`
`);if(l.length>1){var c=_o(l);this.lineIdx+=l.length-1,this.linePosOffset=-(this.pos-c.length-r.length),a[1]=this.sourcepos(this.pos),s=l.join(" ")}var u=Et("code",a);return s.length>0&&s.match(/[^ ]/)!==null&&s[0]==" "&&s[s.length-1]==" "?u.literal=s.slice(1,s.length-1):u.literal=s,u.tickCount=r.length,t.appendChild(u),!0}return this.pos=o,t.appendChild(Bt(r,this.sourcepos(e,this.pos-1))),!0},n.prototype.parseBackslash=function(t){var e,r=this.subject;this.pos+=1;var i=this.pos;return this.peek()===10?(this.pos+=1,e=Et("linebreak",this.sourcepos(this.pos-1,this.pos)),t.appendChild(e),this.nextLine()):ld.test(r.charAt(this.pos))?(t.appendChild(Bt(r.charAt(this.pos),this.sourcepos(i,this.pos))),this.pos+=1):t.appendChild(Bt("\\",this.sourcepos(i,i))),!0},n.prototype.parseAutolink=function(t){var e,r,i,o=this.pos+1;return(e=this.match(xg))?(r=e.slice(1,e.length-1),(i=Et("link",this.sourcepos(o,this.pos))).destination=Ho("mailto:"+r),i.title="",i.appendChild(Bt(r,this.sourcepos(o+1,this.pos-1))),t.appendChild(i),!0):!!(e=this.match(Cg))&&(r=e.slice(1,e.length-1),(i=Et("link",this.sourcepos(o,this.pos))).destination=Ho(r),i.title="",i.appendChild(Bt(r,this.sourcepos(o+1,this.pos-1))),t.appendChild(i),!0)},n.prototype.parseHtmlTag=function(t){var e=this.pos+1,r=this.match(cg);if(r===null)return!1;var i=Et("htmlInline",this.sourcepos(e,this.pos));return i.literal=r,t.appendChild(i),!0},n.prototype.scanDelims=function(t){var e=0,r=this.pos;if(t===Gr||t===Jr)e++,this.pos++;else for(;this.peek()===t;)e++,this.pos++;if(e===0||e<2&&(t===Fa||t===Yr))return this.pos=r,null;var i,o=r===0?`
`:this.subject.charAt(r-1),s=this.peek();i=s===-1?`
`:Pa(s);var a,l,c=cd.test(i),u=ad.test(i),d=cd.test(o),p=ad.test(o),h=!c&&(!u||d||p),f=!d&&(!p||c||u);return t===95?(a=h&&(!f||p),l=f&&(!h||u)):t===Gr||t===Jr?(a=h&&!f,l=f):t===Yr?(a=!c,l=!d):(a=h,l=f),this.pos=r,{numdelims:e,canOpen:a,canClose:l}},n.prototype.handleDelim=function(t,e){var r=this.scanDelims(t);if(!r)return!1;var i=r.numdelims,o=this.pos+1;this.pos+=i;var s=Bt(t===Gr?"":t===Jr?"":this.subject.slice(o-1,this.pos),this.sourcepos(o,this.pos));return e.appendChild(s),(r.canOpen||r.canClose)&&(this.options.smart||t!==Gr&&t!==Jr)&&(this.delimiters={cc:t,numdelims:i,origdelims:i,node:s,previous:this.delimiters,next:null,canOpen:r.canOpen,canClose:r.canClose},this.delimiters.previous&&(this.delimiters.previous.next=this.delimiters)),!0},n.prototype.removeDelimiter=function(t){t.previous!==null&&(t.previous.next=t.next),t.next===null?this.delimiters=t.previous:t.next.previous=t.previous},n.prototype.removeDelimitersBetween=function(t,e){t.next!==e&&(t.next=e,e.previous=t)},n.prototype.processEmphasis=function(t){var e,r,i,o,s,a,l,c=!1,u=((e={})[95]=[t,t,t],e[42]=[t,t,t],e[39]=[t],e[34]=[t],e[126]=[t],e[36]=[t],e);for(i=this.delimiters;i!==null&&i.previous!==t;)i=i.previous;for(;i!==null;){var d=i.cc,p=d===95||d===42;if(i.canClose){for(r=i.previous,l=!1;r!==null&&r!==t&&r!==u[d][p?i.origdelims%3:0];){if(c=p&&(i.canOpen||r.canClose)&&i.origdelims%3!=0&&(r.origdelims+i.origdelims)%3==0,r.cc===i.cc&&r.canOpen&&!c){l=!0;break}r=r.previous}if(o=i,p||d===Fa||d===Yr)if(l){if(r){var h=i.numdelims>=2&&r.numdelims>=2?2:1,f=p?0:1;s=r.node,a=i.node;var m=p?h===1?"emph":"strong":"strike";d===Yr&&(m="customInline");var g=Et(m),w=s.sourcepos[1],C=a.sourcepos[0];g.sourcepos=[[w[0],w[1]-h+1],[C[0],C[1]+h-1]],s.sourcepos[1][1]-=h,a.sourcepos[0][1]+=h,s.literal=s.literal.slice(h),a.literal=a.literal.slice(h),r.numdelims-=h,i.numdelims-=h;for(var E=s.next,L=void 0;E&&E!==a;)L=E.next,E.unlink(),g.appendChild(E),E=L;if(d===Yr){var P=g.firstChild,A=P.literal||"",H=A.split(/\s/)[0];g.info=H,A.length<=H.length?P.unlink():(P.sourcepos[0][1]+=H.length,P.literal=A.replace(H+" ",""))}if(s.insertAfter(g),this.removeDelimitersBetween(r,i),r.numdelims<=f&&(r.numdelims===0&&s.unlink(),this.removeDelimiter(r)),i.numdelims<=f){i.numdelims===0&&a.unlink();var B=i.next;this.removeDelimiter(i),i=B}}}else i=i.next;else d===Gr?(i.node.literal="",l&&(r.node.literal=""),i=i.next):d===Jr&&(i.node.literal="",l&&(r.node.literal=""),i=i.next);l||(u[d][p?o.origdelims%3:0]=o.previous,o.canOpen||this.removeDelimiter(o))}else i=i.next}for(;this.delimiters!==null&&this.delimiters!==t;)this.removeDelimiter(this.delimiters)},n.prototype.parseLinkTitle=function(){var t=this.match(mg);return t===null?null:Bi(t.substr(1,t.length-2))},n.prototype.parseLinkDestination=function(){var t=this.match(gg);if(t===null){if(this.peek()===60)return null;for(var e=this.pos,r=0,i=void 0;(i=this.peek())!==-1;)if(i===92&&ld.test(this.subject.charAt(this.pos+1)))this.pos+=1,this.peek()!==-1&&(this.pos+=1);else if(i===40)this.pos+=1,r+=1;else if(i===41){if(r<1)break;this.pos+=1,r-=1}else{if(Ha.exec(Pa(i))!==null)break;this.pos+=1}return this.pos===e&&i!==41||r!==0?null:Ho(Bi(t=this.subject.substr(e,this.pos-e)))}return Ho(Bi(t.substr(1,t.length-2)))},n.prototype.parseLinkLabel=function(){var t=this.match(Mg);return t===null||t.length>1001?0:t.length},n.prototype.parseOpenBracket=function(t){var e=this.pos;this.pos+=1;var r=Bt("[",this.sourcepos(this.pos,this.pos));return t.appendChild(r),this.addBracket(r,e,!1),!0},n.prototype.parseBang=function(t){var e=this.pos;if(this.pos+=1,this.peek()===91){this.pos+=1;var r=Bt("![",this.sourcepos(this.pos-1,this.pos));t.appendChild(r),this.addBracket(r,e+1,!0)}else r=Bt("!",this.sourcepos(this.pos,this.pos)),t.appendChild(r);return!0},n.prototype.parseCloseBracket=function(t){var e=null,r=null,i=!1;this.pos+=1;var o=this.pos,s=this.brackets;if(s===null)return t.appendChild(Bt("]",this.sourcepos(o,o))),!0;if(!s.active)return t.appendChild(Bt("]",this.sourcepos(o,o))),this.removeBracket(),!0;var a=s.image,l=this.pos;this.peek()===40&&(this.pos++,this.spnl()&&(e=this.parseLinkDestination())!==null&&this.spnl()&&(Ha.test(this.subject.charAt(this.pos-1))&&(r=this.parseLinkTitle()),1)&&this.spnl()&&this.peek()===41?(this.pos+=1,i=!0):this.pos=l);var c="";if(!i){var u=this.pos,d=this.parseLinkLabel();if(d>2?c=this.subject.slice(u,u+d):s.bracketAfter||(c=this.subject.slice(s.index,o)),d===0&&(this.pos=l),c){c=sd(c);var p=this.refMap[c];p&&(e=p.destination,r=p.title,i=!0)}}if(i){var h=Et(a?"image":"link");h.destination=e,h.title=r||"",h.sourcepos=[s.startpos,this.sourcepos(this.pos)];for(var f=s.node.next,m=void 0;f;)m=f.next,f.unlink(),h.appendChild(f),f=m;if(t.appendChild(h),this.processEmphasis(s.previousDelimiter),this.removeBracket(),s.node.unlink(),!a)for(s=this.brackets;s!==null;)s.image||(s.active=!1),s=s.previous;return this.options.referenceDefinition&&(this.refLinkCandidateMap[t.id]={node:t,refLabel:c}),!0}return this.removeBracket(),this.pos=o,t.appendChild(Bt("]",this.sourcepos(o,o))),this.options.referenceDefinition&&(this.refLinkCandidateMap[t.id]={node:t,refLabel:c}),!0},n.prototype.addBracket=function(t,e,r){this.brackets!==null&&(this.brackets.bracketAfter=!0),this.brackets={node:t,startpos:this.sourcepos(e+(r?0:1)),previous:this.brackets,previousDelimiter:this.delimiters,index:e,image:r,active:!0}},n.prototype.removeBracket=function(){this.brackets&&(this.brackets=this.brackets.previous)},n.prototype.parseEntity=function(t){var e,r=this.pos+1;return!!(e=this.match(vg))&&(t.appendChild(Bt(Sa.decodeHTML(e),this.sourcepos(r,this.pos))),!0)},n.prototype.parseString=function(t){var e,r=this.pos+1;if(e=this.match(Ig)){if(this.options.smart){var i=e.replace(wg,"").replace(kg,function(s){var a=0,l=0;return s.length%3==0?l=s.length/3:s.length%2==0?a=s.length/2:s.length%3==2?(a=1,l=(s.length-2)/3):(a=2,l=(s.length-4)/3),La("",l)+La("",a)});t.appendChild(Bt(i,this.sourcepos(r,this.pos)))}else{var o=Bt(e,this.sourcepos(r,this.pos));t.appendChild(o)}return!0}return!1},n.prototype.parseNewline=function(t){this.pos+=1;var e=t.lastChild;if(e&&e.type==="text"&&e.literal[e.literal.length-1]===" "){var r=e.literal[e.literal.length-2]===" ",i=e.literal.length;e.literal=e.literal.replace(Tg,"");var o=i-e.literal.length;e.sourcepos[1][1]-=o,t.appendChild(Et(r?"linebreak":"softbreak",this.sourcepos(this.pos-o,this.pos)))}else t.appendChild(Et("softbreak",this.sourcepos(this.pos,this.pos)));return this.nextLine(),this.match(Sg),!0},n.prototype.parseReference=function(t,e){if(!this.options.referenceDefinition)return 0;this.subject=t.stringContent,this.pos=0;var r=null,i=this.pos,o=this.parseLinkLabel();if(o===0)return 0;var s=this.subject.substr(0,o);if(this.peek()!==58)return this.pos=i,0;this.pos++,this.spnl();var a=this.parseLinkDestination();if(a===null)return this.pos=i,0;var l=this.pos;this.spnl(),this.pos!==l&&(r=this.parseLinkTitle()),r===null&&(r="",this.pos=l);var c=!0;if(this.match(ud)===null&&(r===""?c=!1:(r="",this.pos=l,c=this.match(ud)!==null)),!c)return this.pos=i,0;var u=sd(s);if(u==="")return this.pos=i,0;var d=this.getReferenceDefSourcepos(t);t.sourcepos[0][0]=d[1][0]+1;var p=Et("refDef",d);return p.title=r,p.dest=a,p.label=u,t.insertBefore(p),e[u]?this.refDefCandidateMap[p.id]=p:e[u]=Va(p),this.pos-i},n.prototype.mergeTextNodes=function(t){for(var e,r=[];e=t.next();){var i=e.entering,o=e.node;if(i&&o.type==="text")r.push(o);else if(r.length===1)r=[];else if(r.length>1){var s=r[0],a=r[r.length-1];s.sourcepos&&a.sourcepos&&(s.sourcepos[1]=a.sourcepos[1]),s.next=a.next,s.next&&(s.next.prev=s);for(var l=1;l<r.length;l+=1)s.literal+=r[l].literal,r[l].unlink();r=[]}}},n.prototype.getReferenceDefSourcepos=function(t){for(var e=t.stringContent.split(/\n|\r\n/),r=!1,i=0,o={line:0,ch:0},s=0;s<e.length;s+=1){var a=e[s];if(Ha.test(a))break;if(/\:/.test(a)&&i===0){if(r)break;var l=a.indexOf(":")===a.length-1?s+1:s;o={line:l,ch:e[l].length},r=!0}var c=a.match(/'|"/g);if(c&&(i+=c.length),i===2){o={line:s,ch:a.length};break}}return[[t.sourcepos[0][0],t.sourcepos[0][1]],[t.sourcepos[0][0]+o.line,o.ch]]},n.prototype.parseInline=function(t){var e,r=!1,i=this.peek();if(i===-1)return!1;switch(i){case 10:r=this.parseNewline(t);break;case 92:r=this.parseBackslash(t);break;case 96:r=this.parseBackticks(t);break;case 42:case 95:case Fa:case Yr:r=this.handleDelim(i,t);break;case Gr:case Jr:r=!!(!((e=this.options)===null||e===void 0)&&e.smart)&&this.handleDelim(i,t);break;case 91:r=this.parseOpenBracket(t);break;case 33:r=this.parseBang(t);break;case 93:r=this.parseCloseBracket(t);break;case 60:r=this.parseAutolink(t)||this.parseHtmlTag(t);break;case 38:t.disabledEntityParse||(r=this.parseEntity(t));break;default:r=this.parseString(t)}return r||(this.pos+=1,t.appendChild(Bt(Pa(i),this.sourcepos(this.pos,this.pos+1)))),!0},n.prototype.parse=function(t){for(this.subject=t.stringContent.trim(),this.pos=0,this.delimiters=null,this.brackets=null,this.lineOffsets=t.lineOffsets||[0],this.lineIdx=0,this.linePosOffset=0,this.lineStartNum=t.sourcepos[0][0],function(c){return c.type==="heading"}(t)&&(this.lineOffsets[0]+=t.level+1);this.parseInline(t););t.stringContent=null,this.processEmphasis(null),this.mergeTextNodes(t.walker());var e=this.options,r=e.extendedAutolinks,i=e.customParser;if(r&&function(c,u){var d;typeof u=="boolean"&&(u=fg);for(var p=function(){var h=d.entering,f=d.node;if(h&&f.type==="text"&&f.parent.type!=="link"){var m=f.literal,g=u(m);if(!g||!g.length)return"continue";for(var w=0,C=f.sourcepos[0],E=C[0],L=C[1],P=function(ne,ft){return[[E,L+ne],[E,L+ft]]},A=[],H=0,B=g;H<B.length;H++){var z=B[H],q=z.range,_=z.url,Y=z.text;q[0]>w&&A.push(Bt(m.substring(w,q[0]),P(w,q[0]-1)));var K=Et("link",P.apply(void 0,q));K.appendChild(Bt(Y,P.apply(void 0,q))),K.destination=_,K.extendedAutolink=!0,A.push(K),w=q[1]+1}w<m.length&&A.push(Bt(m.substring(w),P(w,m.length-1)));for(var ot=0,pt=A;ot<pt.length;ot++){var Tt=pt[ot];f.insertBefore(Tt)}f.unlink()}};d=c.next();)p()}(t.walker(),r),i&&t.firstChild)for(var o,s=t.firstChild.walker();o=s.next();){var a=o.node,l=o.entering;i[a.type]&&i[a.type](a,{entering:l,options:this.options})}},n}(),Og=/^\[([ \txX])\][ \t]+/,dd=/[^ \t\f\v\r\n]/,Lg=/^(?:`{3,}|~{3,})(?= *$)/;function pd(n){for(var t=n;t;){if(t.lastLineBlank)return!0;var e=t.type;if(t.lastLineChecked||e!=="list"&&e!=="item"){t.lastLineChecked=!0;break}t.lastLineChecked=!0,t=t.lastChild}return!1}function ke(n,t){return t<n.length?n.charCodeAt(t):-1}function hd(n){return!dd.test(n)}function Qr(n){return n===32||n===9}var Ag=/^\$\$$/,Dg={continue:function(n,t){var e=n.currentLine,r=e.match(Ag);if(r)return n.lastLineLength=r[0].length,n.finalize(t,n.lineNumber),2;for(var i=t.offset;i>0&&Qr(ke(e,n.offset));)n.advanceOffset(1,!0),i--;return 0},finalize:function(n,t){if(t.stringContent!==null){var e=t.stringContent,r=e.indexOf(`
`),i=e.slice(0,r),o=e.slice(r+1),s=i.match(/^(\s*)(.*)/);t.info=Bi(s[2].trim()),t.literal=o,t.stringContent=null}},canContain:function(){return!1},acceptsLines:!0},fd={continue:function(){return 1},finalize:function(){},canContain:function(){return!1},acceptsLines:!0},Rg={continue:function(){return 0},finalize:function(n,t){for(var e=t.firstChild;e;){if(pd(e)&&e.next){t.listData.tight=!1;break}for(var r=e.firstChild;r;){if(pd(r)&&(e.next||r.next)){t.listData.tight=!1;break}r=r.next}e=e.next}},canContain:function(n){return n==="item"},acceptsLines:!1},Pg={continue:function(n,t){if(n.blank){if(t.firstChild===null)return 1;n.advanceNextNonspace()}else{if(!(n.indent>=t.listData.markerOffset+t.listData.padding))return 1;n.advanceOffset(t.listData.markerOffset+t.listData.padding,!0)}return 0},finalize:function(n,t){if(t.firstChild&&t.firstChild.type==="paragraph"){var e=t.firstChild,r=e.stringContent.match(Og);if(r){var i=r[0].length;e.stringContent=e.stringContent.substring(i-1),e.sourcepos[0][1]+=i,e.lineOffsets[0]+=i,t.listData.task=!0,t.listData.checked=/[xX]/.test(r[1])}}},canContain:function(n){return n!=="item"},acceptsLines:!1},Fg={continue:function(n,t){var e=n.currentLine,r=n.indent;if(t.isFenced){var i=r<=3&&e.charAt(n.nextNonspace)===t.fenceChar&&e.slice(n.nextNonspace).match(Lg);if(i&&i[0].length>=t.fenceLength)return n.lastLineLength=n.offset+r+i[0].length,n.finalize(t,n.lineNumber),2;for(var o=t.fenceOffset;o>0&&Qr(ke(e,n.offset));)n.advanceOffset(1,!0),o--}else if(r>=4)n.advanceOffset(4,!0);else{if(!n.blank)return 1;n.advanceNextNonspace()}return 0},finalize:function(n,t){var e;if(t.stringContent!==null){if(t.isFenced){var r=t.stringContent,i=r.indexOf(`
`),o=r.slice(0,i),s=r.slice(i+1),a=o.match(/^(\s*)(.*)/);t.infoPadding=a[1].length,t.info=Bi(a[2].trim()),t.literal=s}else t.literal=(e=t.stringContent)===null||e===void 0?void 0:e.replace(/(\n *)+$/,`
`);t.stringContent=null}},canContain:function(){return!1},acceptsLines:!0},Bg={continue:function(n){return n.blank?1:0},finalize:function(n,t){if(t.stringContent!==null){for(var e,r=!1;ke(t.stringContent,0)===91&&(e=n.inlineParser.parseReference(t,n.refMap));)t.stringContent=t.stringContent.slice(e),r=!0;r&&hd(t.stringContent)&&t.unlink()}},canContain:function(){return!1},acceptsLines:!0},Xr={document:{continue:function(){return 0},finalize:function(){},canContain:function(n){return n!=="item"},acceptsLines:!1},list:Rg,blockQuote:{continue:function(n){var t=n.currentLine;return n.indented||ke(t,n.nextNonspace)!==62?1:(n.advanceNextNonspace(),n.advanceOffset(1,!1),Qr(ke(t,n.offset))&&n.advanceOffset(1,!0),0)},finalize:function(){},canContain:function(n){return n!=="item"},acceptsLines:!1},item:Pg,heading:{continue:function(){return 1},finalize:function(){},canContain:function(){return!1},acceptsLines:!1},thematicBreak:{continue:function(){return 1},finalize:function(){},canContain:function(){return!1},acceptsLines:!1},codeBlock:Fg,htmlBlock:{continue:function(n,t){return!n.blank||t.htmlBlockType!==6&&t.htmlBlockType!==7?0:1},finalize:function(n,t){var e;t.literal=((e=t.stringContent)===null||e===void 0?void 0:e.replace(/(\n *)+$/,""))||null,t.stringContent=null},canContain:function(){return!1},acceptsLines:!0},paragraph:Bg,table:{continue:function(){return 0},finalize:function(){},canContain:function(n){return n==="tableHead"||n==="tableBody"},acceptsLines:!1},tableBody:{continue:function(){return 0},finalize:function(){},canContain:function(n){return n==="tableRow"},acceptsLines:!1},tableHead:{continue:function(){return 1},finalize:function(){},canContain:function(n){return n==="tableRow"||n==="tableDelimRow"},acceptsLines:!1},tableRow:{continue:function(){return 1},finalize:function(){},canContain:function(n){return n==="tableCell"},acceptsLines:!1},tableCell:{continue:function(){return 1},finalize:function(){},canContain:function(){return!1},acceptsLines:!1},tableDelimRow:{continue:function(){return 1},finalize:function(){},canContain:function(n){return n==="tableDelimCell"},acceptsLines:!1},tableDelimCell:{continue:function(){return 1},finalize:function(){},canContain:function(){return!1},acceptsLines:!1},refDef:fd,customBlock:Dg,frontMatter:fd};function za(n){for(var t=0,e=0,r=[],i=0;i<n.length;i+=1)if(n[i]==="|"&&n[i-1]!=="\\"){var o=n.substring(t,i);t===0&&ed(o)?e=i+1:r.push(o),t=i+1}return t<n.length&&(ed(o=n.substring(t,n.length))||r.push(o)),[e,r]}function _a(n,t,e,r){for(var i=[],o=0,s=t;o<s.length;o++){var a=s[o],l=a.match(/^[ \t]+/),c=l?l[0].length:0,u=void 0,d=void 0;if(c===a.length)c=0,u=0,d="";else{var p=a.match(/[ \t]+$/);u=p?p[0].length:0,d=a.slice(c,a.length-u)}var h=r+c,f=Et(n,[[e,r],[e,r+a.length-1]]);f.stringContent=d.replace(/\\\|/g,"|"),f.startIdx=i.length,f.endIdx=i.length,f.lineOffsets=[h-1],f.paddingLeft=c,f.paddingRight=u,i.push(f),r+=a.length+1}return i}function Hg(n){var t=null,e=n.stringContent,r=e[0];return e[e.length-1]===":"?t=r===":"?"center":"right":r===":"&&(t="left"),{align:t}}var zg=/^(\$\$)(\s*[a-zA-Z])+/,_g=/^(\$\$)(\s*[a-zA-Z])+.*(\$\$)/,qg=/^`{3,}(?!.*`)|^~{3,}/,$g=[/./,/^<(?:script|pre|style)(?:\s|>|$)/i,/^<!--/,/^<[?]/,/^<![A-Z]/,/^<!\[CDATA\[/,/^<[/]?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[123456]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|[/]?[>]|$)/i,new RegExp("^(?:"+ag+"|"+lg+")\\s*$","i")],jg=/^(?:=+|-+)[ \t]*$/,Vg=/^#{1,6}(?:[ \t]+|$)/,Ug=/^(?:(?:\*[ \t]*){3,}|(?:_[ \t]*){3,}|(?:-[ \t]*){3,})[ \t]*$/,md=/^[*+-]/,gd=/^(\d{1,9})([.)])/;function vd(n,t){return n.options.disallowDeepHeading&&(t.type==="blockQuote"||t.type==="item")}var qa=[function(n){return n.indented||ke(n.currentLine,n.nextNonspace)!==62?0:(n.advanceNextNonspace(),n.advanceOffset(1,!1),Qr(ke(n.currentLine,n.offset))&&n.advanceOffset(1,!0),n.closeUnmatchedBlocks(),n.addChild("blockQuote",n.nextNonspace),1)},function(n,t){var e;if(!n.indented&&!vd(n,t)&&(e=n.currentLine.slice(n.nextNonspace).match(Vg))){n.advanceNextNonspace(),n.advanceOffset(e[0].length,!1),n.closeUnmatchedBlocks();var r=n.addChild("heading",n.nextNonspace);return r.level=e[0].trim().length,r.headingType="atx",r.stringContent=n.currentLine.slice(n.offset).replace(/^[ \t]*#+[ \t]*$/,"").replace(/[ \t]+#+[ \t]*$/,""),n.advanceOffset(n.currentLine.length-n.offset),2}return 0},function(n){var t;if(!n.indented&&(t=n.currentLine.slice(n.nextNonspace).match(qg))){var e=t[0].length;n.closeUnmatchedBlocks();var r=n.addChild("codeBlock",n.nextNonspace);return r.isFenced=!0,r.fenceLength=e,r.fenceChar=t[0][0],r.fenceOffset=n.indent,n.advanceNextNonspace(),n.advanceOffset(e,!1),2}return 0},function(n,t){if(!n.indented&&ke(n.currentLine,n.nextNonspace)===60){var e=n.currentLine.slice(n.nextNonspace),r=n.options.disallowedHtmlBlockTags,i=void 0;for(i=1;i<=7;i++){var o=e.match($g[i]);if(o)return i===7&&(t.type==="paragraph"||r.length>0&&new RegExp("</?(?:"+r.join("|")+")","i").test(o[0]))?0:(n.closeUnmatchedBlocks(),n.addChild("htmlBlock",n.offset).htmlBlockType=i,2)}}return 0},function(n,t){var e;if(t.stringContent!==null&&!n.indented&&t.type==="paragraph"&&!vd(n,t.parent)&&(e=n.currentLine.slice(n.nextNonspace).match(jg))){n.closeUnmatchedBlocks();for(var r=void 0;ke(t.stringContent,0)===91&&(r=n.inlineParser.parseReference(t,n.refMap));)t.stringContent=t.stringContent.slice(r);if(t.stringContent.length>0){var i=Et("heading",t.sourcepos);return i.level=e[0][0]==="="?1:2,i.headingType="setext",i.stringContent=t.stringContent,t.insertAfter(i),t.unlink(),n.tip=i,n.advanceOffset(n.currentLine.length-n.offset,!1),2}return 0}return 0},function(n){return!n.indented&&Ug.test(n.currentLine.slice(n.nextNonspace))?(n.closeUnmatchedBlocks(),n.addChild("thematicBreak",n.nextNonspace),n.advanceOffset(n.currentLine.length-n.offset,!1),2):0},function(n,t){var e,r,i,o=t;return n.indented&&t.type!=="list"||!(e=function(s,a){var l,c,u=s.currentLine.slice(s.nextNonspace),d={type:"bullet",tight:!0,bulletChar:"",start:0,delimiter:"",padding:0,markerOffset:s.indent,task:!1,checked:!1};if(s.indent>=4)return null;if(l=u.match(md))d.type="bullet",d.bulletChar=l[0][0];else{if(!(l=u.match(gd))||a.type==="paragraph"&&l[1]!=="1")return null;d.type="ordered",d.start=parseInt(l[1],10),d.delimiter=l[2]}if((c=ke(s.currentLine,s.nextNonspace+l[0].length))!==-1&&c!==9&&c!==32||a.type==="paragraph"&&!s.currentLine.slice(s.nextNonspace+l[0].length).match(dd))return null;s.advanceNextNonspace(),s.advanceOffset(l[0].length,!0);var p=s.column,h=s.offset;do s.advanceOffset(1,!0),c=ke(s.currentLine,s.offset);while(s.column-p<5&&Qr(c));var f=ke(s.currentLine,s.offset)===-1,m=s.column-p;return m>=5||m<1||f?(d.padding=l[0].length+1,s.column=p,s.offset=h,Qr(ke(s.currentLine,s.offset))&&s.advanceOffset(1,!0)):d.padding=l[0].length+m,d}(n,o))?0:(n.closeUnmatchedBlocks(),n.tip.type==="list"&&(r=o.listData,i=e,r.type===i.type&&r.delimiter===i.delimiter&&r.bulletChar===i.bulletChar)||((o=n.addChild("list",n.nextNonspace)).listData=e),(o=n.addChild("item",n.nextNonspace)).listData=e,1)},function(n){return n.indented&&n.tip.type!=="paragraph"&&!n.blank?(n.advanceOffset(4,!0),n.closeUnmatchedBlocks(),n.addChild("codeBlock",n.offset),2):0},function(n,t){var e=t.stringContent;if(t.type==="paragraph"&&!n.indented&&!n.blank){var r=e.length-1,i=e.lastIndexOf(`
`,r-1)+1,o=e.slice(i,r),s=n.currentLine.slice(n.nextNonspace),a=za(o),l=a[0],c=a[1],u=za(s),d=u[0],p=u[1],h=/^[ \t]*:?-+:?[ \t]*$/;if(!c.length||!p.length||p.some(function(H){return!h.test(H)})||p.length===1&&s.indexOf("|")!==0)return 0;var f=t.lineOffsets,m=n.lineNumber-1,g=_o(f)+1,w=Et("table",[[m,g],[n.lineNumber,n.offset]]);if(w.columns=p.map(function(){return{align:null}}),t.insertAfter(w),f.length===1)t.unlink();else{t.stringContent=e.slice(0,i);var C=i-(e.lastIndexOf(`
`,i-2)+1)-1;n.lastLineLength=f[f.length-2]+C,n.finalize(t,m-1)}n.advanceOffset(n.currentLine.length-n.offset,!1);var E=Et("tableHead",[[m,g],[n.lineNumber,n.offset]]);w.appendChild(E);var L=Et("tableRow",[[m,g],[m,g+o.length-1]]),P=Et("tableDelimRow",[[n.lineNumber,n.nextNonspace+1],[n.lineNumber,n.offset]]);E.appendChild(L),E.appendChild(P),_a("tableCell",c,m,g+l).forEach(function(H){L.appendChild(H)});var A=_a("tableDelimCell",p,n.lineNumber,n.nextNonspace+1+d);return A.forEach(function(H){P.appendChild(H)}),w.columns=A.map(Hg),n.tip=w,2}return 0},function(n,t){if(t.type!=="table"&&t.type!=="tableBody"||!n.blank&&n.currentLine.indexOf("|")===-1)return 0;if(n.advanceOffset(n.currentLine.length-n.offset,!1),n.blank){var e=t;return t.type==="tableBody"&&(e=t.parent,n.finalize(t,n.lineNumber-1)),n.finalize(e,n.lineNumber-1),0}var r=t;t.type==="table"&&((r=n.addChild("tableBody",n.nextNonspace)).stringContent=null);var i=Et("tableRow",[[n.lineNumber,n.nextNonspace+1],[n.lineNumber,n.currentLine.length]]);r.appendChild(i);var o=r.parent,s=za(n.currentLine.slice(n.nextNonspace)),a=s[0];return _a("tableCell",s[1],n.lineNumber,n.nextNonspace+1+a).forEach(function(l,c){c>=o.columns.length&&(l.ignored=!0),i.appendChild(l)}),2},function(n){var t;if(!n.indented&&!_g.test(n.currentLine)&&(t=n.currentLine.match(zg))){var e=t[1].length;n.closeUnmatchedBlocks();var r=n.addChild("customBlock",n.nextNonspace);return r.syntaxLength=e,r.offset=n.indent,n.advanceNextNonspace(),n.advanceOffset(e,!1),2}return 0}],yd=/^(-{3}|\+{3}|;{3})$/,Wg=function(n,t){var e=n.currentLine,r=n.lineNumber,i=n.indented;return r===1&&!i&&t.type==="document"&&yd.test(e)?(n.closeUnmatchedBlocks(),n.addChild("frontMatter",n.nextNonspace).stringContent=e,n.advanceNextNonspace(),n.advanceOffset(e.length,!1),2):0},Kg={continue:function(n,t){var e=n.currentLine,r=e.match(yd);return t.type==="frontMatter"&&r?(t.stringContent+=e,n.lastLineLength=r[0].length,n.finalize(t,n.lineNumber),2):0},finalize:function(n,t){t.stringContent!==null&&(t.literal=t.stringContent,t.stringContent=null)},canContain:function(){return!1},acceptsLines:!0},Gg=[/./,/<\/(?:script|pre|style)>/i,/-->/,/\?>/,/>/,/\]\]>/],Jg=/^[#`~*+_=<>0-9-;$]/,Yg=/\r\n|\n|\r/;function $a(){return Et("document",[[1,1],[0,0]])}var Qg={smart:!1,tagFilter:!1,extendedAutolinks:!1,disallowedHtmlBlockTags:[],referenceDefinition:!1,disallowDeepHeading:!1,customParser:null,frontMatter:!1},Xg=function(){function n(t){this.options=Yt(Yt({},Qg),t),this.doc=$a(),this.tip=this.doc,this.oldtip=this.doc,this.lineNumber=0,this.offset=0,this.column=0,this.nextNonspace=0,this.nextNonspaceColumn=0,this.indent=0,this.currentLine="",this.indented=!1,this.blank=!1,this.partiallyConsumedTab=!1,this.allClosed=!0,this.lastMatchedContainer=this.doc,this.refMap={},this.refLinkCandidateMap={},this.refDefCandidateMap={},this.lastLineLength=0,this.lines=[],this.options.frontMatter&&(Xr.frontMatter=Kg,qa.unshift(Wg)),this.inlineParser=new Ng(this.options)}return n.prototype.advanceOffset=function(t,e){e===void 0&&(e=!1);for(var r,i,o,s=this.currentLine;t>0&&(o=s[this.offset]);)o==="	"?(r=4-this.column%4,e?(this.partiallyConsumedTab=r>t,i=r>t?t:r,this.column+=i,this.offset+=this.partiallyConsumedTab?0:1,t-=i):(this.partiallyConsumedTab=!1,this.column+=r,this.offset+=1,t-=1)):(this.partiallyConsumedTab=!1,this.offset+=1,this.column+=1,t-=1)},n.prototype.advanceNextNonspace=function(){this.offset=this.nextNonspace,this.column=this.nextNonspaceColumn,this.partiallyConsumedTab=!1},n.prototype.findNextNonspace=function(){for(var t,e=this.currentLine,r=this.offset,i=this.column;(t=e.charAt(r))!=="";)if(t===" ")r++,i++;else{if(t!=="	")break;r++,i+=4-i%4}this.blank=t===`
`||t==="\r"||t==="",this.nextNonspace=r,this.nextNonspaceColumn=i,this.indent=this.nextNonspaceColumn-this.column,this.indented=this.indent>=4},n.prototype.addLine=function(){if(this.partiallyConsumedTab){this.offset+=1;var t=4-this.column%4;this.tip.stringContent+=La(" ",t)}this.tip.lineOffsets?this.tip.lineOffsets.push(this.offset):this.tip.lineOffsets=[this.offset],this.tip.stringContent+=this.currentLine.slice(this.offset)+`
`},n.prototype.addChild=function(t,e){for(;!Xr[this.tip.type].canContain(t);)this.finalize(this.tip,this.lineNumber-1);var r=e+1,i=Et(t,[[this.lineNumber,r],[0,0]]);return i.stringContent="",this.tip.appendChild(i),this.tip=i,i},n.prototype.closeUnmatchedBlocks=function(){if(!this.allClosed){for(;this.oldtip!==this.lastMatchedContainer;){var t=this.oldtip.parent;this.finalize(this.oldtip,this.lineNumber-1),this.oldtip=t}this.allClosed=!0}},n.prototype.finalize=function(t,e){var r=t.parent;t.open=!1,t.sourcepos[1]=[e,this.lastLineLength],Xr[t.type].finalize(this,t),this.tip=r},n.prototype.processInlines=function(t){var e,r=this.options.customParser,i=t.walker();for(this.inlineParser.refMap=this.refMap,this.inlineParser.refLinkCandidateMap=this.refLinkCandidateMap,this.inlineParser.refDefCandidateMap=this.refDefCandidateMap,this.inlineParser.options=this.options;e=i.next();){var o=e.node,s=e.entering,a=o.type;r&&r[a]&&r[a](o,{entering:s,options:this.options}),s||a!=="paragraph"&&a!=="heading"&&(a!=="tableCell"||o.ignored)||this.inlineParser.parse(o)}},n.prototype.incorporateLine=function(t){var e=this.doc;this.oldtip=this.tip,this.offset=0,this.column=0,this.blank=!1,this.partiallyConsumedTab=!1,this.lineNumber+=1,t.indexOf("\0")!==-1&&(t=t.replace(/\0/g,"")),this.currentLine=t;for(var r,i=!0;(r=e.lastChild)&&r.open;){switch(e=r,this.findNextNonspace(),Xr[e.type].continue(this,e)){case 0:break;case 1:i=!1;break;case 2:return void(this.lastLineLength=t.length);default:throw new Error("continue returned illegal value, must be 0, 1, or 2")}if(!i){e=e.parent;break}}this.allClosed=e===this.oldtip,this.lastMatchedContainer=e;for(var o=e.type!=="paragraph"&&Xr[e.type].acceptsLines,s=qa.length;!o;){if(this.findNextNonspace(),e.type!=="table"&&e.type!=="tableBody"&&e.type!=="paragraph"&&!this.indented&&!Jg.test(t.slice(this.nextNonspace))){this.advanceNextNonspace();break}for(var a=0;a<s;){var l=qa[a](this,e);if(l===1){e=this.tip;break}if(l===2){e=this.tip,o=!0;break}a++}if(a===s){this.advanceNextNonspace();break}}if(this.allClosed||this.blank||this.tip.type!=="paragraph"){this.closeUnmatchedBlocks(),this.blank&&e.lastChild&&(e.lastChild.lastLineBlank=!0);for(var c=e.type,u=this.blank&&!(c==="blockQuote"||nd(e)&&e.isFenced||c==="item"&&!e.firstChild&&e.sourcepos[0][0]===this.lineNumber),d=e;d;)d.lastLineBlank=u,d=d.parent;Xr[c].acceptsLines?(this.addLine(),function(p){return p.type==="htmlBlock"}(e)&&e.htmlBlockType>=1&&e.htmlBlockType<=5&&Gg[e.htmlBlockType].test(this.currentLine.slice(this.offset))&&(this.lastLineLength=t.length,this.finalize(e,this.lineNumber))):this.offset<t.length&&!this.blank&&(e=this.addChild("paragraph",this.offset),this.advanceNextNonspace(),this.addLine())}else this.addLine();this.lastLineLength=t.length},n.prototype.parse=function(t,e){this.doc=$a(),this.tip=this.doc,this.lineNumber=0,this.lastLineLength=0,this.offset=0,this.column=0,this.lastMatchedContainer=this.doc,this.currentLine="";var r=t.split(Yg),i=r.length;this.lines=e||r,this.options.referenceDefinition&&this.clearRefMaps(),t.charCodeAt(t.length-1)===10&&(i-=1);for(var o=0;o<i;o++)this.incorporateLine(r[o]);for(;this.tip;)this.finalize(this.tip,i);return this.processInlines(this.doc),this.doc},n.prototype.partialParseStart=function(t,e){this.doc=$a(),this.tip=this.doc,this.lineNumber=t-1,this.lastLineLength=0,this.offset=0,this.column=0,this.lastMatchedContainer=this.doc,this.currentLine="";for(var r=e.length,i=0;i<r;i++)this.incorporateLine(e[i]);return this.doc},n.prototype.partialParseExtends=function(t){for(var e=0;e<t.length;e++)this.incorporateLine(t[e])},n.prototype.partialParseFinish=function(){for(;this.tip;)this.finalize(this.tip,this.lineNumber);this.processInlines(this.doc)},n.prototype.setRefMaps=function(t,e,r){this.refMap=t,this.refLinkCandidateMap=e,this.refDefCandidateMap=r},n.prototype.clearRefMaps=function(){[this.refMap,this.refLinkCandidateMap,this.refDefCandidateMap].forEach(function(t){var e;e=t,Object.keys(e).forEach(function(r){delete e[r]})})},n}();function bd(n,t){return n[0]<t[0]?1:n[0]>t[0]?-1:n[1]<t[1]?1:n[1]>t[1]?-1:0}function Zg(n,t){var e=n[0];return bd(n[1],t)===1?1:bd(e,t)===-1?-1:0}function wd(n,t){for(var e=0,r=t;e<r.length;e++){var i=r[e];n.insertBefore(i)}}function kd(n,t){var e=n[0];return n[1][0]<t?1:e[0]>t?-1:0}function $o(n,t){for(var e=n.firstChild;e;){var r=kd(e.sourcepos,t);if(r===0)return e;if(r===-1)return e.prev||e;e=e.next}return n.lastChild}function xd(n){return function(t){return zo[t]}(n)||null}function ja(n,t,e){if(e===void 0&&(e=null),t)for(var r=t.walker();t&&t!==e;){n(t);var i=r.next();if(!i)break;t=i.node}}var Cd=/\r\n|\n|\r/;function Va(n){return{id:n.id,title:n.title,sourcepos:n.sourcepos,unlinked:!1,destination:n.dest}}var Ed=function(){function n(t,e){this.refMap={},this.refLinkCandidateMap={},this.refDefCandidateMap={},this.referenceDefinition=!!e?.referenceDefinition,this.parser=new Xg(e),this.parser.setRefMaps(this.refMap,this.refLinkCandidateMap,this.refDefCandidateMap),this.eventHandlerMap={change:[]},t=t||"",this.lineTexts=t.split(Cd),this.root=this.parser.parse(t,this.lineTexts)}return n.prototype.updateLineTexts=function(t,e,r){var i,o=t[0],s=t[1],a=e[0],l=e[1],c=r.split(Cd),u=c.length,d=this.lineTexts[o-1],p=this.lineTexts[a-1];c[0]=d.slice(0,s-1)+c[0],c[u-1]=c[u-1]+p.slice(l-1);var h=a-o+1;return(i=this.lineTexts).splice.apply(i,Ta([o-1,h],c)),u-h},n.prototype.updateRootNodeState=function(){if(this.lineTexts.length===1&&this.lineTexts[0]==="")return this.root.lastLineBlank=!0,void(this.root.sourcepos=[[1,1],[1,0]]);this.root.lastChild&&(this.root.lastLineBlank=this.root.lastChild.lastLineBlank);for(var t=this.lineTexts,e=t.length-1;t[e]==="";)e-=1;t.length-2>e&&(e+=1),this.root.sourcepos[1]=[e+1,t[e].length]},n.prototype.replaceRangeNodes=function(t,e,r){t?(wd(t,r),function(i,o){if(i.parent===o.parent&&i!==o){for(var s=i.next;s&&s!==o;){for(var a=s.next,l=0,c=["parent","prev","next"];l<c.length;l++){var u=c[l];s[u]&&(Da(s[u].id),s[u]=null)}s=a}i.next=o.next,o.next?o.next.prev=i:i.parent.lastChild=i}}(t,e),[t.id,e.id].forEach(function(i){return Da(i)}),t.unlink()):e?(wd(e,r),Da(e.id),e.unlink()):function(i,o){for(var s=o.length-1;s>=0;s-=1)i.prependChild(o[s])}(this.root,r)},n.prototype.getNodeRange=function(t,e){var r=$o(this.root,t[0]),i=$o(this.root,e[0]);return i&&i.next&&e[0]+1===i.next.sourcepos[0][0]&&(i=i.next),[r,i]},n.prototype.trigger=function(t,e){this.eventHandlerMap[t].forEach(function(r){r(e)})},n.prototype.extendEndLine=function(t){for(;this.lineTexts[t]==="";)t+=1;return t},n.prototype.parseRange=function(t,e,r,i){var o;t&&t.prev&&(rd(t.prev)&&function(f){var m=f.match(/^[ \t]+/);if(m&&(m[0].length>=2||/\t/.test(m[0])))return!0;var g=m?f.slice(m.length):f;return md.test(g)||gd.test(g)}(this.lineTexts[r-1])||function(f){return f.type==="table"}(t.prev)&&!hd(o=this.lineTexts[r-1])&&o.indexOf("|")!==-1)&&(r=(t=t.prev).sourcepos[0][0]);for(var s=this.lineTexts.slice(r-1,i),a=this.parser.partialParseStart(r,s),l=e?e.next:this.root.firstChild,c=a.lastChild,u=c&&nd(c)&&c.open,d=c&&id(c)&&c.open,p=c&&rd(c);(u||d)&&l||p&&l&&(l.type==="list"||l.sourcepos[0][1]>=2);){var h=this.extendEndLine(l.sourcepos[1][0]);this.parser.partialParseExtends(this.lineTexts.slice(i,h)),t||(t=e),e=l,i=h,l=l.next}return this.parser.partialParseFinish(),{newNodes:function(f){for(var m=[],g=f.firstChild;g;)m.push(g),g=g.next;return m}(a),extStartNode:t,extEndNode:e}},n.prototype.getRemovedNodeRange=function(t,e){return!t||t&&Wr(t)||e&&Wr(e)?null:{id:[t.id,e.id],line:[t.sourcepos[0][0]-1,e.sourcepos[1][0]-1]}},n.prototype.markDeletedRefMap=function(t,e){var r=this;if(!Kr(this.refMap)){var i=function(o){if(Wr(o)){var s=r.refMap[o.label];s&&o.id===s.id&&(s.unlinked=!0)}};t&&ja(i,t.parent,e),e&&ja(i,e)}},n.prototype.replaceWithNewRefDefState=function(t){var e=this;if(!Kr(this.refMap)){var r=function(i){if(Wr(i)){var o=i.label,s=e.refMap[o];s&&!s.unlinked||(e.refMap[o]=Va(i))}};t.forEach(function(i){ja(r,i)})}},n.prototype.replaceWithRefDefCandidate=function(){var t=this;Kr(this.refDefCandidateMap)||qo(this.refDefCandidateMap,function(e,r){var i=r.label,o=r.sourcepos,s=t.refMap[i];(!s||s.unlinked||s.sourcepos[0][0]>o[0][0])&&(t.refMap[i]=Va(r))})},n.prototype.getRangeWithRefDef=function(t,e,r,i,o){if(this.referenceDefinition&&!Kr(this.refMap)){var s=$o(this.root,t-1),a=$o(this.root,e+1);s&&Wr(s)&&s!==r&&s!==i&&(t=(r=s).sourcepos[0][0]),a&&Wr(a)&&a!==r&&a!==i&&(i=a,e=this.extendEndLine(i.sourcepos[1][0]+o))}return[r,i,t,e]},n.prototype.parse=function(t,e,r){r===void 0&&(r=0);var i=this.getNodeRange(t,e),o=i[0],s=i[1],a=o?Math.min(o.sourcepos[0][0],t[0]):t[0],l=this.extendEndLine((s?Math.max(s.sourcepos[1][0],e[0]):e[0])+r),c=this.parseRange.apply(this,this.getRangeWithRefDef(a,l,o,s,r)),u=c.newNodes,d=c.extStartNode,p=c.extEndNode,h=this.getRemovedNodeRange(d,p),f=p?p.next:this.root.firstChild;return this.referenceDefinition?(this.markDeletedRefMap(d,p),this.replaceRangeNodes(d,p,u),this.replaceWithNewRefDefState(u)):this.replaceRangeNodes(d,p,u),{nodes:u,removedNodeRange:h,nextNode:f}},n.prototype.parseRefLink=function(){var t=this,e=[];return Kr(this.refMap)||qo(this.refMap,function(r,i){i.unlinked&&delete t.refMap[r],qo(t.refLinkCandidateMap,function(o,s){var a=s.node;s.refLabel===r&&e.push(t.parse(a.sourcepos[0],a.sourcepos[1]))})}),e},n.prototype.removeUnlinkedCandidate=function(){Kr(this.refDefCandidateMap)||[this.refLinkCandidateMap,this.refDefCandidateMap].forEach(function(t){qo(t,function(e){(function(r){var i=xd(r);if(!i)return!0;for(;i&&i.type!=="document";){if(!i.parent&&!i.prev&&!i.next)return!0;i=i.parent}return!1})(e)&&delete t[e]})})},n.prototype.editMarkdown=function(t,e,r){var i=this.updateLineTexts(t,e,r),o=this.parse(t,e,i),s=function(l){for(var c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];var d=Yt({},l);return c.forEach(function(p){delete d[p]}),d}(o,"nextNode");(function(l,c){if(l&&l.parent&&c!==0){var u,d=l.parent.walker();for(d.resumeAt(l,!0);u=d.next();){var p=u.node;u.entering&&(p.sourcepos[0][0]+=c,p.sourcepos[1][0]+=c)}}})(o.nextNode,i),this.updateRootNodeState();var a=[s];return this.referenceDefinition&&(this.removeUnlinkedCandidate(),this.replaceWithRefDefCandidate(),a=a.concat(this.parseRefLink())),this.trigger("change",a),a},n.prototype.getLineTexts=function(){return this.lineTexts},n.prototype.getRootNode=function(){return this.root},n.prototype.findNodeAtPosition=function(t){var e=function(r,i){for(var o=r,s=null;o;){var a=Zg(o.sourcepos,i);if(a===0){if(!o.firstChild)return o;s=o,o=o.firstChild}else{if(a===-1||!o.next)return s;o=o.next}}return o}(this.root,t);return e&&e!==this.root?e:null},n.prototype.findFirstNodeAtLine=function(t){return function(e,r){for(var i=e.firstChild,o=null;i;){var s=kd(i.sourcepos,r);if(s===0){if(i.sourcepos[0][0]===r||!i.firstChild)return i;o=i,i=i.firstChild}else{if(s===-1)break;o=i,i=i.next}}return o?function(a){for(;a.parent&&a.parent.type!=="document"&&a.parent.sourcepos[0][0]===a.sourcepos[0][0];)a=a.parent;return a}(function(a){for(;a.lastChild;)a=a.lastChild;return a}(o)):null}(this.root,t)},n.prototype.on=function(t,e){this.eventHandlerMap[t].push(e)},n.prototype.off=function(t,e){var r=this.eventHandlerMap[t],i=r.indexOf(e);r.splice(i,1)},n.prototype.findNodeById=function(t){return xd(t)},n.prototype.removeAllNode=function(){zo={}},n}(),Td=new RegExp("<(/?(?:"+["title","textarea","style","xmp","iframe","noembed","noframes","script","plaintext"].join("|")+")[^>]*>)","ig");function Sd(n){return Td.test(n)?n.replace(Td,function(t,e){return"&lt;"+e}):n}var Md={heading:function(n,t){return{type:t.entering?"openTag":"closeTag",tagName:"h"+n.level,outerNewLine:!0}},text:function(n){return{type:"text",content:n.literal}},softbreak:function(n,t){return{type:"html",content:t.options.softbreak}},linebreak:function(){return{type:"html",content:`<br />
`}},emph:function(n,t){return{type:t.entering?"openTag":"closeTag",tagName:"em"}},strong:function(n,t){return{type:t.entering?"openTag":"closeTag",tagName:"strong"}},paragraph:function(n,t){var e,r=t.entering,i=(e=n.parent)===null||e===void 0?void 0:e.parent;return i&&i.type==="list"&&i.listData.tight?null:{type:r?"openTag":"closeTag",tagName:"p",outerNewLine:!0}},thematicBreak:function(){return{type:"openTag",tagName:"hr",outerNewLine:!0,selfClose:!0}},blockQuote:function(n,t){return{type:t.entering?"openTag":"closeTag",tagName:"blockquote",outerNewLine:!0,innerNewLine:!0}},list:function(n,t){var e=t.entering,r=n.listData,i=r.type,o=r.start,s=i==="bullet"?"ul":"ol",a={};return s==="ol"&&o!==null&&o!==1&&(a.start=o.toString()),{type:e?"openTag":"closeTag",tagName:s,attributes:a,outerNewLine:!0}},item:function(n,t){return{type:t.entering?"openTag":"closeTag",tagName:"li",outerNewLine:!0}},htmlInline:function(n,t){return{type:"html",content:t.options.tagFilter?Sd(n.literal):n.literal}},htmlBlock:function(n,t){var e=t.options,r=e.tagFilter?Sd(n.literal):n.literal;return e.nodeId?[{type:"openTag",tagName:"div",outerNewLine:!0},{type:"html",content:r},{type:"closeTag",tagName:"div",outerNewLine:!0}]:{type:"html",content:r,outerNewLine:!0}},code:function(n){return[{type:"openTag",tagName:"code"},{type:"text",content:n.literal},{type:"closeTag",tagName:"code"}]},codeBlock:function(n){var t=n.info,e=t?t.split(/\s+/):[],r=[];return e.length>0&&e[0].length>0&&r.push("language-"+Ur(e[0])),[{type:"openTag",tagName:"pre",outerNewLine:!0},{type:"openTag",tagName:"code",classNames:r},{type:"text",content:n.literal},{type:"closeTag",tagName:"code"},{type:"closeTag",tagName:"pre",outerNewLine:!0}]},link:function(n,t){if(t.entering){var e=n,r=e.title,i=e.destination;return{type:"openTag",tagName:"a",attributes:Yt({href:Ur(i)},r&&{title:Ur(r)})}}return{type:"closeTag",tagName:"a"}},image:function(n,t){var e=t.getChildrenText,r=t.skipChildren,i=n,o=i.title,s=i.destination;return r(),{type:"openTag",tagName:"img",selfClose:!0,attributes:Yt({src:Ur(s),alt:e(n)},o&&{title:Ur(o)})}},customBlock:function(n,t,e){var r=n.info.trim().toLowerCase(),i=e[r];if(i)try{return i(n,t)}catch(o){console.warn("[@toast-ui/editor] - The error occurred when "+r+" block node was parsed in markdown renderer: "+o)}return[{type:"openTag",tagName:"div",outerNewLine:!0},{type:"text",content:n.literal},{type:"closeTag",tagName:"div",outerNewLine:!0}]},frontMatter:function(n){return[{type:"openTag",tagName:"div",outerNewLine:!0,attributes:{style:"white-space: pre; display: none;"}},{type:"text",content:n.literal},{type:"closeTag",tagName:"div",outerNewLine:!0}]},customInline:function(n,t,e){var r=n,i=r.info,o=r.firstChild,s=i.trim().toLowerCase(),a=e[s],l=t.entering;if(a)try{return a(n,t)}catch(c){console.warn("[@toast-ui/editor] - The error occurred when "+s+" inline node was parsed in markdown renderer: "+c)}return l?[{type:"openTag",tagName:"span"},{type:"text",content:"$$"+i+(o?" ":"")}]:[{type:"text",content:"$$"},{type:"closeTag",tagName:"span"}]}},Id={strike:function(n,t){return{type:t.entering?"openTag":"closeTag",tagName:"del"}},item:function(n,t){var e=t.entering,r=n.listData,i=r.checked,o=r.task;if(e){var s={type:"openTag",tagName:"li",outerNewLine:!0};return o?[s,{type:"openTag",tagName:"input",selfClose:!0,attributes:Yt(Yt({},i&&{checked:""}),{disabled:"",type:"checkbox"})},{type:"text",content:" "}]:s}return{type:"closeTag",tagName:"li",outerNewLine:!0}},table:function(n,t){return{type:t.entering?"openTag":"closeTag",tagName:"table",outerNewLine:!0}},tableHead:function(n,t){return{type:t.entering?"openTag":"closeTag",tagName:"thead",outerNewLine:!0}},tableBody:function(n,t){return{type:t.entering?"openTag":"closeTag",tagName:"tbody",outerNewLine:!0}},tableRow:function(n,t){if(t.entering)return{type:"openTag",tagName:"tr",outerNewLine:!0};var e=[];if(n.lastChild)for(var r=n.parent.parent.columns.length,i=n.lastChild.endIdx+1;i<r;i+=1)e.push({type:"openTag",tagName:"td",outerNewLine:!0},{type:"closeTag",tagName:"td",outerNewLine:!0});return e.push({type:"closeTag",tagName:"tr",outerNewLine:!0}),e},tableCell:function(n,t){var e=t.entering;if(n.ignored)return{type:"text",content:""};var r=n.parent.parent,i=r.type==="tableHead"?"th":"td",o=r.parent.columns[n.startIdx],s=o?.align?{align:o.align}:null;return e?Yt({type:"openTag",tagName:i,outerNewLine:!0},s&&{attributes:s}):{type:"closeTag",tagName:i,outerNewLine:!0}}},tv={softbreak:`
`,gfm:!1,tagFilter:!1,nodeId:!1};function ev(n){for(var t=[],e=n.walker(),r=null;r=e.next();){var i=r.node;i.type==="text"&&t.push(i.literal)}return t.join("")}var Ua=function(){function n(t){this.buffer=[],this.options=Yt(Yt({},tv),t),this.convertors=this.createConvertors(),delete this.options.convertors}return n.prototype.createConvertors=function(){var t=Yt({},Md);if(this.options.gfm&&(t=Yt(Yt({},t),Id)),this.options.convertors){var e=this.options.convertors,r=Object.keys(e),i=Yt(Yt({},Md),Id);r.forEach(function(o){var s=t[o],a=e[o],l=Object.keys(i).indexOf(o)===-1?o.toLowerCase():o;t[l]=s?function(c,u,d){return u.origin=function(){return s(c,u,d)},a(c,u)}:a})}return t},n.prototype.getConvertors=function(){return this.convertors},n.prototype.getOptions=function(){return this.options},n.prototype.render=function(t){var e=this;this.buffer=[];for(var r=t.walker(),i=null,o=function(){var a=i.node,l=i.entering,c=s.convertors[a.type];if(!c)return"continue";var u=!1,d={entering:l,leaf:!Aa(a),options:s.options,getChildrenText:ev,skipChildren:function(){u=!0}},p=id(a)||function(h){return h.type==="customInline"}(a)?c(a,d,s.convertors):c(a,d);p&&((Array.isArray(p)?p:[p]).forEach(function(h,f){h.type==="openTag"&&e.options.nodeId&&f===0&&(h.attributes||(h.attributes={}),h.attributes["data-nodeid"]=String(a.id)),e.renderHTMLNode(h)}),u&&(r.resumeAt(a,!1),r.next()))},s=this;i=r.next();)o();return this.addNewLine(),this.buffer.join("")},n.prototype.renderHTMLNode=function(t){switch(t.type){case"openTag":case"closeTag":this.renderElementNode(t);break;case"text":this.renderTextNode(t);break;case"html":this.renderRawHtmlNode(t)}},n.prototype.generateOpenTagString=function(t){var e=this,r=t.tagName,i=t.classNames,o=t.attributes;this.buffer.push("<"+r),i&&i.length>0&&this.buffer.push(' class="'+i.join(" ")+'"'),o&&Object.keys(o).forEach(function(s){var a=o[s];e.buffer.push(" "+s+'="'+a+'"')}),t.selfClose&&this.buffer.push(" /"),this.buffer.push(">")},n.prototype.generateCloseTagString=function(t){var e=t.tagName;this.buffer.push("</"+e+">")},n.prototype.addNewLine=function(){this.buffer.length&&_o(_o(this.buffer))!==`
`&&this.buffer.push(`
`)},n.prototype.addOuterNewLine=function(t){t.outerNewLine&&this.addNewLine()},n.prototype.addInnerNewLine=function(t){t.innerNewLine&&this.addNewLine()},n.prototype.renderTextNode=function(t){this.buffer.push(Ur(t.content))},n.prototype.renderRawHtmlNode=function(t){this.addOuterNewLine(t),this.buffer.push(t.content),this.addOuterNewLine(t)},n.prototype.renderElementNode=function(t){t.type==="openTag"?(this.addOuterNewLine(t),this.generateOpenTagString(t),t.selfClose?this.addOuterNewLine(t):this.addInnerNewLine(t)):(this.addInnerNewLine(t),this.generateCloseTagString(t),this.addOuterNewLine(t))},n}(),nv=b(368),rv=b.n(nv),iv=["iframe","embed"],Nd=[];function Od(n){St(iv,n)&&Nd.push(n.toLowerCase())}function hr(n,t){return rv().sanitize(n,v({ADD_TAGS:Nd,ADD_ATTR:["rel","target","hreflang","type"],FORBID_TAGS:["input","script","textarea","form","button","select","meta","style","link","title","object","base"]},t))}function Ld(n,t){return n.literal.replace(new RegExp("(<\\s*"+t+"[^>]*>)|(</"+t+"\\s*[>])","ig"),"").trim()}function Wa(n){var t=(n=n.match($r)[0]).match(new RegExp(eu,"g"));return t?t.reduce(function(e,r){var i=r.trim().split("="),o=i[0],s=i.slice(1);return s.length&&(e[o]=s.join("=").replace(/'|"/g,"").trim()),e},{}):{}}function Ka(n){return rn()(n.attributes).reduce(function(t,e){return t[e.nodeName]=e.nodeValue,t},{})}function Ad(n,t,e,r){var i=r.getToDOMNode(t)(n),o=e(i.outerHTML),s=document.createElement("div");return s.innerHTML=o,{dom:i=s.firstChild,htmlAttrs:Ka(i)}}var ov={htmlBlock:function(n,t,e){return{atom:!0,content:"block+",group:"block",attrs:{htmlAttrs:{default:{}},childrenHTML:{default:""},htmlBlock:{default:!0}},parseDOM:[{tag:n,getAttrs:function(r){return{htmlAttrs:Ka(r),childrenHTML:r.innerHTML}}}],toDOM:function(r){var i=Ad(r,n,t,e),o=i.dom,s=i.htmlAttrs;return s.class=s.class?s.class+" html-block":"html-block",M([n,s],rn()(o.childNodes))}}},htmlInline:function(n,t,e){return{attrs:{htmlAttrs:{default:{}},htmlInline:{default:!0}},parseDOM:[{tag:n,getAttrs:function(r){return{htmlAttrs:Ka(r)}}}],toDOM:function(r){var i=Ad(r,n,t,e).htmlAttrs;return[n,i,0]}}}},sv=/^\s*<\s*\//,av={paragraph:function(n,t){var e=t.entering,r=t.origin;return t.options.nodeId?{type:e?"openTag":"closeTag",outerNewLine:!0,tagName:"p"}:r()},softbreak:function(n){return{type:"html",content:n.prev&&n.prev.type==="htmlInline"&&/<br ?\/?>/.test(n.prev.literal)?`
`:`<br>
`}},item:function(n,t){if(t.entering){var e={},r=[];return n.listData.task&&(e["data-task"]="",r.push("task-list-item"),n.listData.checked&&(r.push("checked"),e["data-task-checked"]="")),{type:"openTag",tagName:"li",classNames:r,attributes:e,outerNewLine:!0}}return{type:"closeTag",tagName:"li",outerNewLine:!0}},code:function(n){return[{type:"openTag",tagName:"code",attributes:{"data-backticks":String(n.tickCount)}},{type:"text",content:n.literal},{type:"closeTag",tagName:"code"}]},codeBlock:function(n){var t=n,e=t.fenceLength,r=t.info,i=r?r.split(/\s+/):[],o=[],s={};if(e>3&&(s["data-backticks"]=e),i.length>0&&i[0].length>0){var a=i[0];o.push("lang-"+a),s["data-language"]=a}return[{type:"openTag",tagName:"pre",classNames:o},{type:"openTag",tagName:"code",attributes:s},{type:"text",content:n.literal},{type:"closeTag",tagName:"code"},{type:"closeTag",tagName:"pre"}]},customInline:function(n,t){var e=t.origin,r=t.entering,i=t.skipChildren,o=n.info;return o.indexOf("widget")!==-1&&r?(i(),[{type:"openTag",tagName:"span",classNames:["tui-widget"]},{type:"html",content:Qc(o,Xc(n)).outerHTML},{type:"closeTag",tagName:"span"}]):e()}};function Ga(n,t){var e=v({},av);return n&&(e.link=function(r,i){var o=i.entering,s=(0,i.origin)();return o&&(s.attributes=v(v({},s.attributes),n)),s}),t&&Object.keys(t).forEach(function(r){var i=e[r],o=t[r];i&&Te()(o)?e[r]=function(s,a){var l=v({},a);return l.origin=function(){return i(s,a)},o(s,l)}:St(["htmlBlock","htmlInline"],r)&&!Te()(o)?e[r]=function(s,a){var l=s.literal.match($r);if(l){var c=l[0],u=l[1],d=l[3],p=(u||d).toLowerCase(),h=o[p],f=Ld(s,p);if(h){var m=v({},s);return m.attrs=Wa(c),m.childrenHTML=f,m.type=p,a.entering=!sv.test(s.literal),h(m,a)}}return a.origin()}:e[r]=o}),e}var lv=["list","item","blockQuote"],cv=["UL","OL","BLOCKQUOTE"];function uv(n,t){var e,r=n.child(t);return!r.childCount||r.childCount===1&&!(!((e=r.firstChild.text)===null||e===void 0)&&e.trim())}function Dd(n,t,e){var r=Ri(t)-1,i=ko(t)-1,o=e[r].getBoundingClientRect(),s=e[i].offsetTop-e[r].offsetTop+e[i].clientHeight;return{height:s<=0?e[r].clientHeight:s+dv(n,e,Math.min(i+1,n.childCount-1)),rect:o}}function dv(n,t,e){for(var r=n.childCount-1,i=0;e<=r&&uv(n,e);)i+=t[e].clientHeight,e+=1;return i}function jo(n,t){for(var e=0;n&&n!==t&&(St(cv,n.tagName)||(e+=n.offsetTop),n.offsetParent!==t.offsetParent);)n=n.parentElement;return e}function Rd(n,t,e){return n&&t>e+n.offsetTop?Rd(n.nextElementSibling,t,e)||n:null}function Ja(n,t){for(var e=n.querySelector('[data-nodeid="'+t.id+'"]');!e||wf(t);)t=t.parent,e=n.querySelector('[data-nodeid="'+t.id+'"]');return function(r){for(var i=r.mdNode,o=r.el;(St(lv,i.type)||i.type==="table")&&i.firstChild;)i=i.firstChild,o=o.firstElementChild;return{mdNode:i,el:o}}({mdNode:t,el:e})}var Fe={};function Ya(n){n&&(delete Fe[Number(n.getAttribute("data-nodeid"))],rn()(n.children).forEach(function(t){Ya(t)}))}function pv(n,t,e){var r,i=Fe[r=e]&&Fe[r].height,o=function(l){return Fe[l]&&Fe[l].offsetTop}(e),s=i||n.clientHeight,a=o||jo(n,t)||n.offsetTop;return i||function(l,c){Fe[l]=Fe[l]||{},Fe[l].height=c}(e,s),o||function(l,c){Fe[l]=Fe[l]||{},Fe[l].offsetTop=c}(e,a),{nodeHeight:s,offsetTop:a}}var Qa=J("md-preview-highlight"),hv=function(){function n(t,e){var r=document.createElement("div");this.el=r,this.eventEmitter=t,this.isViewer=!!e.isViewer,this.el.className=J("md-preview");var i=e.linkAttributes,o=e.customHTMLRenderer,s=e.sanitizer,a=e.highlight,l=a!==void 0&&a;this.renderer=new Ua({gfm:!0,nodeId:!0,convertors:Ga(i,o)}),this.cursorNodeId=null,this.sanitizer=s,this.initEvent(l),this.initContentSection(),this.isViewer&&(this.previewContent.style.overflowWrap="break-word")}return n.prototype.initContentSection=function(){this.previewContent=su('<div class="'+J("contents")+'"></div>'),this.isViewer||this.el.appendChild(this.previewContent)},n.prototype.toggleActive=function(t){ca(this.el,"active",t)},n.prototype.initEvent=function(t){var e=this;this.eventEmitter.listen("updatePreview",this.update.bind(this)),this.isViewer||(t&&(this.eventEmitter.listen("changeToolbarState",function(r){var i=r.mdNode,o=r.cursorPos;e.updateCursorNode(i,o)}),this.eventEmitter.listen("blur",function(){e.removeHighlight()})),Ru()(this.el,"scroll",function(r){e.eventEmitter.emit("scroll","preview",function(i,o){for(var s=o,a=null;s;){var l=s.firstElementChild;if(!l)break;a=s,s=Rd(l,i,jo(s,o))}var c=s||a;return c===o?null:c}(r.target.scrollTop,e.previewContent))}),this.eventEmitter.listen("changePreviewTabPreview",function(){return e.toggleActive(!0)}),this.eventEmitter.listen("changePreviewTabWrite",function(){return e.toggleActive(!1)}))},n.prototype.removeHighlight=function(){if(this.cursorNodeId){var t=this.getElementByNodeId(this.cursorNodeId);t&&re()(t,Qa)}},n.prototype.updateCursorNode=function(t,e){t&&((t=qr(t,function(s){return!function(a){switch(a.type){case"code":case"text":case"emph":case"strong":case"strike":case"link":case"image":case"htmlInline":case"linebreak":case"softbreak":case"customInline":return!0;default:return!1}}(s)})).type==="tableRow"?t=function(s,a){for(var l=s.firstChild;l&&l.next&&!(xo(l.next)>a+1);)l=l.next;return l}(t,e[1]):t.type==="tableBody"&&(t=null));var r=t?t.id:null;if(this.cursorNodeId!==r){var i=this.getElementByNodeId(this.cursorNodeId),o=this.getElementByNodeId(r);i&&re()(i,Qa),o&&me()(o,Qa),this.cursorNodeId=r}},n.prototype.getElementByNodeId=function(t){return t?this.previewContent.querySelector('[data-nodeid="'+t+'"]'):null},n.prototype.update=function(t){var e=this;t.forEach(function(r){return e.replaceRangeNodes(r)}),this.eventEmitter.emit("afterPreviewRender",this)},n.prototype.replaceRangeNodes=function(t){var e=this,r=t.nodes,i=t.removedNodeRange,o=this.previewContent,s=this.eventEmitter.emitReduce("beforePreviewRender",this.sanitizer(r.map(function(f){return e.renderer.render(f)}).join("")));if(i){var a=i.id,l=a[0],c=a[1],u=this.getElementByNodeId(l),d=this.getElementByNodeId(c);if(u){u.insertAdjacentHTML("beforebegin",s);for(var p=u;p&&p!==d;){var h=p.nextElementSibling;cr(p),Ya(p),p=h}p?.parentNode&&(cr(p),Ya(p))}}else o.insertAdjacentHTML("afterbegin",s)},n.prototype.getRenderer=function(){return this.renderer},n.prototype.destroy=function(){Du()(this.el,"scroll"),this.el=null},n.prototype.getElement=function(){return this.el},n.prototype.getHTML=function(){return pa(this.previewContent.innerHTML)},n.prototype.setHTML=function(t){this.previewContent.innerHTML=t},n.prototype.setHeight=function(t){ae()(this.el,{height:t+"px"})},n.prototype.setMinHeight=function(t){ae()(this.el,{minHeight:t+"px"})},n}(),Pd=hv;function un(n,t){for(var e=n.depth;e;){var r=n.node(e);if(t(r,e))return{node:r,depth:e,offset:e>0?n.before(e):0};e-=1}return null}function Zr(n){return!!un(n,function(t){var e=t.type;return e.name==="listItem"||e.name==="bulletList"||e.name==="orderedList"})}function Vo(n){return!!un(n,function(t){var e=t.type;return e.name==="tableHeadCell"||e.name==="tableBodyCell"})}function ti(n){return un(n,function(t){return t.type.name==="listItem"})}function Uo(n){return{tag:n,getAttrs:function(t){var e=t.getAttribute("data-raw-html");return v({},e&&{rawHTML:e})}}}function Fd(n){return Object.keys(n).reduce(function(t,e){return e!=="rawHTML"&&n[e]&&(t[e=e==="className"?"class":e]=n[e]),t},{})}function Bd(n){return{tag:n,getAttrs:function(t){return["rawHTML","colspan","rowspan","extended"].reduce(function(e,r){var i=r==="rawHTML"?"data-raw-html":r,o=t.getAttribute(i);return o&&(e[r]=St(["rawHTML","extended"],r)?o:Number(o)),e},{})}}}function Nt(n){var t=n.htmlAttrs,e=n.classNames;return v(v({},t),{class:e?e.join(" "):null})}function Hd(n,t,e,r){var i=t.$from,o=t.$to,s=t.depth,a=t,l=!1;if(s>=2&&i.node(s-1).type.compatibleContent(e)&&t.startIndex===0&&i.index(s-1)){var c=n.doc.resolve(t.start-2);a=new vr(c,c,s),t.endIndex<t.parent.childCount&&(t=new vr(i,n.doc.resolve(o.end(s)),s)),l=!0}var u=function(d,p,h,f){var m=function(E,L){var P=E.parent,A=E.startIndex,H=E.endIndex,B=P.contentMatchAt(A).findWrapping(L);if(B){var z=B.length?B[0]:L;return P.canReplaceWith(A,H,z)?B:null}return null}(d,h),g=function(E,L){var P=E.parent,A=E.startIndex,H=E.endIndex,B=P.child(A),z=L.contentMatch.findWrapping(B.type);if(z){for(var q=(z.length?z[z.length-1]:L).contentMatch,_=A;q&&_<H;_+=1)q=q.matchType(P.child(_).type);if(q&&q.validEnd)return z}return null}(p,h);if(m&&g){var w=m.map(function(E){return{type:E}}),C=g.map(function(E){return{type:E,attrs:f}});return w.concat({type:h}).concat(C)}return null}(a,t,e,r);return u?function(d,p,h,f,m){for(var g=p.start,w=p.end,C=p.startIndex,E=p.endIndex,L=p.parent,P=S.empty,A=h.length-1;A>=0;A-=1)P=S.from(h[A].type.create(h[A].attrs,P));d.step(new Mt(g-(f?2:0),w,g,w,new j(P,0,0),h.length,!0));var H=0;for(A=0;A<h.length;A+=1)if(h[A].type===m){H=A+1;break}for(var B=h.length-H,z=g+h.length-(f?2:0),q=(A=C,E);A<q;A+=1)A!==C&&Ge(d.doc,z,B)&&(d.split(z,B),z+=2*B),z+=L.child(A).nodeSize;return d}(n,t,u,l,e):n}function zd(n,t){for(var e=n.resolve(t);e.node().type.name!=="paragraph";)t-=2,e=n.resolve(t);return ti(e)}function _d(n){return function(t,e){var r=t.selection,i=t.tr,o=r.$from,s=r.$to,a=o.blockRange(s);if(a){var l=Zr(o)?function(c,u,d){var p=u.$from,h=u.$to,f=ti(p),m=ti(h);if(f&&m)for(;m;){var g=m.offset,w=m.node,C=m.depth;w.attrs.task&&c.setNodeMarkup(g,null,{task:!1,checked:!1});var E=c.doc.resolve(g);if(E.parent.type!==d){var L=E.before(C-1);c.setNodeMarkup(L,d)}if(g===f.offset)break;m=zd(c.doc,g)}return c}(i,a,n):Hd(i,a,n);return e(l),!0}return!1}}function fv(){return function(n,t){var e=n.selection,r=n.tr,i=n.schema,o=e.$from,s=e.$to,a=o.blockRange(s);if(a){var l=Zr(o)?function(c,u){var d=u.$from,p=u.$to,h=ti(d),f=ti(p);if(h&&f)for(;f;){var m=f.offset,g={task:!f.node.attrs.task,checked:!1};if(c.setNodeMarkup(m,null,g),m===h.offset)break;f=zd(c.doc,m)}return c}(r,a):Hd(r,a,i.nodes.bulletList,{task:!0});return t(l),!0}return!1}}function mv(n){return function(t,e){var r=t.tr,i=t.selection,o=i.$from,s=i.$to,a=o.blockRange(s,function(c){var u=c.childCount,d=c.firstChild;return!!u&&d.type===n});if(a){var l=o.node(a.depth-1).type===n?function(c,u,d){var p=u.$from,h=u.$to,f=u.end,m=u.depth,g=u.parent,w=h.end(m);return f<w&&(c.step(new Mt(f-1,w,f,w,new j(S.from(d.create(null,g.copy())),1,0),1,!0)),u=new vr(c.doc.resolve(p.pos),c.doc.resolve(w),m)),c.lift(u,Yn(u)),c}(r,a,n):function(c,u){for(var d=u.parent,p=u.end,h=u.endIndex-1,f=u.startIndex;h>f;h-=1)p-=d.child(h).nodeSize,c.delete(p-1,p+1);var m=c.doc.resolve(u.start),g=m.nodeAfter,w=u.startIndex===0,C=u.endIndex===d.childCount,E=m.node(-1),L=m.index(-1),P=E.canReplace(L+(w?0:1),L+1,g?.content.append(C?S.empty:S.from(d)));if(g&&P){var A=m.pos,H=A+g.nodeSize;c.step(new Mt(A-(w?1:0),H+(C?1:0),A+1,H-1,new j((w?S.empty:S.from(d.copy(S.empty))).append(C?S.empty:S.from(d.copy(S.empty))),w?0:1,C?0:1),w?0:1))}return c}(r,a);return e(l),!0}return!1}}function gv(){return function(){return function(n,t){var e=n.selection,r=n.schema,i=e.$from,o=e.$to;return!(!i.blockRange(o)||!Zr(i))&&function(s){return function(a,l){var c=a.tr,u=a.selection,d=u.$from,p=u.$to,h=d.blockRange(p,function(P){var A=P.childCount,H=P.firstChild;return!!A&&H.type===s});if(h&&h.startIndex>0){var f=h.parent,m=f.child(h.startIndex-1);if(m.type!==s)return!1;var g=m.lastChild&&m.lastChild.type===f.type,w=g?S.from(s.create()):null,C=new j(S.from(s.create(null,S.from(f.type.create(null,w)))),g?3:1,0),E=h.start,L=h.end;return c.step(new Mt(E-(g?3:1),L,E,L,C,1,!0)),l(c),!0}return!1}}(r.nodes.listItem)(n,t)}}}function Xa(){return{indent:gv(),outdent:function(){return function(n,t){var e=n.selection,r=n.schema,i=e.$from,o=e.$to;return!(!i.blockRange(o)||!Zr(i))&&mv(r.nodes.listItem)(n,t)}}}}var qd=new Map,Qt=function(){function n(t,e,r,i){this.table=t,this.tableRows=e,this.tableStartPos=r,this.rowInfo=i}return n.create=function(t){var e=un(t,function(f){return f.type.name==="table"});if(e){var r=e.node,i=e.depth,o=e.offset,s=qd.get(r);if(s?.tableStartPos===o+1)return s;var a=[],l=t.start(i),c=r.child(0),u=r.child(1),d=Za(c,l),p=Za(u,l+c.nodeSize);c.forEach(function(f){return a.push(f)}),u.forEach(function(f){return a.push(f)});var h=new n(r,a,l,d.concat(p));return qd.set(r,h),h}return null},Object.defineProperty(n.prototype,"totalRowCount",{get:function(){return this.rowInfo.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"totalColumnCount",{get:function(){return this.rowInfo[0].length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tableStartOffset",{get:function(){return this.tableStartPos},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tableEndOffset",{get:function(){return this.tableStartPos+this.table.nodeSize-1},enumerable:!1,configurable:!0}),n.prototype.getCellInfo=function(t,e){return this.rowInfo[t][e]},n.prototype.posAt=function(t,e){for(var r=0,i=this.tableStartPos;;r+=1){var o=i+this.tableRows[r].nodeSize;if(r===t){for(var s=e;s<this.totalColumnCount&&this.rowInfo[r][s].offset<i;)s+=1;return s===this.totalColumnCount?o:this.rowInfo[r][s].offset}i=o}},n.prototype.getNodeAndPos=function(t,e){var r=this.rowInfo[t][e];return{node:this.table.nodeAt(r.offset-this.tableStartOffset),pos:r.offset}},n.prototype.extendedRowspan=function(t,e){return!1},n.prototype.extendedColspan=function(t,e){return!1},n.prototype.getRowspanCount=function(t,e){return 0},n.prototype.getColspanCount=function(t,e){return 0},n.prototype.decreaseColspanCount=function(t,e){return 0},n.prototype.decreaseRowspanCount=function(t,e){return 0},n.prototype.getColspanStartInfo=function(t,e){return null},n.prototype.getRowspanStartInfo=function(t,e){return null},n.prototype.getCellStartOffset=function(t,e){var r=this.rowInfo[t][e].offset;return this.extendedRowspan(t,e)?this.posAt(t,e):r},n.prototype.getCellEndOffset=function(t,e){var r=this.rowInfo[t][e],i=r.offset,o=r.nodeSize;return this.extendedRowspan(t,e)?this.posAt(t,e):i+o},n.prototype.getCellIndex=function(t){for(var e=0;e<this.totalRowCount;e+=1)for(var r=this.rowInfo[e],i=0;i<this.totalColumnCount;i+=1)if(r[i].offset+1>t.pos)return[e,i];return[0,0]},n.prototype.getRectOffsets=function(t,e){var r,i,o;e===void 0&&(e=t),t.pos>e.pos&&(t=(r=[e,t])[0],e=r[1]);var s=this.getCellIndex(t),a=s[0],l=s[1],c=this.getCellIndex(e),u=c[0],d=c[1];return a=(i=mi(a,u))[0],u=i[1],l=(o=mi(l,d))[0],d=o[1],this.getSpannedOffsets({startRowIdx:a,startColIdx:l,endRowIdx:u,endColIdx:d})},n.prototype.getSpannedOffsets=function(t){return t},n}(),Za=function(n,t){var e=[];return n.forEach(function(r,i){var o={rowspanMap:{},colspanMap:{},length:0};r.forEach(function(s,a){for(var l=s.nodeSize,c=0;o[c];)c+=1;o[c]={offset:t+i+a+2,nodeSize:l},o.length+=1}),e.push(o)}),e};function vv(n,t){return Or(Qt.prototype,n),Za=t,Qt}var yv=function(n){function t(e,r){r===void 0&&(r=e);var i=this,o=e.node(0),s=Qt.create(e),a=s.getRectOffsets(e,r),l=function(c,u,d){for(var p=d.startRowIdx,h=d.startColIdx,f=d.endRowIdx,m=d.endColIdx,g=[],w=p;w<=f;w+=1)for(var C=h;C<=m;C+=1){var E=u.getCellInfo(w,C),L=E.offset,P=E.nodeSize;g.push(new yt(c.resolve(L+1),c.resolve(L+P-1)))}return g}(o,s,a);return(i=n.call(this,l[0].$from,l[0].$to,l)||this).startCell=e,i.endCell=r,i.offsetMap=s,i.isCellSelection=!0,i.visible=!1,i}return k(t,n),t.prototype.map=function(e,r){var i=this.startCell.pos,o=this.endCell.pos,s=e.resolve(r.map(i)),a=e.resolve(r.map(o)),l=Qt.create(s);if(this.offsetMap.totalColumnCount>l.totalColumnCount||this.offsetMap.totalRowCount>l.totalRowCount){var c={tableBody:1,tableRow:2,tableCell:3,paragraph:4}[a.parent.type.name],u=a.end(a.depth-c),d=Math.min(u-4,a.pos);return dt.create(e,d)}return new t(s,a)},t.prototype.eq=function(e){return e instanceof t&&e.startCell.pos===this.startCell.pos&&e.endCell.pos===this.endCell.pos},t.prototype.content=function(){for(var e=this.startCell.node(-2),r=this.startCell.start(-2),i=e.child(1).firstChild,o=e.child(0).type.create(),s=e.child(1).type.create(),a=Qt.create(this.startCell),l=a.getRectOffsets(this.startCell,this.endCell),c=l.startRowIdx,u=l.startColIdx,d=l.endRowIdx,p=l.endColIdx,h=!1,f=c;f<=d;f+=1){for(var m=[],g=u;g<=p;g+=1){var w=a.getCellInfo(f,g).offset,C=e.nodeAt(w-r);C&&(h=C.type.name==="tableHeadCell",a.extendedRowspan(f,g)||a.extendedColspan(f,g)?m.push(C.type.create({extended:!0})):m.push(C.copy(C.content)))}var E=i.copy(S.from(m)),L=h?o:s;L.content=L.content.append(S.from(E))}return new j(function(P,A){var H=[];return P.childCount&&H.push(P),A.childCount&&H.push(A),S.from(H)}(o,s),1,1)},t.prototype.toJSON=function(){return JSON.stringify(this)},t}(G),tl=yv;function $d(n,t,e,r){for(var i=e.nodes,o=i.tableRow,s=i.tableBodyCell,a=i.paragraph,l=[],c=0;c<n;c+=1){for(var u=[],d=0;d<t;d+=1){var p=r&&r[c*t+d],h=a.create(null,p?e.text(p):[]);u.push(s.create(null,h))}l.push(o.create(null,u))}return l}function Wo(n,t,e,r){r===void 0&&(r=null);for(var i=e.nodes,o=i.tableHeadCell,s=i.tableBodyCell,a=i.paragraph,l=t===0?o:s,c=[],u=0;u<n;u+=1)c.push(l.create(r,a.create()));return c}function jd(n,t){for(;n&&n!==t;){if(n.nodeName==="TD"||n.nodeName==="TH")return n;n=n.parentNode}return null}function Vd(n){return un(n,function(t){var e=t.type;return e.name==="tableHeadCell"||e.name==="tableBodyCell"})}function tn(n){if(n instanceof dt){var t=n.$anchor,e=Vd(t);if(e){var r=t.node(0).resolve(t.before(e.depth));return{anchor:r,head:r}}}var i=n;return{anchor:i.startCell,head:i.endCell}}function Ud(n){var t;if(n.size){var e=n.content,r=n.openStart,i=n.openEnd;if(e.childCount!==1)return null;for(;e.childCount===1&&(r>0&&i>0||((t=e.firstChild)===null||t===void 0?void 0:t.type.name)==="table");)r-=1,i-=1,e=e.firstChild.content;if(e.firstChild.type.name==="tableHead"||e.firstChild.type.name==="tableBody")return e}return null}function ei(n){var t=n.startRowIdx,e=n.startColIdx;return{rowCount:n.endRowIdx-t+1,columnCount:n.endColIdx-e+1}}function bv(n,t){return v(v({},n.attrs),t)}var Fn=new Ei("cellSelection"),wv=function(){function n(t){this.view=t,this.handlers={mousedown:this.handleMousedown.bind(this),mousemove:this.handleMousemove.bind(this),mouseup:this.handleMouseup.bind(this)},this.startCellPos=null,this.init()}return n.prototype.init=function(){this.view.dom.addEventListener("mousedown",this.handlers.mousedown)},n.prototype.handleMousedown=function(t){var e=jd(t.target,this.view.dom);if(t.button!==2){if(e){var r=this.getCellPos(t);r&&(this.startCellPos=r),this.bindEvent()}}else t.preventDefault()},n.prototype.handleMousemove=function(t){var e,r=Fn.getState(this.view.state),i=this.getCellPos(t),o=this.startCellPos;r?e=this.view.state.doc.resolve(r):o!==i&&(e=o),e&&o&&i&&this.setCellSelection(o,i)},n.prototype.handleMouseup=function(){this.startCellPos=null,this.unbindEvent(),Fn.getState(this.view.state)!==null&&this.view.dispatch(this.view.state.tr.setMeta(Fn,-1))},n.prototype.bindEvent=function(){var t=this.view.dom;t.addEventListener("mousemove",this.handlers.mousemove),t.addEventListener("mouseup",this.handlers.mouseup)},n.prototype.unbindEvent=function(){var t=this.view.dom;t.removeEventListener("mousemove",this.handlers.mousemove),t.removeEventListener("mouseup",this.handlers.mouseup)},n.prototype.getCellPos=function(t){var e=t.clientX,r=t.clientY,i=this.view.posAtCoords({left:e,top:r});if(i){var o=this.view.state.doc,s=o.resolve(i.pos),a=Vd(s);if(a){var l=s.before(a.depth);return o.resolve(l)}}return null},n.prototype.setCellSelection=function(t,e){var r=this.view.state,i=r.selection,o=r.tr,s=Fn.getState(this.view.state)===null,a=new tl(t,e);if(s||!i.eq(a)){var l=o.setSelection(a);s&&l.setMeta(Fn,e.pos),this.view.dispatch(l)}},n.prototype.destroy=function(){this.view.dom.removeEventListener("mousedown",this.handlers.mousedown)},n}(),kv=wv,xv=J("cell-selected");function Cv(n){var t=n.selection,e=n.doc;if(t instanceof tl){var r=[];return t.ranges.forEach(function(i){var o=i.$from,s=i.$to;r.push(de.node(o.pos-1,s.pos+1,{class:xv}))}),Rt.create(e,r)}return null}var Ev=b(928),el=b.n(Ev),Tv=function(){function n(){this.keys=[],this.values=[]}return n.prototype.getKeyIndex=function(t){return el()(t,this.keys)},n.prototype.get=function(t){return this.values[this.getKeyIndex(t)]},n.prototype.set=function(t,e){var r=this.getKeyIndex(t);return r>-1?this.values[r]=e:(this.keys.push(t),this.values.push(e)),this},n.prototype.has=function(t){return this.getKeyIndex(t)>-1},n.prototype.delete=function(t){var e=this.getKeyIndex(t);return e>-1&&(this.keys.splice(e,1),this.values.splice(e,1),!0)},n.prototype.forEach=function(t,e){var r=this;e===void 0&&(e=this),this.values.forEach(function(i,o){i&&r.keys[o]&&t.call(e,i,r.keys[o],r)})},n.prototype.clear=function(){this.keys=[],this.values=[]},n}(),Wd=Tv,nl="en-US",Sv=function(){function n(){this.code=nl,this.langs=new Wd}return n.prototype.setCode=function(t){this.code=t||nl},n.prototype.setLanguage=function(t,e){var r=this;(t=[].concat(t)).forEach(function(i){if(r.langs.has(i)){var o=r.langs.get(i);r.langs.set(i,pi()(o,e))}else r.langs.set(i,e)})},n.prototype.get=function(t,e){e||(e=this.code);var r=this.langs.get(e);r||(r=this.langs.get(nl));var i=r[t];if(!i)throw new Error('There is no text key "'+t+'" in '+e);return i},n}(),ct=new Sv,Mv=[[{action:"Add row to up",command:"addRowToUp",disableInThead:!0,className:"add-row-up"},{action:"Add row to down",command:"addRowToDown",disableInThead:!0,className:"add-row-down"},{action:"Remove row",command:"removeRow",disableInThead:!0,className:"remove-row"}],[{action:"Add column to left",command:"addColumnToLeft",className:"add-column-left"},{action:"Add column to right",command:"addColumnToRight",className:"add-column-right"},{action:"Remove column",command:"removeColumn",className:"remove-column"}],[{action:"Align column to left",command:"alignColumn",payload:{align:"left"},className:"align-column-left"},{action:"Align column to center",command:"alignColumn",payload:{align:"center"},className:"align-column-center"},{action:"Align column to right",command:"alignColumn",payload:{align:"right"},className:"align-column-right"}],[{action:"Remove table",command:"removeTable",className:"remove-table"}]];function Iv(n,t){return Mv.map(function(e){return e.map(function(r){var i=r.action,o=r.command,s=r.payload,a=r.disableInThead,l=r.className;return{label:ct.get(i),onClick:function(){n.emit("command",o,s)},disabled:t&&!!a,className:l}})}).concat()}function Nv(n){return new le({props:{handleDOMEvents:{contextmenu:function(t,e){var r=jd(e.target,t.dom);if(r){e.preventDefault();var i=e,o=i.clientX,s=i.clientY,a=t.dom.parentNode.getBoundingClientRect(),l=a.left,c=a.top,u=r.nodeName==="TH";return n.emit("contextmenu",{pos:{left:o-l+10+"px",top:s-c+30+"px"},menuGroups:Iv(n,u),tableCell:r}),!0}return!1}}}})}var Ov=["image","link","customBlock","frontMatter"],Lv=["strong","strike","emph","code"],Kd=["bulletList","orderedList","taskList"];function Av(n,t,e){var r=n.$from,i=n.$to,o=n.from,s=n.to,a={indent:{active:!1,disabled:!0},outdent:{active:!1,disabled:!0}};return t.nodesBetween(o,s,function(l,c,u){var d=function(p,h){var f=p.type.name;return f==="listItem"?p.attrs.task?"taskList":h.type.name:f.indexOf("table")!==-1?"table":f}(l,u);St(Ov,d)||(St(Kd,d)?(function(p,h){h[p]={active:!0},Kd.filter(function(f){return f!==p}).forEach(function(f){h[f]&&delete h[f]})}(d,a),a.indent.disabled=!1,a.outdent.disabled=!1):d==="paragraph"||d==="text"?function(p,h,f,m){Lv.forEach(function(g){var w=f.marks[g],C=p.marksAcross(h)||[];w.isInSet(C)&&(m[g]={active:!0})})}(r,i,e,a):a[d]={active:!0})}),a}function Dv(n){return new le({view:function(){return{update:function(t){var e=t.state,r=e.selection,i=e.doc,o=e.schema;n.emit("changeToolbarState",{toolbarState:Av(r,i,o)})}}}})}var Rv=function(){function n(t,e,r,i){var o=this;this.openEditor=function(){if(o.innerEditorView)throw new Error("The editor is already opened.");o.dom.draggable=!1,o.wrapper.style.display="none",o.innerViewContainer.style.display="block",o.innerEditorView=new Ws(o.innerViewContainer,{state:Zn.create({doc:o.node,plugins:[Li({"Mod-z":function(){return Di(o.innerEditorView.state,o.innerEditorView.dispatch)},"Shift-Mod-z":function(){return na(o.innerEditorView.state,o.innerEditorView.dispatch)},Tab:function(s,a){return a(s.tr.insertText("	")),!0},Enter:Lc,Escape:function(){return o.cancelEditing(),!0},"Ctrl-Enter":function(){return o.saveAndFinishEditing(),!0}}),Uc()]}),dispatchTransaction:function(s){return o.dispatchInner(s)},handleDOMEvents:{mousedown:function(){return o.editorView.hasFocus()&&o.innerEditorView.focus(),!0},blur:function(){return o.saveAndFinishEditing(),!0}}}),o.innerEditorView.focus()},this.node=t,this.editorView=e,this.getPos=r,this.toDOMAdaptor=i,this.innerEditorView=null,this.canceled=!1,this.dom=document.createElement("div"),this.dom.className=J("custom-block"),this.wrapper=document.createElement("div"),this.wrapper.className=J("custom-block-view"),this.createInnerViewContainer(),this.renderCustomBlock(),this.dom.appendChild(this.innerViewContainer),this.dom.appendChild(this.wrapper)}return n.prototype.renderToolArea=function(){var t=this,e=document.createElement("div"),r=document.createElement("span"),i=document.createElement("button");e.className="tool",r.textContent=this.node.attrs.info,r.className="info",i.type="button",i.addEventListener("click",function(){return t.openEditor()}),e.appendChild(r),e.appendChild(i),this.wrapper.appendChild(e)},n.prototype.renderCustomBlock=function(){var t=this.toDOMAdaptor.getToDOMNode(this.node.attrs.info);if(t){for(var e=t(this.node);this.wrapper.hasChildNodes();)this.wrapper.removeChild(this.wrapper.lastChild);e&&this.wrapper.appendChild(e),this.renderToolArea()}},n.prototype.createInnerViewContainer=function(){this.innerViewContainer=document.createElement("div"),this.innerViewContainer.className=J("custom-block-editor"),this.innerViewContainer.style.display="none"},n.prototype.closeEditor=function(){this.innerEditorView&&(this.innerEditorView.destroy(),this.innerEditorView=null,this.innerViewContainer.style.display="none"),this.wrapper.style.display="block"},n.prototype.saveAndFinishEditing=function(){var t=this.editorView.state.selection.to,e=this.editorView.state;this.editorView.dispatch(e.tr.setSelection(wt(e.tr,t))),this.editorView.focus(),this.renderCustomBlock(),this.closeEditor()},n.prototype.cancelEditing=function(){var t=function(i){let o=sn.getState(i);return o?o.done.eventCount:0}(this.innerEditorView.state);for(this.canceled=!0;t--;)Di(this.innerEditorView.state,this.innerEditorView.dispatch),Di(this.editorView.state,this.editorView.dispatch);this.canceled=!1;var e=this.editorView.state.selection.to,r=this.editorView.state;this.editorView.dispatch(r.tr.setSelection(dt.create(r.doc,e))),this.editorView.focus(),this.closeEditor()},n.prototype.dispatchInner=function(t){var e=this.innerEditorView.state.applyTransaction(t),r=e.state,i=e.transactions;if(this.innerEditorView.updateState(r),!this.canceled&&Te()(this.getPos)){for(var o=this.editorView.state.tr,s=Xt.offset(this.getPos()+1),a=0;a<i.length;a+=1)for(var l=i[a].steps,c=0;c<l.length;c+=1)o.step(l[c].map(s));o.docChanged&&this.editorView.dispatch(o)}},n.prototype.update=function(t){return!!t.sameMarkup(this.node)&&(this.node=t,this.innerEditorView||this.renderCustomBlock(),!0)},n.prototype.stopEvent=function(t){return!!this.innerEditorView&&!!t.target&&this.innerEditorView.dom.contains(t.target)},n.prototype.ignoreMutation=function(){return!0},n.prototype.destroy=function(){this.dom.removeEventListener("dblclick",this.openEditor),this.closeEditor()},n}(),Gd="image-link",Pv=function(){function n(t,e,r,i){var o,s=this;this.handleMousedown=function(a){a.preventDefault();var l=a.target,c=a.offsetX,u=a.offsetY;if(s.imageLink&&Te()(s.getPos)&&tu()(l,Gd)){var d=getComputedStyle(l,":before");if(a.stopPropagation(),la(d,c,u)){var p=s.view.state.tr,h=s.getPos();p.setSelection(wt(p,h,h+1)),s.view.dispatch(p),s.eventEmitter.emit("openPopup","link",s.imageLink.attrs)}}},this.node=t,this.view=e,this.getPos=r,this.eventEmitter=i,this.imageLink=(o=t.marks.filter(function(a){return a.type.name==="link"})[0])!==null&&o!==void 0?o:null,this.dom=this.createElement(),this.bindEvent()}return n.prototype.createElement=function(){var t=this.createImageElement(this.node);if(this.imageLink){var e=document.createElement("span");return e.className=Gd,e.appendChild(t),e}return t},n.prototype.createImageElement=function(t){var e=document.createElement("img"),r=t.attrs,i=r.imageUrl,o=r.altText,s=Nt(t.attrs);return e.src=i,o&&(e.alt=o),da(s,e),e},n.prototype.bindEvent=function(){this.imageLink&&this.dom.addEventListener("mousedown",this.handleMousedown)},n.prototype.stopEvent=function(){return!0},n.prototype.destroy=function(){this.imageLink&&this.dom.removeEventListener("mousedown",this.handleMousedown)},n}(),Fv=function(){function n(t,e,r,i){var o=this;this.contentDOM=null,this.input=null,this.timer=null,this.handleMousedown=function(s){var a=s.target;if(getComputedStyle(a,":after").backgroundImage!=="none"&&Te()(o.getPos)){var l=o.view.coordsAtPos(o.getPos()),c=l.top,u=l.right;o.createLanguageEditor({top:c,right:u})}},this.handleKeydown=function(s){s.key==="Enter"&&o.input&&(s.preventDefault(),o.changeLanguage())},this.node=t,this.view=e,this.getPos=r,this.eventEmitter=i,this.createElement(),this.bindDOMEvent(),this.bindEvent()}return n.prototype.createElement=function(){var t=this.node.attrs.language,e=document.createElement("div");e.setAttribute("data-language",t||"text"),e.className="toastui-editor-ww-code-block";var r=this.createCodeBlockElement(),i=r.firstChild;e.appendChild(r),this.dom=e,this.contentDOM=i},n.prototype.createCodeBlockElement=function(){var t=document.createElement("pre"),e=document.createElement("code"),r=this.node.attrs.language,i=Nt(this.node.attrs);return r&&e.setAttribute("data-language",r),da(i,t),t.appendChild(e),t},n.prototype.createLanguageEditor=function(t){var e=this,r=t.top,i=t.right,o=document.createElement("span");o.className="toastui-editor-ww-code-block-language";var s=document.createElement("input");s.type="text",s.value=this.node.attrs.language,o.appendChild(s),this.view.dom.parentElement.appendChild(o);var a=o.clientWidth;ae()(o,{top:r+10+"px",left:i-a-10+"px",width:a+"px"}),this.input=s,this.input.addEventListener("blur",function(){return e.changeLanguage()}),this.input.addEventListener("keydown",this.handleKeydown),this.clearTimer(),this.timer=setTimeout(function(){e.input.focus()})},n.prototype.bindDOMEvent=function(){this.dom&&this.dom.addEventListener("click",this.handleMousedown)},n.prototype.bindEvent=function(){var t=this;this.eventEmitter.listen("scroll",function(){t.input&&t.reset()})},n.prototype.changeLanguage=function(){if(this.input&&Te()(this.getPos)){var t=this.input.value;this.reset();var e=this.getPos(),r=this.view.state.tr;r.setNodeMarkup(e,null,{language:t}),this.view.dispatch(r)}},n.prototype.reset=function(){var t;if(!((t=this.input)===null||t===void 0)&&t.parentElement){var e=this.input.parentElement;this.input=null,cr(e)}},n.prototype.clearTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},n.prototype.stopEvent=function(){return!0},n.prototype.update=function(t){return!!t.sameMarkup(this.node)&&(this.node=t,!0)},n.prototype.destroy=function(){this.reset(),this.clearTimer(),this.dom&&this.dom.removeEventListener("click",this.handleMousedown)},n}(),Bv=/MsoListParagraph/,Jd=/style=(.|\n)*mso-/,Yd=/mso-list:(.*)/,Hv=/O:P/,zv=/^(n|u|l)/;function _v(n){for(var t=[],e=document.createTreeWalker(n,1,null,!1);e.nextNode();){var r=e.currentNode;if(To(r)){var i=r,o=i.outerHTML,s=i.textContent,a=Jd.test(o),l=Yd.test(o);a&&!l&&s?t.push([r,!0]):(Hv.test(r.nodeName)||a&&!s||l)&&t.push([r,!1])}}return t.forEach(function(c){var u=c[0];c[1]?function(d){for(var p=[];d.firstChild;)p.push(d.firstChild),d.parentNode&&d.parentNode.insertBefore(d.firstChild,d);cr(d)}(u):cr(u)}),n.innerHTML.trim()}function qv(n){var t=[];return n.forEach(function(e,r){var i=t[r-1],o=function(s,a){var l=s.getAttribute("style");if(l){var c=l.match(Yd)[1].trim().split(" ")[1];return{id:a,level:parseInt(c.replace("level",""),10),prev:null,parent:null,children:[],unordered:zv.test(s.textContent||""),contents:_v(s)}}return null}(e,r);o&&(i&&function(s,a){if(a.level<s.level)a.children.push(s),s.parent=a;else{for(;a&&a.level!==s.level;)a=a.parent;a&&(s.prev=a,s.parent=a.parent,s.parent&&s.parent.children.push(s))}}(o,i),t.push(o))}),t}function Qd(n){var t=n[0].unordered?"ul":"ol",e=document.createElement(t);return n.forEach(function(r){var i=r.children,o=r.contents,s=document.createElement("li");s.innerHTML=o,e.appendChild(s),i.length&&e.appendChild(Qd(i))}),e}function $v(n){return Qd(qv(n).filter(function(t){return!t.parent}))}function jv(n){var t=document.createElement("div");t.innerHTML=n;var e,r,i,o=[],s=(e=t,r="p.MsoListParagraph",(i=rn()(e.querySelectorAll(r))).length?i:[]);return s.forEach(function(a){var l=function(d){for(;d&&!To(d);)d=d.nextSibling;return!d||!Bv.test(d.className)}(a.nextSibling);if(o.push(a),l){var c=$v(o),u=a.nextSibling;u?function(d,p){p.parentNode&&p.parentNode.insertBefore(d,p)}(c,u):function(d,p){(p=sa()(p)?rn()(p):[p]).forEach(function(h){d.appendChild(h)})}(t,c),o=[]}cr(a)}),(s.length?"<p></p>":"")+t.innerHTML}var Xd="<!--StartFragment-->";function Vv(n){return function(t){return Jd.test(t)}(n=function(t){return/<\/td>((?!<\/tr>)[\s\S])*$/i.test(t)&&(t="<tr>"+t+"</tr>"),/<\/tr>((?!<\/table>)[\s\S])*$/i.test(t)&&(t="<table>"+t+"</table>"),t}(n=function(t){var e=t.indexOf(Xd),r=t.lastIndexOf("<!--EndFragment-->");return e>-1&&r>-1&&(t=t.slice(e+Xd.length,r)),t.replace(/<br[^>]*>/g,iu)}(n)))&&(n=jv(n)),n}function Zd(n,t,e){for(var r=[],i=n.childCount,o=0;o<i;o+=1)if(!n.child(o).attrs.extended){var s=o<i?e.create(n.child(o).attrs,n.child(o).content):e.createAndFill();r.push(s)}return r}function tp(n,t,e){var r=e.nodes,i=r.tableRow,o=Zd(n,0,r.tableHeadCell);return i.create(null,o)}function ep(n,t,e){var r=e.nodes,i=r.tableRow,o=Zd(n,0,r.tableBodyCell);return i.create(null,o)}function np(n){var t=[],e=[];return n.firstChild.type.name==="tableHead"&&n.firstChild.forEach(function(r){return t.push(r)}),n.lastChild.type.name==="tableBody"&&n.lastChild.forEach(function(r){return e.push(r)}),M(M([],t),e)}function Uv(n,t,e){var r=tp(n,0,e);return e.nodes.tableHead.create(null,r)}function rp(n,t,e){var r=n.map(function(o){return ep(o,0,e)});if(!n.length){var i=function(o,s){for(var a=s.nodes,l=a.tableRow,c=a.tableBodyCell,u=[],d=0;d<o;d+=1){var p=c.createAndFill();u.push(p)}return l.create({dummyRowForPasting:!0},u)}(t,e);r.push(i)}return e.nodes.tableBody.create(null,r)}function Wv(n,t,e){var r=[],i=n.content,o=n.openStart,s=n.openEnd;return i.forEach(function(a){if(a.type.name==="table"){var l=Ud(new j(S.from(a),0,0));if(l){var c=np(l),u=l.firstChild.type.name==="tableBody",d=function(p,h,f,m){var g=function(L){return L.reduce(function(P,A){return P.childCount>A.childCount?P:A}).childCount}(p);if(f&&m)return h.nodes.table.create(null,[rp(p,g,h)]);var w=p[0],C=p.slice(1),E=[Uv(w,0,h)];return C.length&&E.push(rp(C,g,h)),h.nodes.table.create(null,E)}(c,t,u,e);r.push(d)}}else r.push(a)}),new j(S.from(r),o,s)}function Ko(n){return 4*n}function Kv(n,t){var e=n.state,r=e.selection,i=e.schema,o=e.tr,s=tn(r),a=s.anchor,l=s.head;if(a&&l){var c=Ud(t);if(!c)return!1;var u=Qt.create(a),d=u.getRectOffsets(a,l),p=function(m,g,w){var C=[],E=np(m),L=(E[0].childCount,E.length),P=g.startRowIdx===0,A=E.slice(0,L);if(P){var H=A.shift();if(H){var B=tp(H,0,w).content;C.push(B)}}return A.forEach(function(z){if(!z.attrs.dummyRowForPasting){var q=ep(z,0,w).content;C.push(q)}}),C}(c,d,i),h=function(m,g,w){for(var C=g.startRowIdx,E=g.startColIdx,L=w.length,P=0,A=function(q){var _=w[q].childCount;w[q].forEach(function(Y){var K=Y.attrs.colspan;K>1&&(_+=K-1)}),P=Math.max(P,_)},H=0;H<L;H+=1)A(H);var B=C+L-1,z=E+P-1;return{startRowIdx:C,startColIdx:E,endRowIdx:B,endColIdx:z,addedRowCount:Math.max(B+1-m.totalRowCount,0),addedColumnCount:Math.max(z+1-m.totalColumnCount,0)}}(u,d,p),f=[];return function(m,g){var w=ei(m.getSpannedOffsets(g)),C=w.rowCount,E=w.columnCount,L=ei(g),P=L.rowCount,A=L.columnCount;return C===P&&E===A}(u,h)&&(function(m,g){for(var w=m.startRowIdx,C=m.startColIdx,E=m.endRowIdx,L=m.endColIdx,P=m.addedRowCount,A=m.addedColumnCount,H=w;H<=E-P;H+=1)g.push({rowIdx:H,startColIdx:C,endColIdx:L-A})}(h,f),h.addedColumnCount&&function(m,g,w,C,E){for(var L=C.startRowIdx,P=C.startColIdx,A=C.endRowIdx,H=C.endColIdx,B=C.addedRowCount,z=C.addedColumnCount,q=w.totalRowCount,_=0,Y=0;Y<q;Y+=1){var K=w.getCellInfo(Y,H-z),ot=K.offset,pt=K.nodeSize,Tt=m.mapping.map(ot+pt),ne=Wo(z,Y,g);if(m.insert(Tt,ne),Y>=L&&Y<=A-B){var ft=w.getCellInfo(Y,H-z),dn=m.mapping.map(ft.offset),Me=Tt+Ko(z);E[_]={rowIdx:Y,startColIdx:P,endColIdx:H,dummyOffsets:[dn,Me]},_+=1}}}(o,i,u,h,f),h.addedRowCount&&function(m,g,w,C,E){var L=C.addedRowCount,P=C.addedColumnCount,A=C.startColIdx,H=C.endColIdx,B=m.mapping.maps.length,z=w.tableEndOffset-2,q=$d(L,w.totalColumnCount+P,g),_=z;m.insert(m.mapping.slice(B).map(_),q);for(var Y=0;Y<L;Y+=1){var K=_+Ko(A)+1,ot=_+Ko(H+1)+1,pt=_+Ko(w.totalColumnCount+P)+2;E.push({rowIdx:Y+w.totalRowCount,startColIdx:A,endColIdx:H,dummyOffsets:[K,ot]}),_=pt}}(o,i,u,h,f),function(m,g,w,C){var E=m.mapping.maps.length;w.forEach(function(L,P){var A=L.rowIdx,H=L.startColIdx,B=L.endColIdx,z=L.dummyOffsets,q=m.mapping.slice(E),_=new j(g[P],0,0),Y=z?z[0]:C.getCellStartOffset(A,H),K=z?z[1]:C.getCellEndOffset(A,B);m.replace(q.map(Y),q.map(K),_)})}(o,p,f,u),n.dispatch(o),function(m,g,w){var C=m.state,E=C.tr,L=C.doc,P=Qt.create(L.resolve(w)),A=g[0],H=A.rowIdx,B=A.startColIdx,z=At(g),q=z.rowIdx,_=z.endColIdx,Y=P.getCellInfo(H,B).offset,K=P.getCellInfo(q,_).offset;m.dispatch(E.setSelection(new tl(L.resolve(Y),L.resolve(K))))}(n,f,u.getCellInfo(0,0).offset)),!0}return!1}var vt,Gv=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"doc"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"block+"}},enumerable:!1,configurable:!0}),t}(bt),Jv=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"paragraph"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"inline*",group:"block",attrs:v({},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:[{tag:"p"}],toDOM:function(e){return["p",Nt(e.attrs),0]}}},enumerable:!1,configurable:!0}),t}(bt),Yv=/\s{1,4}$/,Qv=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"text"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{group:"inline"}},enumerable:!1,configurable:!0}),t.prototype.addSpaces=function(){return function(e,r){var i=e.selection,o=e.tr,s=i.$from,a=i.$to;return!(!s.blockRange(a)||Zr(s)||Vo(s))&&(r(o.insertText("    ",s.pos,a.pos)),!0)}},t.prototype.removeSpaces=function(){return function(e,r){var i=e.selection,o=e.tr,s=i.$from,a=i.$to,l=i.from;if(s.blockRange(a)&&!Zr(s)&&!Vo(s)){var c=s.nodeBefore;if(c&&c.isText){var u=c.text,d=u.replace(Yv,""),p=u.length-d.length;return r(o.delete(l-p,l)),!0}}return!1}},t.prototype.keymaps=function(){return{Tab:this.addSpaces(),"Shift-Tab":this.removeSpaces()}},t}(bt),Xv=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"heading"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"levels",{get:function(){return[1,2,3,4,5,6]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){var e=this.levels.map(function(r){return{tag:"h"+r,getAttrs:function(i){var o=i.getAttribute("data-raw-html");return v({level:r},o&&{rawHTML:o})}}});return{attrs:v({level:{default:1},headingType:{default:"atx"},rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),content:"inline*",group:"block",defining:!0,parseDOM:e,toDOM:function(r){var i=r.attrs;return["h"+i.level,Nt(i),0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(e){return function(r,i){return Xs(r.schema.nodes[e.level?"heading":"paragraph"],e)(r,i)}}},t}(bt),Zv=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"codeBlock"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"text*",group:"block",attrs:v({language:{default:null},rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),code:!0,defining:!0,marks:"",parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:function(e){var r=e.getAttribute("data-raw-html"),i=e.firstElementChild;return v({language:i?.getAttribute("data-language")||null},r&&{rawHTML:r})}}],toDOM:function(e){var r=e.attrs;return[r.rawHTML||"pre",["code",v({"data-language":r.language},Nt(r)),0]]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(){return function(e,r){return Xs(e.schema.nodes.codeBlock)(e,r)}}},t.prototype.moveCursor=function(e){var r=this;return function(i,o){var s,a,l=i.tr,c=i.doc,u=i.schema,d=i.selection.$from;if(r.context.view.endOfTextblock(e)&&d.node().type.name==="codeBlock"){var p=d.parent.textContent.split(`
`),h=e==="up"?d.start():d.end(),f=e==="up"?[h,p[0].length+h]:[h-At(p).length,h],m=c.resolve(e==="up"?d.before():d.after()),g=e==="up"?m.nodeBefore:m.nodeAfter;if(s=d.pos,a=f[1],s>=f[0]&&s<=a&&!g){var w=ra(l,m,u);if(w)return o(w),!0}}return!1}},t.prototype.keymaps=function(){var e=this.commands()();return{"Shift-Mod-p":e,"Shift-Mod-P":e,ArrowUp:this.moveCursor("up"),ArrowDown:this.moveCursor("down")}},t}(bt),ty=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"bulletList"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"listItem+",group:"block",attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:[Uo("ul")],toDOM:function(e){return["ul",Nt(e.attrs),0]}}},enumerable:!1,configurable:!0}),t.prototype.changeList=function(){return function(e,r){return _d(e.schema.nodes.bulletList)(e,r)}},t.prototype.commands=function(){return{bulletList:this.changeList,taskList:fv}},t.prototype.keymaps=function(){var e=this.changeList(),r=Xa(),i=r.indent,o=r.outdent;return{"Mod-u":e,"Mod-U":e,Tab:i(),"Shift-Tab":o()}},t}(bt),ey=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"orderedList"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"listItem+",group:"block",attrs:v({order:{default:1},rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:[{tag:"ol",getAttrs:function(e){var r=e.getAttribute("start"),i=e.getAttribute("data-raw-html");return v({order:e.hasAttribute("start")?Number(r):1},i&&{rawHTML:i})}}],toDOM:function(e){var r=e.attrs;return[r.rawHTML||"ol",v({start:r.order===1?null:r.order},Nt(r)),0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(){return function(e,r){return _d(e.schema.nodes.orderedList)(e,r)}}},t.prototype.keymaps=function(){var e=this.commands()(),r=Xa(),i=r.indent,o=r.outdent;return{"Mod-o":e,"Mod-O":e,Tab:i(),"Shift-Tab":o()}},t}(bt),ny=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"listItem"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"paragraph block*",selectable:!1,attrs:{task:{default:!1},checked:{default:!1},rawHTML:{default:null}},defining:!0,parseDOM:[{tag:"li",getAttrs:function(e){var r=e.getAttribute("data-raw-html");return v({task:e.hasAttribute("data-task"),checked:e.hasAttribute("data-task-checked")},r&&{rawHTML:r})}}],toDOM:function(e){var r=e.attrs,i=r.task,o=r.checked;if(!i)return[r.rawHTML||"li",0];var s=["task-list-item"];return o&&s.push("checked"),[r.rawHTML||"li",v({class:s.join(" "),"data-task":i},o&&{"data-task-checked":o}),0]}}},enumerable:!1,configurable:!0}),t.prototype.liftToPrevListItem=function(){return function(e,r){var i=e.selection,o=e.tr,s=e.schema,a=i.$from,l=i.empty,c=s.nodes.listItem,u=a.parent,d=a.node(-1);if(l&&!u.childCount&&d.type===c){if(a.index(-2)>=1)return o.delete(a.start(-1)-1,a.end(-1)),r(o),!0;if(a.node(-3).type===c)return o.delete(a.start(-2)-1,a.end(-1)),r(o),!0}return!1}},t.prototype.keymaps=function(){return{Backspace:this.liftToPrevListItem(),Enter:function(e,r){return function(i){return function(o,s){var a=o.tr,l=o.selection,c=l.$from,u=l.$to;if(c.depth<2||!c.sameParent(u))return!1;var d=c.node(-1);if(d.type!==i)return!1;if(c.parent.content.size===0&&c.node(-1).childCount===c.indexAfter(-1)){if(c.depth===2||c.node(-3).type!==i||c.index(-2)!==c.node(-2).childCount-1)return!1;for(var p=c.index(-1)>0,h=S.empty,f=c.depth-(p?1:2);f>=c.depth-3;f-=1)h=S.from(c.node(f).copy(h));return h=h.append(S.from(i.createAndFill())),a.replace(p?c.before():c.before(-1),c.after(-3),new j(h,p?3:2,2)),a.setSelection(G.near(a.doc.resolve(c.pos+(p?3:2)))),s(a),!0}var m=u.pos===c.end()?d.contentMatchAt(0).defaultType:null,g=m&&[null,{type:m}];return a.delete(c.pos,u.pos),!!Ge(a.doc,c.pos,2,g)&&(a.split(c.pos,2,g),s(a),!0)}}(e.schema.nodes.listItem)(e,r)}}},t}(bt),ry=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"blockQuote"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),content:"block+",group:"block",parseDOM:[Uo("blockquote")],toDOM:function(e){return["blockquote",Nt(e.attrs),0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(){return function(e,r){return mf(e.schema.nodes.blockQuote)(e,r)}}},t.prototype.keymaps=function(){var e=this.commands()();return{"Alt-q":e,"Alt-Q":e}},t}(bt),iy={left:function(n,t){var e=n[0],r=n[1],i=t.totalColumnCount,o=r===0;if(e!==0||!o){r-=1,o&&(e-=1,r=i-1);var s=t.getCellInfo(e,r),a=s.offset,l=s.nodeSize;return a+l-2}return null},right:function(n,t){var e=n[0],r=n[1],i=t.totalRowCount,o=t.totalColumnCount,s=r===o-1;if(e!==i-1||!s){var a=r+1,l=t.getColspanStartInfo(e,r);return l?.count>1&&(a+=l.count-1),(s||a===o)&&(e+=1,a=0),t.getCellInfo(e,a).offset+2}return null},up:function(n,t){var e=n[0],r=n[1];if(e>0){var i=t.getCellInfo(e-1,r),o=i.offset,s=i.nodeSize;return o+s-2}return null},down:function(n,t){var e=n[0],r=n[1],i=t.totalRowCount;if(e<i-1){var o=e+1,s=t.getRowspanStartInfo(e,r);return s?.count>1&&(o+=s.count-1),t.getCellInfo(o,r).offset+2}return null}};function oy(n,t,e,r){var i=t[0],o=t[1],s=i+3,a=o>=s,l=a?i+1:o,c=function(d,p,h,f,m){var g=p[0],w=p[1],C=p[2];if(d===vt.LEFT||d===vt.UP){if(m&&!function(L,P,A){var H=A[0],B=A[1],z=P.resolve(L.before(H-1));return B===H&&!z.nodeBefore}(h,f,[g,w]))return!1;var E=h.before(C);if(f.resolve(E).nodeBefore)return!1}return!0}(n,[o,s,l],e,r,a),u=function(d,p,h,f,m){if(d===vt.RIGHT||d===vt.DOWN){if(m&&!function(w){for(var C,E,L=w.depth;L&&(E=w.node(L)).type.name!=="tableBodyCell";){if(E.type.name==="listItem"){var P=w.node(L-1).lastChild===E,A=((C=E.lastChild)===null||C===void 0?void 0:C.type.name)!=="paragraph";return!!P&&!A}L-=1}return!1}(h))return!1;var g=h.after(p);if(f.resolve(g).nodeAfter)return!1}return!0}(n,l,e,r,a);return c&&u}function ip(n,t,e){var r=e[0],i=e[1],o=t.getRowspanStartInfo(r,i),s=n===vt.UP&&r===0,a=n===vt.DOWN&&(o?.count>1?r+o.count-1:r)===t.totalRowCount-1;return s||a}function rl(n,t,e,r){r===void 0&&(r=!1);var i=n.doc.resolve(t.tableEndOffset);return r||!i.nodeAfter?ra(n,i,e):n.setSelection(G.near(i,1))}function op(n,t,e,r){var i=(0,iy[n])(e,r);if(i){var o=n===vt.RIGHT||n===vt.DOWN?1:-1;return t.setSelection(G.near(t.doc.resolve(i),o))}return null}function sy(n,t,e){var r=n.getCellInfo(t,0).offset,i=n.getCellInfo(t,e-1);return{from:r,to:i.offset+i.nodeSize}}(function(n){n.LEFT="left",n.RIGHT="right",n.UP="up",n.DOWN="down"})(vt||(vt={}));var ay=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"table"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"tableHead{1} tableBody{1}",group:"block",attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:[Uo("table")],toDOM:function(e){return["table",Nt(e.attrs),0]}}},enumerable:!1,configurable:!0}),t.prototype.addTable=function(){return function(e){return e===void 0&&(e={rowCount:2,columnCount:1,data:[]}),function(r,i){var o=e.rowCount,s=e.columnCount,a=e.data,l=r.schema,c=r.selection,u=r.tr,d=c.from,p=c.to,h=c.$from;if(d===p&&!Vo(h)){var f=l.nodes,m=f.tableHead,g=f.tableBody,w=a?.slice(0,s),C=a?.slice(s,a.length),E=function(A,H,B){for(var z=H.nodes,q=z.tableRow,_=z.tableHeadCell,Y=z.paragraph,K=[],ot=0;ot<A;ot+=1){var pt=B&&B[ot],Tt=Y.create(null,pt?H.text(pt):[]);K.push(_.create(null,Tt))}return[q.create(null,K)]}(s,l,w),L=$d(o-1,s,l,C),P=l.nodes.table.create(null,[m.create(null,E),g.create(null,L)]);return i(u.replaceSelectionWith(P)),!0}return!1}}},t.prototype.removeTable=function(){return function(){return function(e,r){var i=e.selection,o=e.tr,s=Qt.create(i.$anchor);if(s){var a=s.tableStartOffset,l=s.tableEndOffset,c=a-1,u=wt(o.delete(c,l),c);return r(o.setSelection(u)),!0}return!1}}},t.prototype.addColumn=function(e){return function(){return function(r,i){var o=r.selection,s=r.tr,a=r.schema,l=tn(o),c=l.anchor,u=l.head;if(c&&u){for(var d=Qt.create(c),p=d.getRectOffsets(c,u),h=e===vt.LEFT?p.startColIdx:p.endColIdx+1,f=ei(p).columnCount,m=d.totalRowCount,g=0;g<m;g+=1){var w=Wo(f,g,a);s.insert(s.mapping.map(d.posAt(g,h)),w)}return i(s),!0}return!1}}},t.prototype.removeColumn=function(){return function(){return function(e,r){var i=e.selection,o=e.tr,s=tn(i),a=s.anchor,l=s.head;if(a&&l){var c=Qt.create(a),u=c.getRectOffsets(a,l),d=c.totalColumnCount,p=c.totalRowCount;if(ei(u).columnCount===d)return!1;for(var h=u.startColIdx,f=u.endColIdx,m=o.mapping.maps.length,g=0;g<p;g+=1)for(var w=f;w>=h;w-=1){var C=c.getCellInfo(g,w),E=C.offset,L=C.nodeSize,P=o.mapping.slice(m).map(E),A=P+L;o.delete(P,A)}return r(o),!0}return!1}}},t.prototype.addRow=function(e){return function(){return function(r,i){var o=r.selection,s=r.schema,a=r.tr,l=tn(o),c=l.anchor,u=l.head;if(c&&u){var d=Qt.create(c),p=d.totalColumnCount,h=d.getRectOffsets(c,u),f=ei(h).rowCount,m=function(B,z,q){var _,Y,K;return B===vt.UP?(_=q.startRowIdx,Y=0,K=-1):(_=q.endRowIdx,Y=z.totalColumnCount-1,K=z.getCellInfo(_,Y).nodeSize+1),{targetRowIdx:_,insertColIdx:Y,nodeSize:K}}(e,d,h),g=m.targetRowIdx,w=m.insertColIdx,C=m.nodeSize;if(g!==0){for(var E=[],L=a.mapping.map(d.posAt(g,w))+C,P=[],A=0;A<p;A+=1)P=P.concat(Wo(1,g,s));for(var H=0;H<f;H+=1)E.push(s.nodes.tableRow.create(null,P));return i(a.insert(L,E)),!0}}return!1}}},t.prototype.removeRow=function(){return function(){return function(e,r){var i=e.selection,o=e.tr,s=tn(i),a=s.anchor,l=s.head;if(a&&l){var c=Qt.create(a),u=c.totalRowCount,d=c.totalColumnCount,p=c.getRectOffsets(a,l),h=ei(p).rowCount,f=p.startRowIdx,m=p.endRowIdx;if(h===u-1||f===0)return!1;for(var g=m;g>=f;g-=1){var w=sy(c,g,d),C=w.from,E=w.to;o.delete(C-1,E+1)}return r(o),!0}return!1}}},t.prototype.alignColumn=function(){return function(e){return e===void 0&&(e={align:"center"}),function(r,i){var o=e.align,s=r.selection,a=r.tr,l=tn(s),c=l.anchor,u=l.head;if(c&&u){for(var d=Qt.create(c),p=d.totalRowCount,h=d.getRectOffsets(c,u),f=h.startColIdx,m=h.endColIdx,g=0;g<p;g+=1)for(var w=f;w<=m;w+=1)if(!d.extendedRowspan(g,w)&&!d.extendedColspan(g,w)){var C=d.getNodeAndPos(g,w),E=C.node,L=C.pos,P=bv(E,{align:o});a.setNodeMarkup(L,null,P)}return i(a),!0}return!1}}},t.prototype.moveToCell=function(e){return function(r,i){var o=r.selection,s=r.tr,a=r.schema,l=tn(o),c=l.anchor,u=l.head;if(c&&u){var d=Qt.create(c),p=d.getCellIndex(c),h=void 0;if(h=ip(e,d,p)?rl(s,d,a):op(e,s,p,d))return i(h),!0}return!1}},t.prototype.moveInCell=function(e){var r=this;return function(i,o){var s=i.selection,a=i.tr,l=i.doc,c=i.schema,u=s.$from;if(!r.context.view.endOfTextblock(e))return!1;var d=un(u,function(C){var E=C.type;return E.name==="tableHeadCell"||E.name==="tableBodyCell"});if(d){var p=un(u,function(C){return C.type.name==="paragraph"}),h=d.depth;if(p&&oy(e,[h,p.depth],u,l)){var f=tn(s).anchor,m=Qt.create(f),g=m.getCellIndex(f),w=void 0;if(function(C,E,L){var P=L[0],A=L[1];if(C===vt.UP||C===vt.DOWN)return!1;var H=E.tableStartOffset,B=E.tableEndOffset,z=E.getCellInfo(P,A),q=z.offset,_=z.nodeSize;return(C===vt.LEFT?H:B)===(C===vt.LEFT?q-2:q+_+3)}(e,m,g)?w=function(C,E,L){var P=C.doc.resolve(E.before(L-3));return C.setSelection(new at(P))}(a,u,h):ip(e,m,g)?e===vt.UP?w=function(C,E,L){var P=C.doc.resolve(E.tableStartOffset-1);return P.nodeBefore?C.setSelection(G.near(P,-1)):ra(C,P,L)}(a,m,c):e===vt.DOWN&&(w=rl(a,m,c)):w=op(e,a,g,m),w)return o(w),!0}}return!1}},t.prototype.deleteCells=function(){return function(e,r){var i=e.schema,o=e.selection,s=e.tr,a=tn(o),l=a.anchor,c=a.head;if(l&&c&&!(o instanceof dt)){for(var u=Qt.create(l),d=u.getRectOffsets(l,c),p=d.startRowIdx,h=d.startColIdx,f=d.endRowIdx,m=d.endColIdx,g=p;g<=f;g+=1)for(var w=h;w<=m;w+=1)if(!u.extendedRowspan(g,w)&&!u.extendedColspan(g,w)){var C=u.getNodeAndPos(g,w),E=C.node,L=C.pos,P=Wo(1,g,i,E.attrs);s.replaceWith(s.mapping.map(L),s.mapping.map(L+E.nodeSize),P)}return r(s),!0}return!1}},t.prototype.exitTable=function(){return function(e,r){var i=e.selection,o=e.tr,s=e.schema,a=i.$from;if(un(a,function(c){var u=c.type;return u.name==="tableHeadCell"||u.name==="tableBodyCell"})&&un(a,function(c){return c.type.name==="paragraph"})){var l=tn(i).anchor;return r(rl(o,Qt.create(l),s,!0)),!0}return!1}},t.prototype.commands=function(){return{addTable:this.addTable(),removeTable:this.removeTable(),addColumnToLeft:this.addColumn(vt.LEFT),addColumnToRight:this.addColumn(vt.RIGHT),removeColumn:this.removeColumn(),addRowToUp:this.addRow(vt.UP),addRowToDown:this.addRow(vt.DOWN),removeRow:this.removeRow(),alignColumn:this.alignColumn()}},t.prototype.keymaps=function(){var e=this.deleteCells();return{Tab:this.moveToCell(vt.RIGHT),"Shift-Tab":this.moveToCell(vt.LEFT),ArrowUp:this.moveInCell(vt.UP),ArrowDown:this.moveInCell(vt.DOWN),ArrowLeft:this.moveInCell(vt.LEFT),ArrowRight:this.moveInCell(vt.RIGHT),Backspace:e,"Mod-Backspace":e,Delete:e,"Mod-Delete":e,"Mod-Enter":this.exitTable()}},t}(bt),ly=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"tableHead"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"tableRow{1}",attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:[Uo("thead")],toDOM:function(e){return["thead",Nt(e.attrs),0]}}},enumerable:!1,configurable:!0}),t}(bt),cy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"tableBody"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"tableRow+",attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:[{tag:"tbody",getAttrs:function(e){var r=e.querySelectorAll("tr")[0].children.length,i=e.getAttribute("data-raw-html");return!!r&&v({},i&&{rawHTML:i})}}],toDOM:function(e){return["tbody",Nt(e.attrs),0]}}},enumerable:!1,configurable:!0}),t}(bt),uy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"tableRow"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"(tableHeadCell | tableBodyCell)*",attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:[{tag:"tr",getAttrs:function(e){var r=e.children.length,i=e.getAttribute("data-raw-html");return!!r&&v({},i&&{rawHTML:i})}}],toDOM:function(e){return["tr",Nt(e.attrs),0]}}},enumerable:!1,configurable:!0}),t}(bt),dy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"tableHeadCell"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"paragraph+",attrs:v({align:{default:null},className:{default:null},rawHTML:{default:null},colspan:{default:null},extended:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),isolating:!0,parseDOM:[Bd("th")],toDOM:function(e){var r=e.attrs,i=Fd(r);return["th",v(v({},i),Nt(r)),0]}}},enumerable:!1,configurable:!0}),t}(bt),py=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"tableBodyCell"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"(paragraph | bulletList | orderedList)+",attrs:{align:{default:null},className:{default:null},rawHTML:{default:null},colspan:{default:null},rowspan:{default:null},extended:{default:null}},isolating:!0,parseDOM:[Bd("td")],toDOM:function(e){return["td",Fd(e.attrs),0]}}},enumerable:!1,configurable:!0}),t}(bt),hy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"image"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{inline:!0,attrs:v({imageUrl:{default:""},altText:{default:null},rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),group:"inline",selectable:!1,parseDOM:[{tag:"img[src]",getAttrs:function(e){var r=hr(e,{RETURN_DOM_FRAGMENT:!0}).firstChild,i=r.getAttribute("src")||"",o=r.getAttribute("data-raw-html"),s=r.getAttribute("alt");return v({imageUrl:i,altText:s},o&&{rawHTML:o})}}],toDOM:function(e){var r=e.attrs;return[r.rawHTML||"img",v(v({src:je(r.imageUrl)},r.altText&&{alt:r.altText}),Nt(r))]}}},enumerable:!1,configurable:!0}),t.prototype.addImage=function(){return function(e){return function(r,i){var o=r.schema,s=r.tr,a=e,l=a.imageUrl,c=a.altText;if(!l)return!1;var u=o.nodes.image.createAndFill(v({imageUrl:l},c&&{altText:c}));return i(s.replaceSelectionWith(u).scrollIntoView()),!0}}},t.prototype.commands=function(){return{addImage:this.addImage()}},t}(bt),fy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"thematicBreak"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),group:"block",parseDOM:[{tag:"hr"}],selectable:!1,toDOM:function(e){var r=e.attrs;return["div",Nt(r),[r.rawHTML||"hr"]]}}},enumerable:!1,configurable:!0}),t.prototype.hr=function(){var e=this;return function(){return function(r,i){var o,s=r.selection,a=s.$from;if(a===s.$to){var l=r.doc,c=r.schema.nodes,u=c.thematicBreak,d=c.paragraph,p=[u.create()],h=a.node(1),f=l.child(l.childCount-1)===h,m=l.resolve(a.after(1)),g=((o=a.nodeAfter)===null||o===void 0?void 0:o.type.name)===e.name;return(f||g)&&p.push(d.create()),i(r.tr.insert(m.pos,p).scrollIntoView()),!0}return!1}}},t.prototype.commands=function(){return{hr:this.hr()}},t.prototype.keymaps=function(){var e=this.hr()();return{"Mod-l":e,"Mod-L":e}},t}(bt),my=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"strong"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){var e=["b","strong"].map(function(r){return{tag:r,getAttrs:function(i){var o=i.getAttribute("data-raw-html");return v({},o&&{rawHTML:o})}}});return{attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:e,toDOM:function(r){var i=r.attrs;return[i.rawHTML||"strong",Nt(i)]}}},enumerable:!1,configurable:!0}),t.prototype.bold=function(){return function(){return function(e,r){return Ai(e.schema.marks.strong)(e,r)}}},t.prototype.commands=function(){return{bold:this.bold()}},t.prototype.keymaps=function(){var e=this.bold()();return{"Mod-b":e,"Mod-B":e}},t}(kt),gy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"emph"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){var e=["i","em"].map(function(r){return{tag:r,getAttrs:function(i){var o=i.getAttribute("data-raw-html");return v({},o&&{rawHTML:o})}}});return{attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:e,toDOM:function(r){var i=r.attrs;return[i.rawHTML||"em",Nt(i)]}}},enumerable:!1,configurable:!0}),t.prototype.italic=function(){return function(){return function(e,r){return Ai(e.schema.marks.emph)(e,r)}}},t.prototype.commands=function(){return{italic:this.italic()}},t.prototype.keymaps=function(){var e=this.italic()();return{"Mod-i":e,"Mod-I":e}},t}(kt),vy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"strike"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){var e=["s","del"].map(function(r){return{tag:r,getAttrs:function(i){var o=i.getAttribute("data-raw-html");return v({},o&&{rawHTML:o})}}});return{attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:e,toDOM:function(r){var i=r.attrs;return[i.rawHTML||"del",Nt(i)]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(){return function(e,r){return Ai(e.schema.marks.strike)(e,r)}}},t.prototype.keymaps=function(){var e=this.commands()();return{"Mod-s":e,"Mod-S":e}},t}(kt),yy=function(n){function t(e){var r=n.call(this)||this;return r.linkAttributes=e,r}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"link"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){var e=this;return{attrs:v({linkUrl:{default:""},title:{default:null},rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function(r){var i=hr(r,{RETURN_DOM_FRAGMENT:!0}).firstChild,o=i.getAttribute("href")||"",s=i.getAttribute("title")||"",a=i.getAttribute("data-raw-html");return v({linkUrl:o,title:s},a&&{rawHTML:a})}}],toDOM:function(r){var i=r.attrs;return[i.rawHTML||"a",v(v({href:je(i.linkUrl)},e.linkAttributes),Nt(i))]}}},enumerable:!1,configurable:!0}),t.prototype.addLink=function(){return function(e){return function(r,i){var o=e,s=o.linkUrl,a=o.linkText,l=a===void 0?"":a,c=r.schema,u=r.tr,d=r.selection,p=d.empty,h=d.from,f=d.to;if(h&&f&&s){var m={linkUrl:s},g=c.mark("link",m);if(p&&l){var w=Jt(c,l,g);u.replaceRangeWith(h,f,w)}else u.addMark(h,f,g);return i(u.scrollIntoView()),!0}return!1}}},t.prototype.toggleLink=function(){return function(e){return function(r,i){return Ai(r.schema.marks.link,e)(r,i)}}},t.prototype.commands=function(){return{addLink:this.addLink(),toggleLink:this.toggleLink()}},t}(kt),by=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"code"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{attrs:v({rawHTML:{default:null}},{htmlAttrs:{default:null},classNames:{default:null}}),parseDOM:[{tag:"code",getAttrs:function(e){var r=e.getAttribute("data-raw-html");return v({},r&&{rawHTML:r})}}],toDOM:function(e){var r=e.attrs;return[r.rawHTML||"code",Nt(r)]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(){return function(e,r){return Ai(e.schema.marks.code)(e,r)}}},t.prototype.keymaps=function(){var e=this.commands()();return{"Shift-Mod-c":e,"Shift-Mod-C":e}},t}(kt),wy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"customBlock"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"text*",group:"block",attrs:{info:{default:null}},atom:!0,code:!0,defining:!0,parseDOM:[{tag:"div[data-custom-info]",getAttrs:function(e){return{info:e.getAttribute("data-custom-info")}}}],toDOM:function(e){return["div",{"data-custom-info":e.attrs.info||null},0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(e){return function(r,i){return!!e?.info&&Xs(r.schema.nodes.customBlock,e)(r,i)}}},t}(bt),ky=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"frontMatter"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"text*",group:"block",code:!0,defining:!0,parseDOM:[{preserveWhitespace:"full",tag:"div[data-front-matter]"}],toDOM:function(){return["div",{"data-front-matter":"true"},0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(){return function(e,r,i){var o=e.selection.$from;return!(!i.endOfTextblock("down")||o.node().type.name!=="frontMatter")&&Qs(e,r)}}},t.prototype.keymaps=function(){return{Enter:this.commands()()}},t}(bt),xy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),Object.defineProperty(t.prototype,"name",{get:function(){return"htmlComment"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return{content:"text*",group:"block",code:!0,defining:!0,parseDOM:[{preserveWhitespace:"full",tag:"div[data-html-comment]"}],toDOM:function(){return["div",{"data-html-comment":"true"},0]}}},enumerable:!1,configurable:!0}),t.prototype.commands=function(){return function(){return function(e,r,i){var o=e.selection.$from;return!(!i.endOfTextblock("down")||o.node().type.name!=="htmlComment")&&Qs(e,r)}}},t.prototype.keymaps=function(){return{Enter:this.commands()()}},t}(bt),Cy=J("contents"),Ey=function(n){function t(e,r){var i=n.call(this,e)||this,o=r.toDOMAdaptor,s=r.htmlSchemaMap,a=s===void 0?{}:s,l=r.linkAttributes,c=l===void 0?{}:l,u=r.useCommandShortcut,d=u===void 0||u,p=r.wwPlugins,h=p===void 0?[]:p,f=r.wwNodeViews,m=f===void 0?{}:f;return i.editorType="wysiwyg",i.el.classList.add("ww-mode"),i.toDOMAdaptor=o,i.linkAttributes=c,i.extraPlugins=h,i.pluginNodeViews=m,i.specs=i.createSpecs(),i.schema=i.createSchema(a),i.context=i.createContext(),i.keymaps=i.createKeymaps(d),i.view=i.createView(),i.commands=i.createCommands(),i.specs.setContext(v(v({},i.context),{view:i.view})),i.initEvent(),i}return k(t,n),t.prototype.createSpecs=function(){return e=this.linkAttributes,new hu([new Gv,new Jv,new Qv,new Xv,new Zv,new ty,new ey,new ny,new ry,new ay,new ly,new cy,new uy,new dy,new py,new hy,new fy,new my,new gy,new vy,new yy(e),new by,new wy,new ky,new du,new xy]);var e},t.prototype.createContext=function(){return{schema:this.schema,eventEmitter:this.eventEmitter}},t.prototype.createSchema=function(e){return new V({nodes:v(v({},this.specs.nodes),e.nodes),marks:v(v({},this.specs.marks),e.marks)})},t.prototype.createPlugins=function(){return M([new le({key:Fn,state:{init:function(){return null},apply:function(e,r){var i=e.getMeta(Fn);if(i)return i===-1?null:i;if(Wn()(r)||!e.docChanged)return r;var o=e.mapping.mapResult(r),s=o.deleted,a=o.pos;return s?null:a}},props:{decorations:Cv,createSelectionBetween:function(e){var r=e.state;return Wn()(Fn.getState(r))?null:r.selection}},view:function(e){return new kv(e)}}),Nv(this.eventEmitter),new le({props:{handleDOMEvents:{mousedown:function(e,r){var i=r,o=i.clientX,s=i.clientY,a=e.posAtCoords({left:o,top:s});if(a){var l=e.state,c=l.doc,u=l.tr,d=c.resolve(a.pos),p=ti(d),h=r.target,f=getComputedStyle(h,":before"),m=r,g=m.offsetX,w=m.offsetY;if(!p||!la(f,g,w))return!1;r.preventDefault();var C=d.before(p.depth),E=p.node.attrs;return u.setNodeMarkup(C,null,v(v({},E),{checked:!E.checked})),e.dispatch(u),!0}return!1}}}}),Dv(this.eventEmitter)],this.createPluginProps()).concat(this.defaultPlugins)},t.prototype.createPluginNodeViews=function(){var e=this.eventEmitter,r=this.pluginNodeViews,i={};return r&&Object.keys(r).forEach(function(o){i[o]=function(s,a,l){return r[o](s,a,l,e)}}),i},t.prototype.createView=function(){var e=this,r=this.toDOMAdaptor,i=this.eventEmitter;return new Ws(this.el,{state:this.createState(),attributes:{class:Cy},nodeViews:v({customBlock:function(o,s,a){return new Rv(o,s,a,r)},image:function(o,s,a){return new Pv(o,s,a,i)},codeBlock:function(o,s,a){return new Fv(o,s,a,i)},widget:uu},this.createPluginNodeViews()),dispatchTransaction:function(o){var s=e.view.state.applyTransaction(o).state;e.view.updateState(s),e.emitChangeEvent(o.scrollIntoView()),e.eventEmitter.emit("setFocusedNode",s.selection.$from.node(1))},transformPastedHTML:Vv,transformPasted:function(o){return Wv(o,e.schema,Vo(e.view.state.selection.$from))},handlePaste:function(o,s,a){return Kv(o,a)},handleKeyDown:function(o,s){return e.eventEmitter.emit("keydown",e.editorType,s),!1},handleDOMEvents:{paste:function(o,s){var a=s.clipboardData||window.clipboardData,l=a?.items;if(l){var c=rn()(l).some(function(d){return d.kind==="string"&&d.type==="text/rtf"});if(!c){var u=cu(l);u&&(s.preventDefault(),fa(e.eventEmitter,u,s.type))}}return!1},keyup:function(o,s){return e.eventEmitter.emit("keyup",e.editorType,s),!1},scroll:function(){return e.eventEmitter.emit("scroll","editor"),!0}}})},t.prototype.createCommands=function(){return this.specs.commands(this.view,Xa())},t.prototype.getHTML=function(){return pa(this.view.dom.innerHTML)},t.prototype.getModel=function(){return this.view.state.doc},t.prototype.getSelection=function(){var e=this.view.state.selection;return[e.from,e.to]},t.prototype.getSchema=function(){return this.view.state.schema},t.prototype.replaceSelection=function(e,r,i){var o=this.view.state,s=o.schema,a=o.tr,l=e.split(`
`).map(function(d){return bo(s,lr(d,s))}),c=new j(S.from(l),1,1),u=Oe()(r)&&Oe()(i)?a.replaceRange(r,i,c):a.replaceSelection(c);this.view.dispatch(u),this.focus()},t.prototype.deleteSelection=function(e,r){var i=this.view.state.tr,o=Oe()(e)&&Oe()(r)?i.deleteRange(e,r):i.deleteSelection();this.view.dispatch(o.scrollIntoView())},t.prototype.getSelectedText=function(e,r){var i=this.view.state,o=i.doc,s=i.selection,a=s.from,l=s.to;return Oe()(e)&&Oe()(r)&&(a=e,l=r),o.textBetween(a,l,`
`)},t.prototype.setModel=function(e,r){r===void 0&&(r=!1);var i=this.view.state,o=i.tr,s=i.doc;this.view.dispatch(o.replaceWith(0,s.content.size,e)),r&&this.moveCursorToEnd(!0)},t.prototype.setSelection=function(e,r){r===void 0&&(r=e);var i=this.view.state.tr,o=wt(i,e,r);this.view.dispatch(i.setSelection(o).scrollIntoView())},t.prototype.addWidget=function(e,r,i){var o=this.view,s=o.dispatch,a=o.state;s(a.tr.setMeta("widget",{pos:i??a.selection.to,node:e,style:r}))},t.prototype.replaceWithWidget=function(e,r,i){var o=this.view.state,s=o.tr,a=lr(i,o.schema);this.view.dispatch(s.replaceWith(e,r,a))},t.prototype.getRangeInfoOfNode=function(e){var r=this.view.state,i=r.doc,o=r.selection,s=e?i.resolve(e):o.$from,a=s.marks(),l=s.node(),c=s.start(),u=s.end(),d=l.type.name;if(a.length||d==="paragraph"){var p=a[a.length-1];d=p?p.type.name:"text",l.forEach(function(h,f){var m=h.isText,g=h.nodeSize,w=h.marks,C=s.pos-c;m&&f<=C&&f+g>=C&&function(E){return!E.length||St(E,p)}(w)&&(u=(c+=f)+g)})}return{range:[c,u],type:d}},t}(pu),Ty=Ey,Sy=b(404),My=b.n(Sy),sp=["afterPreviewRender","updatePreview","changeMode","needChangeMode","command","changePreviewStyle","changePreviewTabPreview","changePreviewTabWrite","scroll","contextmenu","show","hide","changeLanguage","changeToolbarState","toggleScrollSync","mixinTableOffsetMapPrototype","setFocusedNode","removePopupWidget","query","openPopup","closePopup","addImageBlobHook","beforePreviewRender","beforeConvertWysiwygToMarkdown","load","loadUI","change","caretChange","destroy","focus","blur","keydown","keyup"],Iy=function(){function n(){var t=this;this.events=new Wd,this.eventTypes=sp.reduce(function(e,r){return v(v({},e),{type:r})},{}),this.hold=!1,sp.forEach(function(e){t.addEventType(e)})}return n.prototype.listen=function(t,e){var r=this.getTypeInfo(t),i=this.events.get(r.type)||[];if(!this.hasEventType(r.type))throw new Error("There is no event type "+r.type);r.namespace&&(e.namespace=r.namespace),i.push(e),this.events.set(r.type,i)},n.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var i=this.getTypeInfo(t),o=this.events.get(i.type),s=[];return!this.hold&&o&&o.forEach(function(a){var l=a.apply(void 0,e);_t()(l)||s.push(l)}),s},n.prototype.emitReduce=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=this.events.get(t);return!this.hold&&o&&o.forEach(function(s){var a=s.apply(void 0,M([e],r));My()(a)||(e=a)}),e},n.prototype.getTypeInfo=function(t){var e=t.split(".");return{type:e[0],namespace:e[1]}},n.prototype.hasEventType=function(t){return!_t()(this.eventTypes[this.getTypeInfo(t).type])},n.prototype.addEventType=function(t){if(this.hasEventType(t))throw new Error("There is already have event type "+t);this.eventTypes[t]=t},n.prototype.removeEventHandler=function(t,e){var r=this,i=this.getTypeInfo(t),o=i.type,s=i.namespace;o&&e?this.removeEventHandlerWithHandler(o,e):o&&!s?this.events.delete(o):!o&&s?this.events.forEach(function(a,l){r.removeEventHandlerWithTypeInfo(l,s)}):o&&s&&this.removeEventHandlerWithTypeInfo(o,s)},n.prototype.removeEventHandlerWithHandler=function(t,e){var r=this.events.get(t);if(r){var i=r.indexOf(e);r.indexOf(e)>=0&&r.splice(i,1)}},n.prototype.removeEventHandlerWithTypeInfo=function(t,e){var r=[],i=this.events.get(t);i&&(i.map(function(o){return o.namespace!==e&&r.push(o),null}),this.events.set(t,r))},n.prototype.getEvents=function(){return this.events},n.prototype.holdEventInvoke=function(t){this.hold=!0,t(),this.hold=!1},n}(),ap=Iy,Ny=function(){function n(t,e,r,i){this.eventEmitter=t,this.mdCommands=e,this.wwCommands=r,this.getEditorType=i,this.initEvent()}return n.prototype.initEvent=function(){var t=this;this.eventEmitter.listen("command",function(e,r){t.exec(e,r)})},n.prototype.addCommand=function(t,e,r){t==="markdown"?this.mdCommands[e]=r:this.wwCommands[e]=r},n.prototype.deleteCommand=function(t,e){t==="markdown"?delete this.mdCommands[e]:delete this.wwCommands[e]},n.prototype.exec=function(t,e){this.getEditorType()==="markdown"?this.mdCommands[t](e):this.wwCommands[t](e)},n}(),Oy=Ny;function Go(n){return n[n.length-1]===`
`?n.slice(0,n.length-1):n}function il(n,t){var e=n.schema,r=t.literal.match($r);if(r){var i=r[1],o=r[3],s=(i||o).toLowerCase();return t.type==="htmlInline"&&!(!e.marks[s]&&!e.nodes[s])}return!1}function ol(n){return St(["text","strong","emph","strike","image","link","code"],n.type)}function lp(n){return n?.type==="softbreak"}function zi(n){var t=n.type,e=n.literal,r=t==="htmlInline"&&e.match($r);if(r){var i=r[1],o=r[3],s=i||o;if(s)return St(["ul","ol","li"],s.toLowerCase())}return!1}function cp(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=document.createElement("div");r.innerHTML=hr(n);var i=r.firstChild;return t.map(function(o){return i.getAttribute(o)||""})}var Ly={"b, strong":function(n,t,e){var r=n.schema.marks.strong;e?n.openMark(r.create({rawHTML:e})):n.closeMark(r)},"i, em":function(n,t,e){var r=n.schema.marks.emph;e?n.openMark(r.create({rawHTML:e})):n.closeMark(r)},"s, del":function(n,t,e){var r=n.schema.marks.strike;e?n.openMark(r.create({rawHTML:e})):n.closeMark(r)},code:function(n,t,e){var r=n.schema.marks.code;e?n.openMark(r.create({rawHTML:e})):n.closeMark(r)},a:function(n,t,e){var r=t.literal,i=n.schema.marks.link;if(e){var o=cp(r,"href")[0];n.openMark(i.create({linkUrl:o,rawHTML:e}))}else n.closeMark(i)},img:function(n,t,e){var r=t.literal;if(e){var i=cp(r,"src","alt"),o=i[0],s=i[1],a=n.schema.nodes.image;n.addNode(a,v({rawHTML:e,imageUrl:o},s&&{altText:s}))}},hr:function(n,t,e){n.addNode(n.schema.nodes.thematicBreak,{rawHTML:e})},br:function(n,t){var e=n.schema.nodes.paragraph,r=t.parent,i=t.prev,o=t.next;r?.type==="paragraph"?(lp(i)&&n.openNode(e),lp(o)?n.closeNode():o&&(n.closeNode(),n.openNode(e))):r?.type==="tableCell"&&(i&&(ol(i)||il(n,i))&&n.closeNode(),o&&(ol(o)||il(n,o))&&n.openNode(e))},pre:function(n,t,e){var r,i,o=document.createElement("div");o.innerHTML=t.literal;var s=(i=(r=o.firstChild)===null||r===void 0?void 0:r.firstChild)===null||i===void 0?void 0:i.textContent;n.openNode(n.schema.nodes.codeBlock,{rawHTML:e}),n.addText(Go(s)),n.closeNode()},"ul, ol":function(n,t,e){if(t.parent.type==="tableCell"){var r=n.schema.nodes,i=r.bulletList,o=r.orderedList,s=r.paragraph,a=e==="ul"?i:o;e?(t.prev&&!zi(t.prev)&&n.closeNode(),n.openNode(a,{rawHTML:e})):(n.closeNode(),t.next&&!zi(t.next)&&n.openNode(s))}},li:function(n,t,e){var r;if(((r=t.parent)===null||r===void 0?void 0:r.type)==="tableCell"){var i=n.schema.nodes,o=i.listItem,s=i.paragraph;if(e){var a=function(l){var c=l.literal;return{task:/data-task/.test(c),checked:/data-task-checked/.test(c)}}(t);t.prev&&!zi(t.prev)&&n.closeNode(),n.openNode(o,v({rawHTML:e},a)),t.next&&!zi(t.next)&&n.openNode(s)}else t.prev&&!zi(t.prev)&&n.closeNode(),n.closeNode()}}},Ay=function(n){var t={};return Object.keys(n).forEach(function(e){e.split(", ").forEach(function(r){var i=r.toLowerCase();t[i]=n[e]})}),t}(Ly);function up(n){return n.type==="htmlInline"&&aa.test(n.literal)}function dp(n){rn()(n.childNodes).forEach(function(t){if(To(t)){var e=t.nodeName.toLowerCase();t.setAttribute("data-raw-html",e),t.childNodes&&dp(t)}})}var pp={text:function(n,t){n.addText(t.literal||"")},paragraph:function(n,t,e,r){var i;if(e.entering){var o=n.schema.nodes.paragraph;((i=t.prev)===null||i===void 0?void 0:i.type)==="paragraph"&&(n.openNode(o,r),n.closeNode()),n.openNode(o,r)}else n.closeNode()},heading:function(n,t,e,r){if(e.entering){var i=t,o=i.level,s=i.headingType;n.openNode(n.schema.nodes.heading,v({level:o,headingType:s},r))}else n.closeNode()},codeBlock:function(n,t,e){var r=n.schema.nodes.codeBlock,i=t,o=i.info,s=i.literal;n.openNode(r,v({language:o},e)),n.addText(Go(s||"")),n.closeNode()},list:function(n,t,e,r){if(e.entering){var i=n.schema.nodes,o=i.bulletList,s=i.orderedList,a=t.listData,l=a.type,c=a.start;l==="bullet"?n.openNode(o,r):n.openNode(s,v({order:c},r))}else n.closeNode()},item:function(n,t,e,r){var i=e.entering,o=n.schema.nodes.listItem,s=t.listData,a=s.task,l=s.checked;if(i){var c=v(v(v({},a&&{task:a}),l&&{checked:l}),r);n.openNode(o,c)}else n.closeNode()},blockQuote:function(n,t,e,r){e.entering?n.openNode(n.schema.nodes.blockQuote,r):n.closeNode()},image:function(n,t,e,r){var i=e.entering,o=e.skipChildren,s=n.schema.nodes.image,a=t,l=a.destination,c=a.firstChild;i&&o&&o(),n.addNode(s,v(v({imageUrl:l},c&&{altText:c.literal}),r))},thematicBreak:function(n,t,e,r){n.addNode(n.schema.nodes.thematicBreak,r)},strong:function(n,t,e,r){var i=e.entering,o=n.schema.marks.strong;i?n.openMark(o.create(r)):n.closeMark(o)},emph:function(n,t,e,r){var i=e.entering,o=n.schema.marks.emph;i?n.openMark(o.create(r)):n.closeMark(o)},link:function(n,t,e,r){var i=e.entering,o=n.schema.marks.link,s=t,a=s.destination,l=s.title;if(i){var c=v({linkUrl:a,title:l},r);n.openMark(o.create(c))}else n.closeMark(o)},softbreak:function(n,t){if(t.parent.type==="paragraph"){var e=t.prev,r=t.next;e&&!up(e)&&n.closeNode(),r&&!up(r)&&n.openNode(n.schema.nodes.paragraph)}},table:function(n,t,e,r){e.entering?n.openNode(n.schema.nodes.table,r):n.closeNode()},tableHead:function(n,t,e,r){e.entering?n.openNode(n.schema.nodes.tableHead,r):n.closeNode()},tableBody:function(n,t,e,r){e.entering?n.openNode(n.schema.nodes.tableBody,r):n.closeNode()},tableRow:function(n,t,e,r){e.entering?n.openNode(n.schema.nodes.tableRow,r):n.closeNode()},tableCell:function(n,t,e){var r=e.entering;if(!t.ignored){var i=function(h){return h&&(ol(h)||il(n,h))};if(r){var o=n.schema.nodes,s=o.tableHeadCell,a=o.tableBodyCell,l=o.paragraph,c=t.parent.parent,u=c.type==="tableHead"?s:a,d=(c.parent.columns[t.startIdx]||{}).align,p=v({},t.attrs);d&&(p.align=d),n.openNode(u,p),i(t.firstChild)&&n.openNode(l)}else i(t.lastChild)&&n.closeNode(),n.closeNode()}},strike:function(n,t,e,r){var i=e.entering,o=n.schema.marks.strike;i?n.openMark(o.create(r)):n.closeMark(o)},code:function(n,t,e,r){var i=n.schema.marks.code;n.openMark(i.create(r)),n.addText(Go(t.literal||"")),n.closeMark(i)},customBlock:function(n,t){var e=n.schema.nodes,r=e.customBlock,i=e.paragraph,o=t,s=o.info,a=o.literal;n.openNode(r,{info:s}),n.addText(Go(a||"")),n.closeNode(),t.next||(n.openNode(i),n.closeNode())},frontMatter:function(n,t){n.openNode(n.schema.nodes.frontMatter),n.addText(t.literal),n.closeNode()},htmlInline:function(n,t){var e=t.literal,r=e.match($r),i=r[1],o=r[3],s=(i||o).toLowerCase(),a=n.schema.marks[s],l=hr(e);if(a?.spec.attrs.htmlInline)if(i){var c=Wa(l);n.openMark(a.create({htmlAttrs:c}))}else n.closeMark(a);else{var u=Ay[s];u&&u(n,t,i)}},htmlBlock:function(n,t){var e=t.literal,r=document.createElement("div");if(Af.test(e))n.openNode(n.schema.nodes.htmlComment),n.addText(t.literal),n.closeNode();else{var i=e.match($r),o=i[1],s=i[3],a=(o||s).toLowerCase(),l=n.schema.nodes[a],c=hr(e);if(l?.spec.attrs.htmlBlock){var u=Wa(c),d=Ld(t,a);n.addNode(l,{htmlAttrs:u,childrenHTML:d})}else r.innerHTML=c,dp(r),n.convertByDOMParser(r)}},customInline:function(n,t,e){var r=e.entering,i=e.skipChildren,o=t,s=o.info,a=o.firstChild,l=n.schema;if(s.indexOf("widget")!==-1&&r){var c=Xc(t);i(),n.addNode(l.nodes.widget,{info:s},[l.text(Yc(s,c))])}else{var u="$$";r&&(u+=a?s+" ":s),n.addText(u)}}},Dy=function(){function n(t,e){this.schema=t,this.convertors=e,this.stack=[{type:this.schema.topNodeType,attrs:null,content:[]}],this.marks=rt.none}return n.prototype.top=function(){return At(this.stack)},n.prototype.push=function(t){this.stack.length&&this.top().content.push(t)},n.prototype.addText=function(t){if(t){var e=this.top().content,r=At(e),i=this.schema.text(t,this.marks),o=r&&(a=i,!!((s=r).isText&&a.isText&&rt.sameSet(s.marks,a.marks))&&s.withText(s.text+a.text));o?e[e.length-1]=o:e.push(i)}var s,a},n.prototype.openMark=function(t){this.marks=t.addToSet(this.marks)},n.prototype.closeMark=function(t){this.marks=t.removeFromSet(this.marks)},n.prototype.addNode=function(t,e,r){var i=t.createAndFill(e,r,this.marks);return i?(this.push(i),i):null},n.prototype.openNode=function(t,e){this.stack.push({type:t,attrs:e,content:[]})},n.prototype.closeNode=function(){this.marks.length&&(this.marks=rt.none);var t=this.stack.pop(),e=t.type,r=t.attrs,i=t.content;return this.addNode(e,r,i)},n.prototype.convertByDOMParser=function(t){var e=this;lt.fromSchema(this.schema).parse(t).content.forEach(function(r){return e.push(r)})},n.prototype.closeUnmatchedHTMLInline=function(t,e){var r;if(!e&&t.type!=="htmlInline")for(var i=this.stack.length-1;i>=0;i-=1){var o=this.stack[i];if(!(!((r=o.attrs)===null||r===void 0)&&r.rawHTML))break;o.content.length?this.closeNode():this.stack.pop()}},n.prototype.convert=function(t,e){for(var r=t.walker(),i=r.next(),o=function(){var a=i.node,l=i.entering,c=s.convertors[a.type],u=!1;if(c){var d={entering:l,leaf:!Cf(a),getChildrenText:Ef,options:{gfm:!0,nodeId:!1,tagFilter:!1,softbreak:`
`},skipChildren:function(){u=!0}};if(s.closeUnmatchedHTMLInline(a,l),c(s,a,d),e?.node===a){var p=s.stack.reduce(function(h,f){return h+f.content.reduce(function(m,g){return m+g.nodeSize},0)},0)+1;e.setMappedPos(p)}}u&&(r.resumeAt(a,!1),r.next()),i=r.next()},s=this;i;)o()},n.prototype.convertNode=function(t,e){return this.convert(t,e),this.stack.length?this.closeNode():null},n}(),Ry=Dy,sl={text:function(n,t){var e,r=t.node,i=(e=r.text)!==null&&e!==void 0?e:"";(r.marks||[]).some(function(o){return o.type.name==="link"})?n.text(Le(i),!1):n.text(i)},paragraph:function(n,t){var e=t.node,r=t.parent,i=t.index,o=i===void 0?0:i;if(n.stopNewline)n.convertInline(e);else{var s=o===0,a=!s&&r.child(o-1),l=a&&a.childCount===0,c=o<r.childCount-1&&r.child(o+1),u=c&&c.type.name==="paragraph",d=e.childCount===0;if(d&&l)n.write(`<br>
`);else if(!d||l||s)n.convertInline(e),u?n.write(`
`):n.closeBlock(e);else{if(r?.type.name==="listItem"){var p=n.getDelim();n.setDelim(""),n.write("<br>"),n.setDelim(p)}n.write(`
`)}}},heading:function(n,t,e){var r=t.node,i=e.delim;r.attrs.headingType==="atx"?(n.write(i+" "),n.convertInline(r),n.closeBlock(r)):(n.convertInline(r),n.ensureNewLine(),n.write(i),n.closeBlock(r))},codeBlock:function(n,t,e){var r=t.node,i=e.delim,o=e.text,s=i,a=s[0],l=s[1];n.write(a),n.ensureNewLine(),n.text(o,!1),n.ensureNewLine(),n.write(l),n.closeBlock(r)},blockQuote:function(n,t,e){var r=t.node,i=t.parent,o=e.delim;i?.type.name===r.type.name&&n.flushClose(1),n.wrapBlock(o,null,r,function(){return n.convertNode(r)})},bulletList:function(n,t,e){var r=t.node,i=e.delim;n.convertList(r,bn(" ",4),function(){return i+" "})},orderedList:function(n,t){var e=t.node,r=e.attrs.order||1;n.convertList(e,bn(" ",4),function(i){return String(r+i)+". "})},listItem:function(n,t){var e=t.node,r=e.attrs,i=r.task,o=r.checked;i&&n.write("["+(o?"x":" ")+"] "),n.convertNode(e)},image:function(n,t,e){var r=e.attrs;n.write("!["+r?.altText+"]("+r?.imageUrl+")")},thematicBreak:function(n,t,e){var r=t.node,i=e.delim;n.write(i),n.closeBlock(r)},table:function(n,t){var e=t.node;n.convertNode(e),n.closeBlock(e)},tableHead:function(n,t,e){var r=t.node,i=e.delim,o=r.firstChild;n.convertNode(r);var s=i??"";!i&&o&&o.forEach(function(a){var l=function(c,u){var d=c.length,p="",h="";return u==="left"?(p=":",d-=1):u==="right"?(h=":",d-=1):u==="center"&&(p=":",h=":",d-=2),""+p+bn("-",Math.max(d,3))+h}(a.textContent,a.attrs.align);s+="| "+l+" "}),n.write(s+"|"),n.ensureNewLine()},tableBody:function(n,t){var e=t.node;n.convertNode(e)},tableRow:function(n,t){var e=t.node;n.convertNode(e),n.write("|"),n.ensureNewLine()},tableHeadCell:function(n,t,e){var r=t.node,i=e.delim,o=i===void 0?"| ":i;n.write(o),n.convertTableCell(r),n.write(" ")},tableBodyCell:function(n,t,e){var r=t.node,i=e.delim,o=i===void 0?"| ":i;n.write(o),n.convertTableCell(r),n.write(" ")},customBlock:function(n,t,e){var r=t.node,i=e.delim,o=e.text,s=i,a=s[0],l=s[1];n.write(a),n.ensureNewLine(),n.text(o,!1),n.ensureNewLine(),n.write(l),n.closeBlock(r)},frontMatter:function(n,t,e){var r=t.node,i=e.text;n.text(i,!1),n.closeBlock(r)},widget:function(n,t,e){var r=e.text;n.write(r)},html:function(n,t,e){var r=t.node,i=e.text;n.write(i),r.attrs.htmlBlock&&n.closeBlock(r)},htmlComment:function(n,t,e){var r=t.node,i=e.text;n.write(i),n.closeBlock(r)}};function hp(n,t){var e=n.text,r=/`+/g,i=0;if(n.isText&&e)for(var o=r.exec(e);o;)i=Math.max(i,o[0].length),o=r.exec(e);for(var s=i>0&&t>0?" `":"`",a=0;a<i;a+=1)s+="`";return i>0&&t<0&&(s+=" "),s}function Be(n){return n?["<"+n+">","</"+n+">"]:null}function _i(n){return n?"<"+n+">":null}function qi(n){return n?"</"+n+">":null}var Jo={heading:function(n){var t=n.node.attrs,e=t.level,r=bn("#",e);return t.headingType==="setext"&&(r=e===1?"===":"---"),{delim:r,rawHTML:Be(t.rawHTML)}},codeBlock:function(n){var t=n.node,e=t.attrs,r=t.textContent;return{delim:["```"+(e.language||""),"```"],rawHTML:Be(e.rawHTML),text:r}},blockQuote:function(n){return{delim:"> ",rawHTML:Be(n.node.attrs.rawHTML)}},bulletList:function(n,t){var e=n.node,r=t.inTable,i=e.attrs.rawHTML;return r&&(i=i||"ul"),{delim:"*",rawHTML:Be(i)}},orderedList:function(n,t){var e=n.node,r=t.inTable,i=e.attrs.rawHTML;return r&&(i=i||"ol"),{rawHTML:Be(i)}},listItem:function(n,t){var e=n.node,r=t.inTable,i=e.attrs,o=i.task,s=i.checked,a=e.attrs.rawHTML;return r&&(a=a||"li"),{rawHTML:a?["<"+a+(o?' class="task-list-item'+(s?" checked":"")+'"':"")+(o?" data-task"+(s?" data-task-checked":""):"")+">","</"+a+">"]:null}},table:function(n){return{rawHTML:Be(n.node.attrs.rawHTML)}},tableHead:function(n){return{rawHTML:Be(n.node.attrs.rawHTML)}},tableBody:function(n){return{rawHTML:Be(n.node.attrs.rawHTML)}},tableRow:function(n){return{rawHTML:Be(n.node.attrs.rawHTML)}},tableHeadCell:function(n){return{rawHTML:Be(n.node.attrs.rawHTML)}},tableBodyCell:function(n){return{rawHTML:Be(n.node.attrs.rawHTML)}},image:function(n){var t=n.node.attrs,e=t.rawHTML,r=t.altText,i=t.imageUrl.replace(/&amp;/g,"&"),o=r?' alt="'+je(r)+'"':"";return{rawHTML:e?"<"+e+' src="'+je(i)+'"'+o+">":null,attrs:{altText:Le(r||""),imageUrl:i}}},thematicBreak:function(n){return{delim:"***",rawHTML:_i(n.node.attrs.rawHTML)}},customBlock:function(n){var t=n.node,e=t.attrs,r=t.textContent;return{delim:["$$"+e.info,"$$"],text:r}},frontMatter:function(n){return{text:n.node.textContent}},widget:function(n){return{text:n.node.textContent}},strong:function(n,t){var e=n.node,r=t.entering,i=e.attrs.rawHTML;return{delim:"**",rawHTML:r?_i(i):qi(i)}},emph:function(n,t){var e=n.node,r=t.entering,i=e.attrs.rawHTML;return{delim:"*",rawHTML:r?_i(i):qi(i)}},strike:function(n,t){var e=n.node,r=t.entering,i=e.attrs.rawHTML;return{delim:"~~",rawHTML:r?_i(i):qi(i)}},link:function(n,t){var e,r,i=n.node,o=t.entering,s=i.attrs,a=s.title,l=s.rawHTML,c=s.linkUrl.replace(/&amp;/g,"&"),u=a?' title="'+je(a)+'"':"";return o?{delim:"[",rawHTML:l?"<"+l+' href="'+je(c)+'"'+u+">":null}:{delim:"]("+c+(a?" "+(e=Le(a),(r=e.indexOf('"')===-1?'""':e.indexOf("'")===-1?"''":"()")[0]+e+r[1]):"")+")",rawHTML:qi(l)}},code:function(n,t){var e=n.node,r=n.parent,i=n.index,o=i===void 0?0:i,s=t.entering;return{delim:s?hp(r.child(o),-1):hp(r.child(o-1),1),rawHTML:s?_i(e.attrs.rawHTML):qi(e.attrs.rawHTML)}},htmlComment:function(n){return{text:n.node.textContent}},html:function(n,t){var e=n.node,r=t.entering,i=e.type.name,o=e.attrs.htmlAttrs,s="<"+i,a="</"+i+">";return Object.keys(o).forEach(function(l){s+=" "+l+'="'+o[l].replace(/"/g,"'")+'"'}),s+=">",e.attrs.htmlInline?{rawHTML:r?s:a}:{text:""+s+e.attrs.childrenHTML+a}}},fp={strong:{mixable:!0,removedEnclosingWhitespace:!0},emph:{mixable:!0,removedEnclosingWhitespace:!0},strike:{mixable:!0,removedEnclosingWhitespace:!0},code:{escape:!1},link:null,html:null};function Py(n){var t={};return Object.keys(sl).forEach(function(e){t[e]=function(r,i){if(sl[e]){var o=n[e],s=o?o(i,{inTable:r.inTable}):{};(function(a,l){var c=l.state,u=l.nodeInfo,d=l.params,p=d.rawHTML;p?el()(a,["heading","codeBlock"])>-1?function(h,f,m){var g=m[0],w=m[1];h.write(g),h.convertInline(f),h.write(w)}(c,u.node,p):el()(a,["image","thematicBreak"])>-1?c.write(p):function(h,f,m){var g=f.node,w=f.parent,C=m[0],E=m[1];h.stopNewline=!0,h.write(C),h.convertNode(g),h.write(E),w?.type.name==="doc"&&(h.closeBlock(g),h.stopNewline=!1)}(c,u,p):sl[a](c,u,d)})(e,{state:r,nodeInfo:i,params:s})}}}),t}function Fy(n){Object.keys(n).forEach(function(r){var i=Jo[r],o=n[r];Jo[r]=i?function(s,a){return a.origin=function(){return i(s,a)},o(s,a)}:o,delete n[r]});var t=Py(Jo),e=function(r){var i={};return Object.keys(fp).forEach(function(o){i[o]=function(s,a){var l=fp[o],c=r[o],u=c&&s&&!_t()(a)?c(s,{entering:a}):{};return v(v({},u),l)}}),i}(Jo);return{nodeTypeConvertors:t,markTypeConvertors:e}}var By=function(){function n(t){var e=t.nodeTypeConvertors,r=t.markTypeConvertors;this.nodeTypeConvertors=e,this.markTypeConvertors=r,this.delim="",this.result="",this.closed=!1,this.tightList=!1,this.stopNewline=!1,this.inTable=!1}return n.prototype.getMarkConvertor=function(t){var e=t.attrs.htmlInline?"html":t.type.name;return this.markTypeConvertors[e]},n.prototype.isInBlank=function(){return/(^|\n)$/.test(this.result)},n.prototype.markText=function(t,e,r,i){var o=this.getMarkConvertor(t);if(o){var s=o({node:t,parent:r,index:i},e),a=s.delim;return s.rawHTML||a}return""},n.prototype.setDelim=function(t){this.delim=t},n.prototype.getDelim=function(){return this.delim},n.prototype.flushClose=function(t){if(!this.stopNewline&&this.closed){if(this.isInBlank()||(this.result+=`
`),t||(t=2),t>1){var e=this.delim,r=/\s+$/.exec(e);r&&(e=e.slice(0,e.length-r[0].length));for(var i=1;i<t;i+=1)this.result+=e+`
`}this.closed=!1}},n.prototype.wrapBlock=function(t,e,r,i){var o=this.getDelim();this.write(e||t),this.setDelim(this.getDelim()+t),i(),this.setDelim(o),this.closeBlock(r)},n.prototype.ensureNewLine=function(){this.isInBlank()||(this.result+=`
`)},n.prototype.write=function(t){t===void 0&&(t=""),this.flushClose(),this.delim&&this.isInBlank()&&(this.result+=this.delim),t&&(this.result+=t)},n.prototype.closeBlock=function(t){this.closed=t},n.prototype.text=function(t,e){e===void 0&&(e=!0);for(var r=t.split(`
`),i=0;i<r.length;i+=1)this.write(),this.result+=e?Ir(r[i]):r[i],i!==r.length-1&&(this.result+=`
`)},n.prototype.convertBlock=function(t,e,r){var i=t.type.name,o=this.nodeTypeConvertors[i],s={node:t,parent:e,index:r};t.attrs.htmlBlock?this.nodeTypeConvertors.html(this,s):o&&o(this,s)},n.prototype.convertInline=function(t){var e=this,r=[],i="",o=function(s,a,l){var c=s?s.marks:[],u=i;i="";var d=s&&s.isText&&c.some(function(q){var _=e.getMarkConvertor(q),Y=_&&_();return Y&&Y.removedEnclosingWhitespace});if(d&&s&&s.text){var p=/^(\s*)(.*?)(\s*)$/m.exec(s.text),h=p[1],f=p[2],m=p[3];u+=h,i=m,(h||m)&&((s=f?s.withText(f):null)||(c=r))}for(var g=c.length&&At(c),w=g&&e.getMarkConvertor(g),C=w&&w(),E=C&&C.escape===!1,L=c.length-(E?1:0),P=0;P<L&&(f=c[P],!(C&&!C.mixable));P+=1)for(var A=0;A<r.length;A+=1){var H=r[A];if(C&&!C.mixable)break;if(f.eq(H)){P>A?c=c.slice(0,A).concat(f).concat(c.slice(A,P)).concat(c.slice(P+1,L)):A>P&&(c=c.slice(0,P).concat(c.slice(P+1,A)).concat(f).concat(c.slice(A,L)));break}}for(var B=0;B<Math.min(r.length,L)&&c[B].eq(r[B]);)B+=1;for(;B<r.length;){var z=r.pop();z&&e.text(e.markText(z,!1,t,l),!1)}if(u&&e.text(u),s){for(;r.length<L;)f=c[r.length],r.push(f),e.text(e.markText(f,!0,t,l),!1);E&&s.isText?e.text(e.markText(g,!0,t,l)+s.text+e.markText(g,!1,t,l+1),!1):e.convertBlock(s,t,l)}};t.forEach(o),o(null,0,t.childCount)},n.prototype.convertList=function(t,e,r){var i,o=this;this.closed&&this.closed.type===t.type?this.flushClose(3):this.tightList&&this.flushClose(1);var s=(i=t.attrs.tight)===null||i===void 0||i,a=this.tightList;this.tightList=s,t.forEach(function(l,c,u){u&&s&&o.flushClose(1),o.wrapBlock(e,r(u),t,function(){return o.convertBlock(l,t,u)})}),this.tightList=a},n.prototype.convertTableCell=function(t){var e=this;this.stopNewline=!0,this.inTable=!0,t.forEach(function(r,i,o){St(["bulletList","orderedList"],r.type.name)?(e.convertBlock(r,t,o),e.closed=!1):(e.convertInline(r),o<t.childCount-1&&t.child(o+1).type.name==="paragraph"&&e.write("<br>"))}),this.stopNewline=!1,this.inTable=!1},n.prototype.convertNode=function(t,e){var r=this;return t.forEach(function(i,o,s){if(r.convertBlock(i,t,s),e?.node===i){var a=r.result.split(`
`);e.setMappedPos([a.length,At(a).length+1])}}),this.result},n}(),Hy=By,zy=function(){function n(t,e,r,i){var o=this;this.setMappedPos=function(s){o.mappedPosWhenConverting=s},this.schema=t,this.eventEmitter=i,this.focusedNode=null,this.mappedPosWhenConverting=null,this.toWwConvertors=function(s){var a=Object.keys(s),l=v({},pp),c=new Ua({gfm:!0,nodeId:!0,convertors:s}).getConvertors();return a.forEach(function(u){var d=pp[u];d&&!St(["htmlBlock","htmlInline"],u)&&(l[u]=function(p,h,f){f.origin=function(){return c[u](h,f,c)};var m,g=s[u](h,f);if(g){var w=Array.isArray(g)?g[0]:g;m={htmlAttrs:w.attributes,classNames:w.classNames}}d(p,h,f,m)})}),l}(r),this.toMdConvertors=Fy(e||{}),this.eventEmitter.listen("setFocusedNode",function(s){return o.focusedNode=s})}return n.prototype.getMappedPos=function(){return this.mappedPosWhenConverting},n.prototype.getInfoForPosSync=function(){return{node:this.focusedNode,setMappedPos:this.setMappedPos}},n.prototype.toWysiwygModel=function(t){return new Ry(this.schema,this.toWwConvertors).convertNode(t,this.getInfoForPosSync())},n.prototype.toMarkdownText=function(t){var e=new Hy(this.toMdConvertors).convertNode(t,this.getInfoForPosSync());return e=this.eventEmitter.emitReduce("beforeConvertWysiwygToMarkdown",e)},n}(),_y=zy;function mp(n){var t=n.plugins,e=n.eventEmitter,r=n.usageStatistics,i=n.instance;return e.listen("mixinTableOffsetMapPrototype",vv),(t??[]).reduce(function(o,s){var a=function(w){var C=w.plugin,E={eventEmitter:w.eventEmitter,usageStatistics:w.usageStatistics,instance:w.instance,pmState:{Plugin:le,PluginKey:Ei,Selection:G,TextSelection:dt},pmView:{Decoration:de,DecorationSet:Rt},pmModel:{Fragment:S},pmRules:{InputRule:Ln,inputRules:Hc,undoInputRule:gf},pmKeymap:{keymap:Li},i18n:ct};if(sa()(C)){var L=C[0],P=C[1];return L(E,P===void 0?{}:P)}return C(E)}({plugin:s,eventEmitter:e,usageStatistics:r,instance:i});if(!a)throw new Error("The return value of the executed plugin is empty.");var l=a.markdownParsers,c=a.toHTMLRenderers,u=a.toMarkdownRenderers,d=a.markdownPlugins,p=a.wysiwygPlugins,h=a.wysiwygNodeViews,f=a.markdownCommands,m=a.wysiwygCommands,g=a.toolbarItems;return c&&(o.toHTMLRenderers=Ve(o.toHTMLRenderers,c)),u&&(o.toMarkdownRenderers=Ve(o.toMarkdownRenderers,u)),d&&(o.mdPlugins=o.mdPlugins.concat(d)),p&&(o.wwPlugins=o.wwPlugins.concat(p)),h&&(o.wwNodeViews=v(v({},o.wwNodeViews),h)),f&&(o.mdCommands=v(v({},o.mdCommands),f)),m&&(o.wwCommands=v(v({},o.wwCommands),m)),g&&(o.toolbarItems=o.toolbarItems.concat(g)),l&&(o.markdownParsers=v(v({},o.markdownParsers),l)),o},{toHTMLRenderers:{},toMarkdownRenderers:{},mdPlugins:[],wwPlugins:[],wwNodeViews:{},mdCommands:{},wwCommands:{},toolbarItems:[],markdownParsers:{}})}var qy=function(){function n(t){var e=this;this.options=pi()({linkAttributes:null,extendedAutolinks:!1,customHTMLRenderer:null,referenceDefinition:!1,customHTMLSanitizer:null,frontMatter:!1,usageStatistics:!0,theme:"light"},t),this.eventEmitter=new ap;var r,i=Mr(this.options.linkAttributes),o=mp({plugins:this.options.plugins,eventEmitter:this.eventEmitter,usageStatistics:this.options.usageStatistics,instance:this})||{},s=o.toHTMLRenderers,a=o.markdownParsers,l=this.options,c=l.customHTMLRenderer,u=l.extendedAutolinks,d=l.referenceDefinition,p=l.frontMatter,h=l.customHTMLSanitizer,f={linkAttributes:i,customHTMLRenderer:v(v({},s),c),extendedAutolinks:u,referenceDefinition:d,frontMatter:p,sanitizer:h||hr};r=f.customHTMLRenderer,["htmlBlock","htmlInline"].forEach(function(L){r[L]&&Object.keys(r[L]).forEach(function(P){return Od(P)})}),this.options.events&&xr()(this.options.events,function(L,P){e.on(P,L)});var m=this.options,g=m.el,w=m.initialValue,C=m.theme,E=g.innerHTML;C!=="light"&&g.classList.add(J(C)),g.innerHTML="",this.toastMark=new Ed("",{disallowedHtmlBlockTags:["br","img"],extendedAutolinks:u,referenceDefinition:d,disallowDeepHeading:!0,frontMatter:p,customParser:a}),this.preview=new Pd(this.eventEmitter,v(v({},f),{isViewer:!0})),Ru()(this.preview.previewContent,"mousedown",this.toggleTask.bind(this)),w?this.setMarkdown(w):E&&this.preview.setHTML(E),g.appendChild(this.preview.previewContent),this.eventEmitter.emit("load",this)}return n.prototype.toggleTask=function(t){var e=t.target,r=getComputedStyle(e,":before");!e.hasAttribute("data-task-disabled")&&e.hasAttribute("data-task")&&la(r,t.offsetX,t.offsetY)&&(ca(e,"checked"),this.eventEmitter.emit("change",{source:"viewer",date:t}))},n.prototype.setMarkdown=function(t){var e=this.toastMark.getLineTexts(),r=[e.length,At(e).length+1],i=this.toastMark.editMarkdown([1,1],r,t||"");this.eventEmitter.emit("updatePreview",i)},n.prototype.on=function(t,e){this.eventEmitter.listen(t,e)},n.prototype.off=function(t){this.eventEmitter.removeEventHandler(t)},n.prototype.addHook=function(t,e){this.eventEmitter.removeEventHandler(t),this.eventEmitter.listen(t,e)},n.prototype.destroy=function(){Du()(this.preview.el,"mousedown",this.toggleTask.bind(this)),this.preview.destroy(),this.eventEmitter.emit("destroy")},n.prototype.isViewer=function(){return!0},n.prototype.isMarkdownMode=function(){return!1},n.prototype.isWysiwygMode=function(){return!1},n}(),gp=qy;function Yo(n){return n instanceof he}function vp(n){return St(["document","blockQuote","bulletList","orderedList","listItem","paragraph","heading","emph","strong","strike","link","image","table","tableHead","tableBody","tableRow","tableHeadCell","tableBodyCell"],n)}var $y={openTag:function(n,t){var e=n,r=e.tagName,i=e.classNames,o=e.attributes,s=document.createElement(r),a={};i&&(s.className=i.join(" ")),o&&(a=v(v({},a),o)),da(a,s),t.push(s)},closeTag:function(n,t){if(t.length>1){var e=t.pop();At(t).appendChild(e)}},html:function(n,t){At(t).insertAdjacentHTML("beforeend",n.content)},text:function(n,t){var e=document.createTextNode(n.content);At(t).appendChild(e)}},jy=function(){function n(t,e){var r=Ga(t,e),i=v(v({},e.htmlBlock),e.htmlInline);this.customConvertorKeys=Object.keys(e).concat(Object.keys(i)),this.renderer=new Ua({gfm:!0,convertors:v(v({},r),i)}),this.convertors=this.renderer.getConvertors()}return n.prototype.generateTokens=function(t){var e=function(a){var l=a.attrs,c=a.type.name,u={type:c,wysiwygNode:!0,literal:!vp(c)&&Yo(a)?a.textContent:null},d={heading:{level:l.level},link:{destination:l.linkUrl,title:l.title},image:{destination:l.imageUrl},codeBlock:{info:l.language},bulletList:{type:"list",listData:{type:"bullet"}},orderedList:{type:"list",listData:{type:"ordered",start:l.order}},listItem:{type:"item",listData:{task:l.task,checked:l.checked}},tableHeadCell:{type:"tableCell",cellType:"head",align:l.align},tableBodyCell:{type:"tableCell",cellType:"body",align:l.align},customBlock:{info:l.info}}[c],p=v(v({},u),d),h=a.attrs,f=h.htmlAttrs,m=h.childrenHTML;return f?v(v({},p),{attrs:f,childrenHTML:m}):p}(t),r={entering:!0,leaf:!!Yo(t)&&t.isLeaf,options:this.renderer.getOptions(),getChildrenText:function(){return Yo(t)?t.textContent:""},skipChildren:function(){return!1}},i=this.convertors[t.type.name],o=i(e,r,this.convertors),s=sa()(o)?o:[o];return(vp(t.type.name)||t.attrs.htmlInline)&&(r.entering=!1,s.push({type:"text",content:Yo(t)?t.textContent:""}),s=s.concat(i(e,r,this.convertors))),s},n.prototype.toDOMNode=function(t){var e=this.generateTokens(t),r=[];return e.forEach(function(i){return $y[i.type](i,r)}),r[0]},n.prototype.getToDOMNode=function(t){return St(this.customConvertorKeys,t)?this.toDOMNode.bind(this):null},n}(),Qo=null,al=null;function yp(n,t){var e=t.syncScrollTop,r=t.releaseEventBlock;al&&clearTimeout(al),e(n),al=setTimeout(function(){r()},15)}var Vy=function(){function n(t,e,r){this.latestEditorScrollTop=null,this.latestPreviewScrollTop=null,this.blockedScroll=null,this.active=!0,this.timer=null;var i=e.previewContent,o=e.el;this.previewRoot=i,this.previewEl=o,this.mdEditor=t,this.editorView=t.view,this.toastMark=t.getToastMark(),this.eventEmitter=r,this.addScrollSyncEvent()}return n.prototype.addScrollSyncEvent=function(){var t=this;this.eventEmitter.listen("afterPreviewRender",function(){t.clearTimer(),t.timer=setTimeout(function(){t.syncPreviewScrollTop(!0)},200)}),this.eventEmitter.listen("scroll",function(e,r){t.active&&(e==="editor"&&t.blockedScroll!=="editor"?t.syncPreviewScrollTop():e==="preview"&&t.blockedScroll!=="preview"&&t.syncEditorScrollTop(r))}),this.eventEmitter.listen("toggleScrollSync",function(e){t.active=e})},n.prototype.getMdNodeAtPos=function(t,e){var r=t.content.findIndex(e.pos).index;return this.toastMark.findFirstNodeAtLine(r+1)},n.prototype.getScrollTopByCaretPos=function(){var t=this.mdEditor.getSelection(),e=this.toastMark.findFirstNodeAtLine(t[0][0]),r=this.previewEl.clientHeight,i=Ja(this.previewRoot,e).el,o=(jo(i,this.previewRoot)||i.offsetTop)+i.clientHeight-.5*r;return this.latestEditorScrollTop=null,i.getBoundingClientRect().top-this.previewEl.getBoundingClientRect().top<r?null:o},n.prototype.syncPreviewScrollTop=function(t){t===void 0&&(t=!1);var e=this,r=e.editorView,i=e.previewEl,o=e.previewRoot,s=r.dom.getBoundingClientRect(),a=s.left,l=s.top,c=r.posAtCoords({left:a,top:l}),u=r.state.doc,d=this.getMdNodeAtPos(u,c);if(d&&!function(q){var _=q.type;return _==="htmlBlock"||_==="htmlInline"}(d)){var p=i.scrollTop,h=r.dom,f=h.scrollTop,m=h.scrollHeight,g=h.clientHeight,w=h.children,C=m-f<=g+18,E=C?i.scrollHeight:0;if(f&&!C){if(t){var L=this.getScrollTopByCaretPos();if(!L)return;E=L}else{var P=Ja(this.previewRoot,d),A=P.el,H=Dd(u,P.mdNode,w),B=H.height,z=H.rect;E=(jo(A,o)||A.offsetTop)+A.clientHeight*(l>z.top?Math.min((l-z.top)/B,1):0)}E=this.getResolvedScrollTop("editor",f,E,p),this.latestEditorScrollTop=f}E!==p&&this.run("editor",E,p)}},n.prototype.syncEditorScrollTop=function(t){var e=this,r=e.toastMark,i=e.editorView,o=e.previewRoot,s=e.previewEl,a=i.dom,l=i.state,c=s.scrollTop,u=s.clientHeight,d=s.scrollHeight-c<=u,p=a.scrollTop,h=d?a.scrollHeight:0;if(c&&t&&!d){if(t=function(A,H){for(;!A.getAttribute("data-nodeid")&&A.parentElement!==H;)A=A.parentElement;return A}(t,o),!t.getAttribute("data-nodeid"))return;var f=a.children,m=Number(t.getAttribute("data-nodeid")),g=Ja(this.previewRoot,r.findNodeById(m)),w=g.mdNode,C=g.el;h=f[Ri(w)-1].offsetTop;var E=Dd(l.doc,w,f).height,L=pv(C,o,m),P=L.nodeHeight;h+=function(A,H,B,z){return Math.min((A-H)/B,1)*z}(c,L.offsetTop,P,E),h=this.getResolvedScrollTop("preview",c,h,p),this.latestPreviewScrollTop=c}h!==p&&this.run("preview",h,p)},n.prototype.getResolvedScrollTop=function(t,e,r,i){var o=t==="editor"?this.latestEditorScrollTop:this.latestPreviewScrollTop;return o===null?r:o<e?Math.max(r,i):Math.min(r,i)},n.prototype.run=function(t,e,r){var i,o=this;t==="editor"?(i=this.previewEl,this.blockedScroll="preview"):(i=this.editorView.dom,this.blockedScroll="editor"),function(s,a,l){var c=a-s,u=Date.now(),d=function(){var p,h=(Date.now()-u)/100;Qo&&clearTimeout(Qo),h<1?(p=s+c*Math.cos((1-h)*Math.PI/2),yp(Math.ceil(p),l),Qo=setTimeout(d,1)):(yp(a,l),Qo=null)};d()}(r,e,{syncScrollTop:function(s){return i.scrollTop=s},releaseEventBlock:function(){return o.blockedScroll=null}})},n.prototype.clearTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},n.prototype.destroy=function(){this.clearTimer(),this.eventEmitter.removeEventHandler("scroll"),this.eventEmitter.removeEventHandler("afterPreviewRender")},n}(),Uy={getPopupInitialValues:function(n,t){return t.popupName==="link"?{linkText:n.getSelectedText()}:{}}},Wy=function(){function n(t){var e=this;this.initialHTML=t.el.innerHTML,t.el.innerHTML="",this.options=pi()({previewStyle:"tab",previewHighlight:!0,initialEditType:"markdown",height:"300px",minHeight:"200px",language:"en-US",useCommandShortcut:!0,usageStatistics:!0,toolbarItems:[["heading","bold","italic","strike"],["hr","quote"],["ul","ol","task","indent","outdent"],["table","image","link"],["code","codeblock"],["scrollSync"]],hideModeSwitch:!1,linkAttributes:null,extendedAutolinks:!1,customHTMLRenderer:null,customMarkdownRenderer:null,referenceDefinition:!1,customHTMLSanitizer:null,frontMatter:!1,widgetRules:[],theme:"light",autofocus:!0},t);var r=this.options,i=r.customHTMLRenderer,o=r.extendedAutolinks,s=r.referenceDefinition,a=r.frontMatter,l=r.customMarkdownRenderer,c=r.useCommandShortcut,u=r.initialEditType,d=r.widgetRules,p=r.customHTMLSanitizer;this.mode=u||"markdown",this.mdPreviewStyle=this.options.previewStyle,this.i18n=ct,this.i18n.setCode(this.options.language),this.eventEmitter=new ap,Sf(d);var h=Mr(this.options.linkAttributes);this.pluginInfo=mp({plugins:this.options.plugins,eventEmitter:this.eventEmitter,usageStatistics:this.options.usageStatistics,instance:this});var f=this.pluginInfo,m=f.toHTMLRenderers,g=f.toMarkdownRenderers,w=f.mdPlugins,C=f.wwPlugins,E=f.wwNodeViews,L=f.mdCommands,P=f.wwCommands,A=f.markdownParsers,H={linkAttributes:h,customHTMLRenderer:Ve(m,i),extendedAutolinks:o,referenceDefinition:s,frontMatter:a,sanitizer:p||hr},B=new jy(h,H.customHTMLRenderer),z=function(q,_,Y){var K={nodes:{},marks:{}};return["htmlBlock","htmlInline"].forEach(function(ot){q[ot]&&Object.keys(q[ot]).forEach(function(pt){var Tt=ot==="htmlBlock"?"nodes":"marks";Od(pt),K[Tt][pt]=ov[ot](pt,_,Y)})}),K}(H.customHTMLRenderer,H.sanitizer,B);this.toastMark=new Ed("",{disallowedHtmlBlockTags:["br","img"],extendedAutolinks:o,referenceDefinition:s,disallowDeepHeading:!0,frontMatter:a,customParser:A}),this.mdEditor=new Am(this.eventEmitter,{toastMark:this.toastMark,useCommandShortcut:c,mdPlugins:w}),this.preview=new Pd(this.eventEmitter,v(v({},H),{isViewer:!1,highlight:this.options.previewHighlight})),this.wwEditor=new Ty(this.eventEmitter,{toDOMAdaptor:B,useCommandShortcut:c,htmlSchemaMap:z,linkAttributes:h,wwPlugins:C,wwNodeViews:E}),this.convertor=new _y(this.wwEditor.getSchema(),v(v({},g),l),Ga(h,H.customHTMLRenderer),this.eventEmitter),this.setMinHeight(this.options.minHeight),this.setHeight(this.options.height),this.setMarkdown(this.options.initialValue,!1),this.options.placeholder&&this.setPlaceholder(this.options.placeholder),this.options.initialValue||this.setHTML(this.initialHTML,!1),this.commandManager=new Oy(this.eventEmitter,this.mdEditor.commands,this.wwEditor.commands,function(){return e.mode}),this.options.usageStatistics&&ms()("editor","UA-129966929-1"),this.scrollSync=new Vy(this.mdEditor,this.preview,this.eventEmitter),this.addInitEvent(),this.addInitCommand(L,P),function(q){q.eventEmitter.listen("query",function(_,Y){return Uy[_](q,Y)})}(this),this.options.hooks&&xr()(this.options.hooks,function(q,_){return e.addHook(_,q)}),this.options.events&&xr()(this.options.events,function(q,_){return e.on(_,q)}),this.eventEmitter.emit("load",this),this.moveCursorToStart(this.options.autofocus)}return n.prototype.addInitEvent=function(){var t=this;this.on("needChangeMode",this.changeMode.bind(this)),this.on("loadUI",function(){if(t.height!=="auto"){var e=Math.min(parseInt(t.minHeight,10),parseInt(t.height,10)-75)+"px";t.setMinHeight(e)}}),function(e){e.listen("addImageBlobHook",function(r,i){var o=new FileReader;o.onload=function(s){var a=s.target;return i(a.result)},o.readAsDataURL(r)})}(this.eventEmitter)},n.prototype.addInitCommand=function(t,e){var r=this,i=function(o,s){Object.keys(s).forEach(function(a){r.addCommand(o,a,s[a])})};this.addCommand("markdown","toggleScrollSync",function(o){return r.eventEmitter.emit("toggleScrollSync",o.active),!0}),i("markdown",t),i("wysiwyg",e)},n.prototype.getCurrentModeEditor=function(){return this.isMarkdownMode()?this.mdEditor:this.wwEditor},n.factory=function(t){return t.viewer?new gp(t):new n(t)},n.setLanguage=function(t,e){ct.setLanguage(t,e)},n.prototype.changePreviewStyle=function(t){this.mdPreviewStyle!==t&&(this.mdPreviewStyle=t,this.eventEmitter.emit("changePreviewStyle",t))},n.prototype.exec=function(t,e){this.commandManager.exec(t,e)},n.prototype.addCommand=function(t,e,r){var i=this;this.commandManager.addCommand(t,e,function(o){o===void 0&&(o={});var s=(t==="markdown"?i.mdEditor:i.wwEditor).view;r(o,s.state,s.dispatch,s)})},n.prototype.on=function(t,e){this.eventEmitter.listen(t,e)},n.prototype.off=function(t){this.eventEmitter.removeEventHandler(t)},n.prototype.addHook=function(t,e){this.eventEmitter.removeEventHandler(t),this.eventEmitter.listen(t,e)},n.prototype.removeHook=function(t){this.eventEmitter.removeEventHandler(t)},n.prototype.focus=function(){this.getCurrentModeEditor().focus()},n.prototype.blur=function(){this.getCurrentModeEditor().blur()},n.prototype.moveCursorToEnd=function(t){t===void 0&&(t=!0),this.getCurrentModeEditor().moveCursorToEnd(t)},n.prototype.moveCursorToStart=function(t){t===void 0&&(t=!0),this.getCurrentModeEditor().moveCursorToStart(t)},n.prototype.setMarkdown=function(t,e){if(t===void 0&&(t=""),e===void 0&&(e=!0),this.mdEditor.setMarkdown(t,e),this.isWysiwygMode()){var r=this.toastMark.getRootNode(),i=this.convertor.toWysiwygModel(r);this.wwEditor.setModel(i,e)}},n.prototype.setHTML=function(t,e){t===void 0&&(t=""),e===void 0&&(e=!0);var r=document.createElement("div");r.innerHTML=function(o){var s=o.replace(/<p><br\s*\/*><\/p>/gi,"<p></p>"),a=new RegExp(ru,"ig"),l=s.match(a);return l?.forEach(function(c,u){if(aa.test(c)){var d=iu;if(u){var p=l[u-1].match(nu);if(p&&!/br/i.test(p[1])){var h=p[1];d="</"+h+"><"+h+">"}}s=s.replace(aa,d)}}),s}(t);var i=lt.fromSchema(this.wwEditor.schema).parse(r);this.isMarkdownMode()?this.mdEditor.setMarkdown(this.convertor.toMarkdownText(i),e):this.wwEditor.setModel(i,e)},n.prototype.getMarkdown=function(){return this.isMarkdownMode()?this.mdEditor.getMarkdown():this.convertor.toMarkdownText(this.wwEditor.getModel())},n.prototype.getHTML=function(){var t=this;this.eventEmitter.holdEventInvoke(function(){if(t.isMarkdownMode()){var i=t.toastMark.getRootNode(),o=t.convertor.toWysiwygModel(i);t.wwEditor.setModel(o)}});var e=pa(this.wwEditor.view.dom.innerHTML);if(this.placeholder){var r=new RegExp('<span class="placeholder[^>]+>'+this.placeholder+"</span>","i");return e.replace(r,"")}return e},n.prototype.insertText=function(t){this.getCurrentModeEditor().replaceSelection(t)},n.prototype.setSelection=function(t,e){this.getCurrentModeEditor().setSelection(t,e)},n.prototype.replaceSelection=function(t,e,r){this.getCurrentModeEditor().replaceSelection(t,e,r)},n.prototype.deleteSelection=function(t,e){this.getCurrentModeEditor().deleteSelection(t,e)},n.prototype.getSelectedText=function(t,e){return this.getCurrentModeEditor().getSelectedText(t,e)},n.prototype.getRangeInfoOfNode=function(t){return this.getCurrentModeEditor().getRangeInfoOfNode(t)},n.prototype.addWidget=function(t,e,r){this.getCurrentModeEditor().addWidget(t,e,r)},n.prototype.replaceWithWidget=function(t,e,r){this.getCurrentModeEditor().replaceWithWidget(t,e,r)},n.prototype.setHeight=function(t){var e=this.options.el;gn()(t)&&(t==="auto"?me()(e,"auto-height"):re()(e,"auto-height"),this.setMinHeight(this.getMinHeight())),ae()(e,{height:t}),this.height=t},n.prototype.getHeight=function(){return this.height},n.prototype.setMinHeight=function(t){if(t!==this.minHeight){var e=this.height||this.options.height;e!=="auto"&&this.options.el.querySelector("."+J("main"))&&(t=Math.min(parseInt(t,10),parseInt(e,10)-75)+"px");var r=parseInt(t,10);this.minHeight=t,this.wwEditor.setMinHeight(r),this.mdEditor.setMinHeight(r),this.preview.setMinHeight(r)}},n.prototype.getMinHeight=function(){return this.minHeight},n.prototype.isMarkdownMode=function(){return this.mode==="markdown"},n.prototype.isWysiwygMode=function(){return this.mode==="wysiwyg"},n.prototype.isViewer=function(){return!1},n.prototype.getCurrentPreviewStyle=function(){return this.mdPreviewStyle},n.prototype.changeMode=function(t,e){if(this.mode!==t){if(this.mode=t,this.isWysiwygMode()){var r=this.toastMark.getRootNode(),i=this.convertor.toWysiwygModel(r);this.wwEditor.setModel(i)}else i=this.wwEditor.getModel(),this.mdEditor.setMarkdown(this.convertor.toMarkdownText(i),!e);if(this.eventEmitter.emit("removePopupWidget"),this.eventEmitter.emit("changeMode",t),!e){var o=this.convertor.getMappedPos();this.focus(),this.isWysiwygMode()&&Oe()(o)?this.wwEditor.setSelection(o):Array.isArray(o)&&this.mdEditor.setSelection(o)}}},n.prototype.destroy=function(){var t=this;this.wwEditor.destroy(),this.mdEditor.destroy(),this.preview.destroy(),this.scrollSync.destroy(),this.eventEmitter.emit("destroy"),this.eventEmitter.getEvents().forEach(function(e,r){return t.off(r)})},n.prototype.hide=function(){this.eventEmitter.emit("hide")},n.prototype.show=function(){this.eventEmitter.emit("show")},n.prototype.setScrollTop=function(t){this.getCurrentModeEditor().setScrollTop(t)},n.prototype.getScrollTop=function(){return this.getCurrentModeEditor().getScrollTop()},n.prototype.reset=function(){this.wwEditor.setModel([]),this.mdEditor.setMarkdown("")},n.prototype.getSelection=function(){return this.getCurrentModeEditor().getSelection()},n.prototype.setPlaceholder=function(t){this.placeholder=t,this.mdEditor.setPlaceholder(t),this.wwEditor.setPlaceholder(t)},n.prototype.getEditorElements=function(){return{mdEditor:this.mdEditor.getElement(),mdPreview:this.preview.getElement(),wwEditor:this.wwEditor.getElement()}},n.prototype.convertPosToMatchEditorMode=function(t,e,r){var i,o;e===void 0&&(e=t),r===void 0&&(r=this.mode);var s=this.mdEditor.view.state.doc,a=Array.isArray(t),l=Array.isArray(e),c=t,u=e;if(a!==l)throw new Error("Types of arguments must be same");return r!=="markdown"||a||l?r==="wysiwyg"&&a&&l&&(c=(o=ur(s,t,e))[0],u=o[1]):(c=(i=Mo(s,t,e))[0],u=i[1]),[c,u]},n}(),bp=Wy,Ky=b(326),Gy=b.n(Ky),Jy=function(){function n(t){this.current=t,this.root=t,this.entering=!0}return n.prototype.walk=function(){var t=this.entering,e=this.current;return e?(t?e.firstChild?(this.current=e.firstChild,this.entering=!0):this.entering=!1:e===this.root?this.current=null:e.next?(this.current=e.next,this.entering=!0):(this.current=e.parent,this.entering=!1),{vnode:e,entering:t}):null},n}(),He=function(){function n(t,e,r){this.parent=null,this.old=null,this.firstChild=null,this.next=null,this.skip=!1,this.type=t,this.props=e,this.children=r,this.props.children=r,e.ref&&(this.ref=e.ref,delete e.ref),e.key&&(this.key=e.key,delete e.key)}return n.prototype.walker=function(){return new Jy(this)},n.removalNodes=[],n}();function wp(n,t){var e,r=n;Gy()(n)||n==null?r=null:(gn()(n)||Oe()(n))&&(e=String(n),r=new He("TEXT_NODE",{nodeValue:e},[])),r&&t.push(r)}var ht=(function(n){for(var t,e,r=arguments,i=1,o="",s="",a=[0],l=function(d){i===1&&(d||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(d?r[d]:o):i===3&&(d||o)?(a[1]=d?r[d]:o,i=2):i===2&&o==="..."&&d?a[2]=Or(a[2]||{},r[d]):i===2&&o&&!d?(a[2]=a[2]||{})[o]=!0:i>=5&&(i===5?((a[2]=a[2]||{})[e]=d?o?o+r[d]:r[d]:o,i=6):(d||o)&&(a[2][e]+=d?o+r[d]:o)),o=""},c=0;c<n.length;c++){c&&(i===1&&l(),l(c));for(var u=0;u<n[c].length;u++)t=n[c][u],i===1?t==="<"?(l(),a=[a,"",null],i=3):o+=t:i===4?o==="--"&&t===">"?(i=1,o=""):o=t+o[0]:s?t===s?s="":o+=t:t==='"'||t==="'"?s=t:t===">"?(l(),i=1):i&&(t==="="?(i=5,e=o,o=""):t==="/"&&(i<5||n[c][u+1]===">")?(l(),i===3&&(a=a[0]),i=a,(a=a[0]).push(this.apply(null,i.slice(1))),i=0):t===" "||t==="	"||t===`
`||t==="\r"?(l(),i=2):o+=t),i===3&&o==="!--"&&(i=4,a=a[0])}return l(),a.length>2?a.slice(1):a[1]}).bind(function(n,t){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];var i=[];return e.forEach(function(o){Array.isArray(o)?o.forEach(function(s){wp(s,i)}):wp(o,i)}),new He(n,t||{},i)}),Yy=b(73),Qy=b.n(Yy);function Xy(n){var t;return n.type==="TEXT_NODE"?t=document.createTextNode(n.props.nodeValue):xp(t=document.createElement(n.type),{},n.props),t}function kp(n,t){n.node?t.removeChild(n.node):kp(n.firstChild,t)}function Zy(n,t,e){Object.keys(t).forEach(function(r){if(/^on/.test(r)){if(!e[r]||t[r]!==e[r]){var i=r.slice(2).toLowerCase();n.removeEventListener(i,t[r])}}else r==="children"||e[r]||function(o){return o?.nodeType===Node.TEXT_NODE}(n)||n.removeAttribute(r)}),xp(n,t,e,function(r){return!wn(t[r],e[r])})}var tb=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function xp(n,t,e,r){Object.keys(e).forEach(function(i){if(!r||r(i))if(/^on/.test(i)){var o=i.slice(2).toLowerCase();n.addEventListener(o,e[i])}else i==="nodeValue"?n[i]=e[i]:i==="style"&&Qy()(e[i])?function(s,a,l){a&&Object.keys(a).forEach(function(c){s.style[c]=""}),Object.keys(l).forEach(function(c){var u=l[c];s.style[c]=Oe()(u)&&!tb.test(c)?u+"px":u})}(n,t[i],e[i]):i!=="children"&&(e[i]===!1?n.removeAttribute(i):n.setAttribute(i,e[i]))})}function ll(n){if(He.removalNodes.forEach(function(o){return Ep(o)}),n){for(var t=void 0,e=n.walker();t=e.walk();)if(n=t.vnode,t.entering)Ep(n);else if(Te()(n.type)){var r=n.component;if(!n.old&&r.mounted&&r.mounted(),n.old&&r.updated){var i=r.prevProps||{};r.updated(i)}}}}function Cp(n){for(var t=n.parent;!t.node;)t=t.parent;return t.node}function Ep(n){if(n&&n.parent){if(n.node){var t=Cp(n);n.effect==="A"?t.appendChild(n.node):n.effect==="U"&&Zy(n.node,n.old.props,n.props)}if(n.effect==="D"){for(var e=void 0,r=n.walker();e=r.walk();)if(n=e.vnode,!e.entering)if(Te()(n.type)){var i=n.component;i.beforeDestroy&&i.beforeDestroy()}else kp(n,t=Cp(n))}n.ref&&(n.component?n.ref(n.component):n.node&&n.ref(n.node))}}function eb(n,t){var e=t.props,r=t.component;return r?(r.prevProps=r.props,r.props=t.props,r):new n(e)}function Tp(n){for(var t=n;n&&!n.skip;){if(Te()(n.type)){var e=eb(n.type,n);e.vnode=n,n.component=e,n.props.children=n.children=[e.render()],Sp(n)}else n.node||(n.node=Xy(n)),Sp(n);if(n.firstChild)n=n.firstChild;else{for(;n&&n.parent&&!n.next&&(n=n.parent)!==t;);n=n.next}}}function Sp(n){var t=n.children,e=n.old?n.old.firstChild:null,r=null;t.forEach(function(o,s){var a=function(l,c){return l&&c&&c.type===l.type&&(!c.key||c.key===l.key)}(e,o);a&&(o.old=e,o.parent=n,o.node=e.node,o.component=e.component,o.effect="U"),o&&!a&&(o.old=null,o.parent=n,o.node=null,o.effect="A"),e&&!a&&(He.removalNodes.push(e),e.effect="D"),e&&(e=e.next),s===0?n.firstChild=o:o&&(r.next=o),r=o});var i=At(t);if(!t.length)for(;e;)He.removalNodes.push(e),e.effect="D",e=e.next;for(;e&&i;)e&&i.old!==e&&(He.removalNodes.push(e),e.effect="D",e=e.next)}function nb(n,t){var e=new He(n.tagName.toLowerCase(),{},[t]);return e.node=n,He.removalNodes=[],Tp(e),ll(e),function(){return function(r){r.effect="D",He.removalNodes=[r],ll(),He.removalNodes=[]}(e.firstChild)}}var Mp,ee=function(){function n(t){this.props=t,this.state={},this.refs={}}return n.prototype.setState=function(t){var e=v(v({},this.state),t);wn(this.state,e)||(this.state=e,function(r){var i=r.vnode;i.effect="U",i.old=i,i.next&&(i.next.skip=!0),He.removalNodes=[],Tp(i),ll(i),i.next&&(i.next.skip=!1)}(this))},n}(),rb=function(n){function t(e){var r=n.call(this,e)||this;return r.state={hide:!1},r}return k(t,n),t.prototype.show=function(){this.setState({hide:!1})},t.prototype.hide=function(){this.setState({hide:!0})},t.prototype.render=function(){var e=this.props,r=e.editorType,i=e.eventEmitter;return ht(Mp||(Mp=N([`
      <div class="`,'" style="display: ',`">
        <div
          class="tab-item`,`"
          onClick=`,`
        >
          `,`
        </div>
        <div
          class="tab-item`,`"
          onClick=`,`
        >
          `,`
        </div>
      </div>
    `],[`
      <div class="`,'" style="display: ',`">
        <div
          class="tab-item`,`"
          onClick=`,`
        >
          `,`
        </div>
        <div
          class="tab-item`,`"
          onClick=`,`
        >
          `,`
        </div>
      </div>
    `])),J("mode-switch"),this.state.hide?"none":"block",r==="markdown"?" active":"",function(){i.emit("needChangeMode","markdown")},ct.get("Markdown"),r==="wysiwyg"?" active":"",function(){i.emit("needChangeMode","wysiwyg")},ct.get("WYSIWYG"))},t}(ee),ib=b(423),ob=b.n(ib),Ip=function(){if(typeof Map<"u")return Map;function n(t,e){var r=-1;return t.some(function(i,o){return i[0]===e&&(r=o,!0)}),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(e){var r=n(this.__entries__,e),i=this.__entries__[r];return i&&i[1]},t.prototype.set=function(e,r){var i=n(this.__entries__,e);~i?this.__entries__[i][1]=r:this.__entries__.push([e,r])},t.prototype.delete=function(e){var r=this.__entries__,i=n(r,e);~i&&r.splice(i,1)},t.prototype.has=function(e){return!!~n(this.__entries__,e)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,r){r===void 0&&(r=null);for(var i=0,o=this.__entries__;i<o.length;i++){var s=o[i];e.call(r,s[1],s[0])}},t}()}(),cl=typeof window<"u"&&typeof document<"u"&&window.document===document,Xo=b.g!==void 0&&b.g.Math===Math?b.g:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),sb=typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Xo):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)},ab=["top","right","bottom","left","width","height","size","weight"],lb=typeof MutationObserver<"u",cb=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var r=!1,i=!1,o=0;function s(){r&&(r=!1,t()),i&&l()}function a(){sb(s)}function l(){var c=Date.now();if(r){if(c-o<2)return;i=!0}else r=!0,i=!1,setTimeout(a,e);o=c}return l}(this.refresh.bind(this),20)}return n.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},n.prototype.removeObserver=function(t){var e=this.observers_,r=e.indexOf(t);~r&&e.splice(r,1),!e.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},n.prototype.updateObservers_=function(){var t=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return t.forEach(function(e){return e.broadcastActive()}),t.length>0},n.prototype.connect_=function(){cl&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),lb?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){cl&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(t){var e=t.propertyName,r=e===void 0?"":e;ab.some(function(i){return!!~r.indexOf(i)})&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),Np=function(n,t){for(var e=0,r=Object.keys(t);e<r.length;e++){var i=r[e];Object.defineProperty(n,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return n},ni=function(n){return n&&n.ownerDocument&&n.ownerDocument.defaultView||Xo},Op=ts(0,0,0,0);function Zo(n){return parseFloat(n)||0}function Lp(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return t.reduce(function(r,i){return r+Zo(n["border-"+i+"-width"])},0)}function ub(n){var t=n.clientWidth,e=n.clientHeight;if(!t&&!e)return Op;var r=ni(n).getComputedStyle(n),i=function(d){for(var p={},h=0,f=["top","right","bottom","left"];h<f.length;h++){var m=f[h],g=d["padding-"+m];p[m]=Zo(g)}return p}(r),o=i.left+i.right,s=i.top+i.bottom,a=Zo(r.width),l=Zo(r.height);if(r.boxSizing==="border-box"&&(Math.round(a+o)!==t&&(a-=Lp(r,"left","right")+o),Math.round(l+s)!==e&&(l-=Lp(r,"top","bottom")+s)),!function(d){return d===ni(d).document.documentElement}(n)){var c=Math.round(a+o)-t,u=Math.round(l+s)-e;Math.abs(c)!==1&&(a-=c),Math.abs(u)!==1&&(l-=u)}return ts(i.left,i.top,a,l)}var db=typeof SVGGraphicsElement<"u"?function(n){return n instanceof ni(n).SVGGraphicsElement}:function(n){return n instanceof ni(n).SVGElement&&typeof n.getBBox=="function"};function pb(n){return cl?db(n)?function(t){var e=t.getBBox();return ts(0,0,e.width,e.height)}(n):ub(n):Op}function ts(n,t,e,r){return{x:n,y:t,width:e,height:r}}var hb=function(){function n(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=ts(0,0,0,0),this.target=t}return n.prototype.isActive=function(){var t=pb(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},n}(),fb=function(n,t){var e=function(r){var i=r.x,o=r.y,s=r.width,a=r.height,l=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,c=Object.create(l.prototype);return Np(c,{x:i,y:o,width:s,height:a,top:o,right:i+s,bottom:a+o,left:i}),c}(t);Np(this,{target:n,contentRect:e})},mb=function(){function n(t,e,r){if(this.activeObservations_=[],this.observations_=new Ip,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=r}return n.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(t instanceof ni(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new hb(t)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element<"u"&&Element instanceof Object){if(!(t instanceof ni(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(e){e.isActive()&&t.activeObservations_.push(e)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map(function(r){return new fb(r.target,r.broadcastRect())});this.callback_.call(t,e,t),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),Ap=typeof WeakMap<"u"?new WeakMap:new Ip,Dp=function n(t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var e=cb.getInstance(),r=new mb(t,e,this);Ap.set(this,r)};["observe","unobserve","disconnect"].forEach(function(n){Dp.prototype[n]=function(){var t;return(t=Ap.get(this))[n].apply(t,arguments)}});var Rp,Pp,Fp,Bp,Hp,zp,_p,qp,$p,jp,Vp,Up,Wp,Kp,Gp,Jp,gb=Xo.ResizeObserver!==void 0?Xo.ResizeObserver:Dp,vb=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),t.prototype.execCommand=function(e){var r=Ze(e.target,"li");this.props.execCommand("heading",{level:Number(r.getAttribute("data-level"))})},t.prototype.render=function(){var e=this;return ht(Pp||(Pp=N([`
      <ul
        onClick=`,`
        aria-role="menu"
        aria-label="`,`"
      >
        `,`
        <li data-type="Paragraph" aria-role="menuitem">
          <div>`,`</div>
        </li>
      </ul>
    `],[`
      <ul
        onClick=`,`
        aria-role="menu"
        aria-label="`,`"
      >
        `,`
        <li data-type="Paragraph" aria-role="menuitem">
          <div>`,`</div>
        </li>
      </ul>
    `])),function(r){return e.execCommand(r)},ct.get("Headings"),[1,2,3,4,5,6].map(function(r){return ht(Rp||(Rp=N([`
              <li data-level="`,`" data-type="Heading" aria-role="menuitem">
                <`,">"," ",`</$>
              </li>
            `],[`
              <li data-level="`,`" data-type="Heading" aria-role="menuitem">
                <`,">"," ",`</$>
              </li>
            `])),r,"h"+r,ct.get("Heading"),r)}),ct.get("Paragraph"))},t}(ee),Yp=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),t.prototype.toggleTab=function(e,r){this.props.onClick(e,r)},t.prototype.render=function(){var e=this;return ht(Bp||(Bp=N([`
      <div class="`,`" aria-role="tabpanel">
        `,`
      </div>
    `],[`
      <div class="`,`" aria-role="tabpanel">
        `,`
      </div>
    `])),J("tabs"),this.props.tabs.map(function(r){var i=r.name,o=r.text,s=e.props.activeTab===i;return ht(Fp||(Fp=N([`
            <div
              class="tab-item`,`"
              onClick=`,`
              aria-role="tab"
              aria-label="`,`"
              aria-selected="`,`"
              tabindex="`,`"
            >
              `,`
            </div>
          `],[`
            <div
              class="tab-item`,`"
              onClick=`,`
              aria-role="tab"
              aria-label="`,`"
              aria-selected="`,`"
              tabindex="`,`"
            >
              `,`
            </div>
          `])),s?" active":"",function(a){return e.toggleTab(a,i)},ct.get(o),s?"true":"false",s?"0":"-1",ct.get(o))}))},t}(ee),yb=function(n){function t(e){var r=n.call(this,e)||this;return r.initialize=function(i){i===void 0&&(i="file");var o=r.refs.url;o.value="",r.refs.altText.value="",r.refs.file.value="",re()(o,"wrong"),r.setState({activeTab:i,file:null,fileNameElClassName:""})},r.execCommand=function(){r.state.activeTab==="file"?r.emitAddImageBlob():r.emitAddImage()},r.toggleTab=function(i,o){o!==r.state.activeTab&&r.initialize(o)},r.showFileSelectBox=function(){r.refs.file.click()},r.changeFile=function(i){var o=i.target.files;o?.length&&r.setState({file:o[0]})},r.state={activeTab:"file",file:null,fileNameElClassName:""},r.tabs=[{name:"file",text:"File"},{name:"url",text:"URL"}],r}return k(t,n),t.prototype.emitAddImageBlob=function(){var e=this,r=this.refs.file.files,i=this.refs.altText,o=" wrong";if(r?.length){o="";var s=r.item(0);this.props.eventEmitter.emit("addImageBlobHook",s,function(a,l){return e.props.execCommand("addImage",{imageUrl:a,altText:l||i.value})},"ui")}this.setState({fileNameElClassName:o})},t.prototype.emitAddImage=function(){var e=this.refs.url,r=this.refs.altText,i=e.value,o=r.value||"image";re()(e,"wrong"),i.length?i&&this.props.execCommand("addImage",{imageUrl:i,altText:o}):me()(e,"wrong")},t.prototype.preventSelectStart=function(e){e.preventDefault()},t.prototype.updated=function(){this.props.show||this.initialize()},t.prototype.render=function(){var e=this,r=this.state,i=r.activeTab,o=r.file,s=r.fileNameElClassName;return ht(Hp||(Hp=N([`
      <div aria-label="`,`">
        <`," tabs="," activeTab="," onClick=",` />
        <div style="display:`,`">
          <label for="toastuiImageUrlInput">`,`</label>
          <input
            id="toastuiImageUrlInput"
            type="text"
            ref=`,`
          />
        </div>
        <div style="display:`,`;position: relative;">
          <label for="toastuiImageFileInput">`,`</label>
          <span
            class="`,"",`"
            onClick=`,`
            onSelectstart=`,`
          >
            `,`
          </span>
          <button
            type="button"
            class="`,`"
            onClick=`,`
          >
            `,`
          </button>
          <input
            id="toastuiImageFileInput"
            type="file"
            accept="image/*"
            onChange=`,`
            ref=`,`
          />
        </div>
        <label for="toastuiAltTextInput">`,`</label>
        <input
          id="toastuiAltTextInput"
          type="text"
          ref=`,`
        />
        <div class="`,`">
          <button type="button" class="`,'" onClick=',`>
            `,`
          </button>
          <button type="button" class="`,'" onClick=',`>
            `,`
          </button>
        </div>
      </div>
    `],[`
      <div aria-label="`,`">
        <`," tabs="," activeTab="," onClick=",` />
        <div style="display:`,`">
          <label for="toastuiImageUrlInput">`,`</label>
          <input
            id="toastuiImageUrlInput"
            type="text"
            ref=`,`
          />
        </div>
        <div style="display:`,`;position: relative;">
          <label for="toastuiImageFileInput">`,`</label>
          <span
            class="`,"",`"
            onClick=`,`
            onSelectstart=`,`
          >
            `,`
          </span>
          <button
            type="button"
            class="`,`"
            onClick=`,`
          >
            `,`
          </button>
          <input
            id="toastuiImageFileInput"
            type="file"
            accept="image/*"
            onChange=`,`
            ref=`,`
          />
        </div>
        <label for="toastuiAltTextInput">`,`</label>
        <input
          id="toastuiAltTextInput"
          type="text"
          ref=`,`
        />
        <div class="`,`">
          <button type="button" class="`,'" onClick=',`>
            `,`
          </button>
          <button type="button" class="`,'" onClick=',`>
            `,`
          </button>
        </div>
      </div>
    `])),ct.get("Insert image"),Yp,this.tabs,i,this.toggleTab,i==="url"?"block":"none",ct.get("Image URL"),function(a){return e.refs.url=a},i==="file"?"block":"none",ct.get("Select image file"),J("file-name"),o?" has-file":s,this.showFileSelectBox,this.preventSelectStart,o?o.name:ct.get("No file"),J("file-select-button"),this.showFileSelectBox,ct.get("Choose a file"),this.changeFile,function(a){return e.refs.file=a},ct.get("Description"),function(a){return e.refs.altText=a},J("button-container"),J("close-button"),this.props.hidePopup,ct.get("Cancel"),J("ok-button"),this.execCommand,ct.get("OK"))},t}(ee),bb=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.execCommand=function(){var r=e.refs.url,i=e.refs.text;re()(r,"wrong"),re()(i,"wrong"),r.value.length<1?me()(r,"wrong"):_t()(e.props.initialValues.linkUrl)&&i.value.length<1?me()(i,"wrong"):e.props.execCommand("addLink",{linkUrl:r.value,linkText:i.value})},e}return k(t,n),t.prototype.initialize=function(){var e=this.props.initialValues,r=e.linkUrl,i=e.linkText,o=this.refs.url,s=this.refs.text;re()(o,"wrong"),re()(s,"wrong","disabled"),s.removeAttribute("disabled"),r&&(me()(s,"disabled"),s.setAttribute("disabled","disabled")),o.value=r||"",s.value=i||""},t.prototype.mounted=function(){this.initialize()},t.prototype.updated=function(e){!e.show&&this.props.show&&this.initialize()},t.prototype.render=function(){var e=this;return ht(zp||(zp=N([`
      <div aria-label="`,`">
        <label for="toastuiLinkUrlInput">`,`</label>
        <input
          id="toastuiLinkUrlInput"
          type="text"
          ref=`,`
        />
        <label for="toastuiLinkTextInput">`,`</label>
        <input
          id="toastuiLinkTextInput"
          type="text"
          ref=`,`
        />
        <div class="`,`">
          <button type="button" class="`,'" onClick=',`>
            `,`
          </button>
          <button type="button" class="`,'" onClick=',`>
            `,`
          </button>
        </div>
      </div>
    `],[`
      <div aria-label="`,`">
        <label for="toastuiLinkUrlInput">`,`</label>
        <input
          id="toastuiLinkUrlInput"
          type="text"
          ref=`,`
        />
        <label for="toastuiLinkTextInput">`,`</label>
        <input
          id="toastuiLinkTextInput"
          type="text"
          ref=`,`
        />
        <div class="`,`">
          <button type="button" class="`,'" onClick=',`>
            `,`
          </button>
          <button type="button" class="`,'" onClick=',`>
            `,`
          </button>
        </div>
      </div>
    `])),ct.get("Insert link"),ct.get("URL"),function(r){return e.refs.url=r},ct.get("Link text"),function(r){return e.refs.text=r},J("button-container"),J("close-button"),this.props.hidePopup,ct.get("Cancel"),J("ok-button"),this.execCommand,ct.get("OK"))},t}(ee),wb=function(n){function t(e){var r=n.call(this,e)||this;return r.extendSelectionRange=function(i){var o=i.pageX,s=i.pageY,a=o-r.offsetRect.left,l=s-r.offsetRect.top,c=r.getSelectionRangeByOffset(a,l);r.setState(v({},c))},r.execCommand=function(){r.props.execCommand("addTable",{rowCount:r.state.rowIdx+1,columnCount:r.state.colIdx+1})},r.state={rowIdx:-1,colIdx:-1},r}return k(t,n),t.prototype.getDescription=function(){return this.state.colIdx===-1?"":this.state.colIdx+1+" x "+(this.state.rowIdx+1)},t.prototype.getBoundByRange=function(e,r){return{width:20*(e+1),height:20*(r+1)}},t.prototype.getRangeByOffset=function(e,r){return{colIdx:Math.floor(e/20),rowIdx:Math.floor(r/20)}},t.prototype.getTableRange=function(){var e=this.state,r=e.colIdx,i=e.rowIdx,o=Math.max(r,5),s=Math.max(i,5);return r>=5&&o<9&&(o+=1),i>=5&&s<14&&(s+=1),{colIdx:o+1,rowIdx:s+1}},t.prototype.getSelectionAreaBound=function(){var e=this.getBoundByRange(this.state.colIdx,this.state.rowIdx),r=e.width,i=e.height;return r||i?{width:r-1,height:i-1,display:"block"}:{display:"none"}},t.prototype.getSelectionRangeByOffset=function(e,r){var i=this.getRangeByOffset(e,r);return i.rowIdx=Math.min(Math.max(i.rowIdx,1),14),i.colIdx=Math.min(Math.max(i.colIdx,1),9),i},t.prototype.updated=function(){if(this.props.show){if(this.state.colIdx===-1&&this.state.rowIdx===-1){var e=this.refs.tableEl.getBoundingClientRect(),r=e.left,i=e.top;this.offsetRect={left:window.pageXOffset+r,top:window.pageYOffset+i}}}else this.setState({colIdx:-1,rowIdx:-1})},t.prototype.createTableArea=function(e){for(var r=e.colIdx,i=e.rowIdx,o=[],s=0;s<i;s+=1){for(var a=[],l=0;l<r;l+=1){var c=J("table-cell")+(s>0?"":" header");a.push(ht(_p||(_p=N(['<div class="','"></div>'],['<div class="','"></div>'])),c))}o.push(ht(qp||(qp=N(['<div class="','">',"</div>"],['<div class="','">',"</div>"])),J("table-row"),a))}return ht($p||($p=N(['<div class="','">',"</div>"],['<div class="','">',"</div>"])),J("table"),o)},t.prototype.render=function(){var e=this,r=this.getTableRange(),i=this.getSelectionAreaBound();return ht(jp||(jp=N([`
      <div aria-label="`,`">
        <div
          class="`,`"
          ref=`,`
          onMousemove=`,`
          onClick=`,`
        >
          `,`
          <div class="`,'" style=',`></div>
        </div>
        <p class="`,'">',`</p>
      </div>
    `],[`
      <div aria-label="`,`">
        <div
          class="`,`"
          ref=`,`
          onMousemove=`,`
          onClick=`,`
        >
          `,`
          <div class="`,'" style=',`></div>
        </div>
        <p class="`,'">',`</p>
      </div>
    `])),ct.get("Insert table"),J("table-selection"),function(o){return e.refs.tableEl=o},this.extendSelectionRange,this.execCommand,this.createTableArea(r),J("table-selection-layer"),i,J("table-description"),this.getDescription())},t}(ee),kb=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),t.prototype.mounted=function(){this.refs.el.appendChild(this.props.body)},t.prototype.updated=function(e){this.refs.el.replaceChild(this.props.body,e.body)},t.prototype.render=function(){var e=this;return ht(Vp||(Vp=N(["<div ref=","></div>"],["<div ref=","></div>"])),function(r){return e.refs.el=r})},t}(ee);function ul(n){return gn()(n)?function(t){var e;switch(t){case"heading":e={name:"heading",className:"heading",tooltip:ct.get("Headings"),state:"heading"};break;case"bold":e={name:"bold",className:"bold",command:"bold",tooltip:ct.get("Bold"),state:"strong"};break;case"italic":e={name:"italic",className:"italic",command:"italic",tooltip:ct.get("Italic"),state:"emph"};break;case"strike":e={name:"strike",className:"strike",command:"strike",tooltip:ct.get("Strike"),state:"strike"};break;case"hr":e={name:"hr",className:"hrline",command:"hr",tooltip:ct.get("Line"),state:"thematicBreak"};break;case"quote":e={name:"quote",className:"quote",command:"blockQuote",tooltip:ct.get("Blockquote"),state:"blockQuote"};break;case"ul":e={name:"ul",className:"bullet-list",command:"bulletList",tooltip:ct.get("Unordered list"),state:"bulletList"};break;case"ol":e={name:"ol",className:"ordered-list",command:"orderedList",tooltip:ct.get("Ordered list"),state:"orderedList"};break;case"task":e={name:"task",className:"task-list",command:"taskList",tooltip:ct.get("Task"),state:"taskList"};break;case"table":e={name:"table",className:"table",tooltip:ct.get("Insert table"),state:"table"};break;case"image":e={name:"image",className:"image",tooltip:ct.get("Insert image")};break;case"link":e={name:"link",className:"link",tooltip:ct.get("Insert link")};break;case"code":e={name:"code",className:"code",command:"code",tooltip:ct.get("Code"),state:"code"};break;case"codeblock":e={name:"codeblock",className:"codeblock",command:"codeBlock",tooltip:ct.get("Insert CodeBlock"),state:"codeBlock"};break;case"indent":e={name:"indent",className:"indent",command:"indent",tooltip:ct.get("Indent"),state:"indent"};break;case"outdent":e={name:"outdent",className:"outdent",command:"outdent",tooltip:ct.get("Outdent"),state:"outdent"};break;case"scrollSync":e=function(){var r=document.createElement("label"),i=document.createElement("input"),o=document.createElement("span");r.className="scroll-sync active",i.type="checkbox",i.checked=!0,o.className="switch";var s=function(a){return i.addEventListener("change",function(l){var c=l.target.checked;c?me()(r,"active"):re()(r,"active"),a("toggleScrollSync",{active:c})})};return r.appendChild(i),r.appendChild(o),{name:"scrollSync",el:r,onMounted:s}}();break;case"more":e={name:"more",className:"more",tooltip:ct.get("More")}}return e.name!=="scrollSync"&&(e.className+=" "+J("toolbar-icons")),e}(n):n}function dl(n,t){var e=t.el,r=t.pos,i=t.popup,o=t.initialValues;switch(n){case"heading":return{render:function(s){return ht(Up||(Up=N(["<"," ..."," />"],["<"," ..."," />"])),vb,s)},className:J("popup-add-heading"),fromEl:e,pos:r};case"link":return{render:function(s){return ht(Wp||(Wp=N(["<"," ..."," />"],["<"," ..."," />"])),bb,s)},className:J("popup-add-link"),fromEl:e,pos:r,initialValues:o};case"image":return{render:function(s){return ht(Kp||(Kp=N(["<"," ..."," />"],["<"," ..."," />"])),yb,s)},className:J("popup-add-image"),fromEl:e,pos:r};case"table":return{render:function(s){return ht(Gp||(Gp=N(["<"," ..."," />"],["<"," ..."," />"])),wb,s)},className:J("popup-add-table"),fromEl:e,pos:r};case"customPopupBody":return i?v({render:function(s){return ht(Jp||(Jp=N(["<"," ..."," body="," />"],["<"," ..."," body="," />"])),kb,s,i.body)},fromEl:e,pos:r},i):null;default:return null}}function es(n){n.hidden=n.length===n.filter(function(t){return t.hidden}).length}function xb(n,t){return n.reduce(function(e,r){e.push(r.map(function(o){return function(s){return s.hidden=s.name==="scrollSync"&&t,s}(ul(o))}));var i=e[(e.length||1)-1];return i&&es(i),e},[])}var Qp,Xp,Cb=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.handleMousedown=function(r){Ze(r.target,"."+J("popup"))||Ze(r.target,e.props.info.fromEl)||e.props.hidePopup()},e}return k(t,n),t.prototype.mounted=function(){document.addEventListener("mousedown",this.handleMousedown),this.props.eventEmitter.listen("closePopup",this.props.hidePopup)},t.prototype.beforeDestroy=function(){document.removeEventListener("mousedown",this.handleMousedown)},t.prototype.updated=function(e){var r=this.props,i=r.show,o=r.info;if(i&&o.pos&&e.show!==i){var s=v({},o.pos),a=this.refs.el.offsetWidth,l=Ze(this.refs.el,"."+J("toolbar")).offsetWidth;s.left+a>=l&&(s.left=l-a-20),wn(this.state.popupPos,s)||this.setState({popupPos:s})}},t.prototype.render=function(){var e=this,r=this.props,i=r.info,o=r.show,s=r.hidePopup,a=r.eventEmitter,l=r.execCommand,c=i||{},u=c.className,d=u===void 0?"":u,p=c.style,h=c.render,f=c.initialValues,m=f===void 0?{}:f,g=v(v({display:o?"block":"none"},p),this.state.popupPos);return ht(Qp||(Qp=N([`
      <div
        class="`," ",`"
        style=`,`
        ref=`,`
        aria-role="dialog"
      >
        <div class="`,`">
          `,`
        </div>
      </div>
    `],[`
      <div
        class="`," ",`"
        style=`,`
        ref=`,`
        aria-role="dialog"
      >
        <div class="`,`">
          `,`
        </div>
      </div>
    `])),J("popup"),d,g,function(w){return e.refs.el=w},J("popup-body"),h&&h({eventEmitter:a,show:o,hidePopup:s,execCommand:l,initialValues:m}))},t}(ee);function pl(n){return function(t){function e(r){var i=t.call(this,r)||this;return i.showTooltip=function(o){var s=i.props.item.tooltip;if(!i.props.disabled&&s){var a=i.getBound(o),l=a.left+6+"px",c=a.top+6+"px";ae()(i.props.tooltipRef.current,{display:"block",left:l,top:c}),i.props.tooltipRef.current.querySelector(".text").textContent=s}},i.hideTooltip=function(){ae()(i.props.tooltipRef.current,"display","none")},i.state={active:!1,disabled:r.disabled},i.addEvent(),i}return k(e,t),e.prototype.addEvent=function(){var r=this,i=this.props,o=i.item,s=i.eventEmitter;o.state&&s.listen("changeToolbarState",function(a){var l,c=(l=a.toolbarState[o.state])!==null&&l!==void 0?l:{},u=c.active,d=c.disabled;r.setState({active:!!u,disabled:d??r.props.disabled})})},e.prototype.getBound=function(r){var i=au(r,Ze(r,"."+J("toolbar"))),o=i.offsetLeft,s=i.offsetTop;return{left:o,top:r.offsetHeight+s}},e.prototype.render=function(){return ht(Xp||(Xp=N([`
        <`,`
          ...`,`
          active=`,`
          showTooltip=`,`
          hideTooltip=`,`
          getBound=`,`
          disabled=`,`
        />
      `],[`
        <`,`
          ...`,`
          active=`,`
          showTooltip=`,`
          hideTooltip=`,`
          getBound=`,`
          disabled=`,`
        />
      `])),n,this.props,this.state.active,this.showTooltip,this.hideTooltip,this.getBound,this.state.disabled||this.props.disabled)},e}(ee)}var Zp,th,eh,nh,rh,ih,oh,sh,ah,lh,ch,uh,dh,ph,Eb=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.showTooltip=function(){e.props.showTooltip(e.refs.el)},e.execCommand=function(){var r=e.props,i=r.item,o=r.execCommand,s=r.setPopupInfo,a=r.getBound,l=r.eventEmitter,c=i.command,u=i.name,d=i.popup;if(c)o(c);else{var p=d?"customPopupBody":u,h=l.emit("query","getPopupInitialValues",{popupName:p})[0],f=dl(p,{el:e.refs.el,pos:a(e.refs.el),popup:d,initialValues:h});f&&s(f)}},e}return k(t,n),t.prototype.mounted=function(){this.setItemWidth()},t.prototype.updated=function(e){e.item.name!==this.props.item.name&&this.setItemWidth()},t.prototype.setItemWidth=function(){var e=this.props,r=e.setItemWidth,i=e.item;r&&r(i.name,ua(this.refs.el)+(i.hidden?80:0))},t.prototype.render=function(){var e=this,r=this.props,i=r.hideTooltip,o=r.disabled,s=r.item,a=r.active,l=v({display:s.hidden?"none":null},s.style),c=(s.className||"")+(a?" active":"");return ht(Zp||(Zp=N([`
      <button
        ref=`,`
        type="button"
        style=`,`
        class=`,`
        onClick=`,`
        onMouseover=`,`
        onMouseout=`,`
        disabled=`,`
        aria-label=`,`
      >
        `,`
      </button>
    `],[`
      <button
        ref=`,`
        type="button"
        style=`,`
        class=`,`
        onClick=`,`
        onMouseover=`,`
        onMouseout=`,`
        disabled=`,`
        aria-label=`,`
      >
        `,`
      </button>
    `])),function(u){return e.refs.el=u},l,c,this.execCommand,this.showTooltip,i,!!o,s.text||s.tooltip||"",s.text||"")},t}(ee),Tb=pl(Eb),Sb=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.showTooltip=function(){e.props.showTooltip(e.refs.el)},e.showPopup=function(){var r=dl("customPopupBody",{el:e.refs.el,pos:e.props.getBound(e.refs.el),popup:e.props.item.popup});r&&e.props.setPopupInfo(r)},e}return k(t,n),t.prototype.mounted=function(){var e=this.props,r=e.setItemWidth,i=e.item;this.refs.el.appendChild(i.el),r&&r(i.name,ua(this.refs.el)),i.onMounted&&i.onMounted(this.props.execCommand)},t.prototype.updated=function(e){var r,i=this.props,o=i.item,s=i.active,a=i.disabled;e.active===s&&e.disabled===a||(r=o.onUpdated)===null||r===void 0||r.call(o,{active:s,disabled:a})},t.prototype.render=function(){var e=this,r=this.props,i=r.disabled,o={display:r.item.hidden?"none":"inline-block"},s=function(a){return i?null:a};return ht(th||(th=N([`
      <div
        ref=`,`
        style=`,`
        class=`,`
        onClick=`,`
        onMouseover=`,`
        onMouseout=`,`
      ></div>
    `],[`
      <div
        ref=`,`
        style=`,`
        class=`,`
        onClick=`,`
        onMouseover=`,`
        onMouseout=`,`
      ></div>
    `])),function(a){return e.refs.el=a},o,J("toolbar-item-wrapper"),s(this.showPopup),s(this.showTooltip),s(this.props.hideTooltip))},t}(ee),Mb=pl(Sb),hh=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return k(t,n),t.prototype.render=function(){var e=this,r=this.props,i=r.group,o=r.hiddenDivider,s=i.hidden?{display:"none"}:null,a=o?{display:"none"}:null;return ht(nh||(nh=N([`
      <div class="`,'" style=',`>
        `,`
        <div class="`,'" style=',`></div>
      </div>
    `],[`
      <div class="`,'" style=',`>
        `,`
        <div class="`,'" style=',`></div>
      </div>
    `])),J("toolbar-group"),s,i.map(function(l){var c=l.el?Mb:Tb;return ht(eh||(eh=N(["<"," key="," ..."," item="," />"],["<"," key="," ..."," item="," />"])),c,l.name,e.props,l)}),J("toolbar-divider"),a)},t}(ee),Ib=function(n){function t(e){var r=n.call(this,e)||this;return r.handleClickDocument=function(i){var o=i.target;Ze(o,"."+J("dropdown-toolbar"))||Ze(o,".more")||r.setState({showDropdown:!1,dropdownPos:null})},r.showTooltip=function(){r.props.showTooltip(r.refs.el)},r.state={showDropdown:!1,dropdownPos:null},r}return k(t,n),t.prototype.getBound=function(){var e=this.props.getBound(this.refs.el);return e.top+=4,v(v({},e),{left:null,right:10})},t.prototype.mounted=function(){document.addEventListener("click",this.handleClickDocument)},t.prototype.updated=function(){this.state.showDropdown&&!this.state.dropdownPos&&this.setState({dropdownPos:this.getBound()})},t.prototype.beforeDestroy=function(){document.removeEventListener("click",this.handleClickDocument)},t.prototype.render=function(){var e=this,r=this.state,i=r.showDropdown,o=r.dropdownPos,s=this.props,a=s.disabled,l=s.item,c=s.items,u=s.hideTooltip,d=c.filter(function(f){return!f.hidden}),p=d.length?null:{display:"none"},h=i?null:{display:"none"};return ht(ih||(ih=N([`
      <div class="`,'" style=',`>
        <button
          ref=`,`
          type="button"
          class=`,`
          onClick=`,`
          onMouseover=`,`
          onMouseout=`,`
          disabled=`,`
        ></button>
        <div
          class="`,`"
          style=`,`
          ref=`,`
        >
          `,`
        </div>
      </div>
    `],[`
      <div class="`,'" style=',`>
        <button
          ref=`,`
          type="button"
          class=`,`
          onClick=`,`
          onMouseover=`,`
          onMouseout=`,`
          disabled=`,`
        ></button>
        <div
          class="`,`"
          style=`,`
          ref=`,`
        >
          `,`
        </div>
      </div>
    `])),J("toolbar-group"),p,function(f){return e.refs.el=f},l.className,function(){return e.setState({showDropdown:!0})},this.showTooltip,u,a,J("dropdown-toolbar"),v(v({},h),o),function(f){return e.refs.dropdownEl=f},d.length?d.map(function(f,m){var g;return ht(rh||(rh=N([`
                  <`,`
                    group=`,`
                    hiddenDivider=`,`
                    ...`,`
                  />
                `],[`
                  <`,`
                    group=`,`
                    hiddenDivider=`,`
                    ...`,`
                  />
                `])),hh,f,m===d.length-1||((g=d[m+1])===null||g===void 0?void 0:g.hidden),e.props)}):null)},t}(ee),Nb=pl(Ib),Ob=function(n){function t(e){var r=n.call(this,e)||this;return r.toggleTab=function(i,o){var s=r.props.eventEmitter;if(r.state.activeTab!==o){var a=o==="write"?"changePreviewTabWrite":"changePreviewTabPreview";s.emit(a),r.setState({activeTab:o})}},r.setItemWidth=function(i,o){r.itemWidthMap[i]=o},r.setPopupInfo=function(i){r.setState({showPopup:!0,popupInfo:i})},r.openPopup=function(i,o){o===void 0&&(o={});var s=r.refs.el.querySelector("."+J("toolbar-group")+" ."+i);if(s){var a=au(s,Ze(s,"."+J("toolbar"))),l=a.offsetLeft,c=a.offsetTop,u=dl(i,{el:s,pos:{left:l,top:s.offsetHeight+c},initialValues:o});u&&r.setPopupInfo(u)}},r.hidePopup=function(){r.state.showPopup&&r.setState({showPopup:!1})},r.execCommand=function(i,o){r.props.eventEmitter.emit("command",i,o),r.hidePopup()},r.tabs=[{name:"write",text:"Write"},{name:"preview",text:"Preview"}],r.itemWidthMap={},r.initialItems=xb(e.toolbarItems||[],r.hiddenScrollSync()),r.state={items:r.initialItems,dropdownItems:[],showPopup:!1,popupInfo:{},activeTab:"write"},r.tooltipRef={current:null},r.resizeObserver=new gb(function(){return r.handleResize()}),r.addEvent(),r}return k(t,n),t.prototype.insertToolbarItem=function(e,r){var i=e.groupIndex,o=e.itemIndex,s=this.initialItems[i];r=ul(r),s?s.splice(o,0,r):this.initialItems.push([r]),this.setState(this.classifyToolbarItems())},t.prototype.removeToolbarItem=function(e){var r=this;ha()(this.initialItems,function(i){var o=!1;return ha()(i,function(s,a){return s.name!==e||(o=!0,i.splice(a,1),r.setState(r.classifyToolbarItems()),!1)}),!o})},t.prototype.addEvent=function(){var e=this,r=this.props.eventEmitter;this.handleResize=ob()(function(){e.setState({items:e.initialItems,dropdownItems:[]}),e.setState(e.classifyToolbarItems())},200),r.listen("openPopup",this.openPopup)},t.prototype.appendTooltipToRoot=function(){var e='<div class="'+J("tooltip")+`" style="display:none">
        <div class="arrow"></div>
        <span class="text"></span>
      </div>`;this.tooltipRef.current=su(e,this.refs.el)},t.prototype.hiddenScrollSync=function(){return this.props.editorType==="wysiwyg"||this.props.previewStyle==="tab"},t.prototype.movePrevItemToDropdownToolbar=function(e,r,i,o){var s=function(l){var c=l.pop();c&&o.push(c)};if(e>1)s(i);else{var a=At(r);a&&s(a)}},t.prototype.classifyToolbarItems=function(){var e=this,r=0,i=this.refs.el.clientWidth,o=this.refs.el.querySelector("."+J("toolbar-divider")),s=o?ua(o):0,a=[],l=[],c=!1;return this.initialItems.forEach(function(u,d){var p=[],h=[];u.forEach(function(f,m){f.hidden||((r+=e.itemWidthMap[f.name])>i-50?(c||(e.movePrevItemToDropdownToolbar(m,a,p,h),c=!0),h.push(f)):p.push(f))}),p.length&&(es(p),a.push(p)),h.length&&(es(h),l.push(h)),d<e.state.items.length-1&&(r+=s)}),{items:a,dropdownItems:l}},t.prototype.mounted=function(){this.props.previewStyle==="tab"&&this.props.eventEmitter.emit("changePreviewTabWrite",!0),this.setState(this.classifyToolbarItems()),this.appendTooltipToRoot(),this.resizeObserver.observe(this.refs.el)},t.prototype.updated=function(e){var r,i,o=this.props,s=o.editorType,a=o.previewStyle,l=o.eventEmitter,c=a!==e.previewStyle,u=s!==e.editorType;if(c||u){r=this.initialItems,i=this.hiddenScrollSync(),r.forEach(function(p){p.forEach(function(h){return h.hidden=h.name==="scrollSync"&&i}),es(p)});var d=this.classifyToolbarItems();(c||a==="tab"&&s==="markdown")&&(l.emit("changePreviewTabWrite"),d.activeTab="write"),this.setState(d)}},t.prototype.beforeDestroy=function(){window.removeEventListener("resize",this.handleResize),this.resizeObserver.disconnect(),cr(this.tooltipRef.current)},t.prototype.render=function(){var e=this,r=this.props,i=r.previewStyle,o=r.eventEmitter,s=r.editorType,a=this.state,l=a.popupInfo,c=a.showPopup,u=a.activeTab,d=a.items,p=a.dropdownItems,h={eventEmitter:o,tooltipRef:this.tooltipRef,disabled:s==="markdown"&&i==="tab"&&u==="preview",execCommand:this.execCommand,setPopupInfo:this.setPopupInfo},f=i==="tab"?{borderTopLeftRadius:0}:null;return ht(sh||(sh=N([`
      <div class="`,`">
        <div
          class="`,`"
          style="display: `,`"
        >
          <`," tabs="," activeTab="," onClick=",` />
        </div>
        <div
          class="`,`"
          ref=`,`
          style=`,`
        >
          `,`
          <`,`
            item=`,`
            items=`,`
            ...`,`
          />
        </div>
        <`,`
          info=`,`
          show=`,`
          eventEmitter=`,`
          hidePopup=`,`
          execCommand=`,`
        />
      </div>
    `],[`
      <div class="`,`">
        <div
          class="`,`"
          style="display: `,`"
        >
          <`," tabs="," activeTab="," onClick=",` />
        </div>
        <div
          class="`,`"
          ref=`,`
          style=`,`
        >
          `,`
          <`,`
            item=`,`
            items=`,`
            ...`,`
          />
        </div>
        <`,`
          info=`,`
          show=`,`
          eventEmitter=`,`
          hidePopup=`,`
          execCommand=`,`
        />
      </div>
    `])),J("toolbar"),J("md-tab-container"),s==="wysiwyg"||i==="vertical"?"none":"block",Yp,this.tabs,u,this.toggleTab,J("defaultUI-toolbar"),function(m){return e.refs.el=m},f,d.map(function(m,g){var w;return ht(oh||(oh=N([`
              <`,`
                group=`,`
                hiddenDivider=`,`
                setItemWidth=`,`
                ...`,`
              />
            `],[`
              <`,`
                group=`,`
                hiddenDivider=`,`
                setItemWidth=`,`
                ...`,`
              />
            `])),hh,m,g===d.length-1||((w=d[g+1])===null||w===void 0?void 0:w.hidden),e.setItemWidth,h)}),Nb,ul("more"),p,h,Cb,l,c,o,this.hidePopup,this.execCommand)},t}(ee),Lb=function(n){function t(e){var r=n.call(this,e)||this;return r.handleClickDocument=function(i){Ze(i.target,"."+J("context-menu"))||r.setState({pos:null})},r.state={pos:null,menuGroups:[]},r.addEvent(),r}return k(t,n),t.prototype.addEvent=function(){var e=this;this.props.eventEmitter.listen("contextmenu",function(r){var i=r.pos,o=r.menuGroups;e.setState({pos:i,menuGroups:o})})},t.prototype.mounted=function(){document.addEventListener("click",this.handleClickDocument)},t.prototype.beforeDestroy=function(){document.removeEventListener("click",this.handleClickDocument)},t.prototype.getMenuGroupElements=function(){var e=this,r=this.state,i=r.pos,o=r.menuGroups;return i?o.reduce(function(s,a){var l=[];return a.forEach(function(c){var u=c.label,d=c.className,p=d!==void 0&&d,h=c.disabled,f=c.onClick;l.push(ht(ah||(ah=N([`
                <li
                  onClick=`,`
                  class="menu-item`,`"
                  aria-role="menuitem"
                >
                  <span class="`,'">',`</span>
                </li>
              `],[`
                <li
                  onClick=`,`
                  class="menu-item`,`"
                  aria-role="menuitem"
                >
                  <span class="`,'">',`</span>
                </li>
              `])),function(){h||(f(),e.setState({pos:null}))},h?" disabled":"",p,u))}),s.push(ht(lh||(lh=N([`<ul class="menu-group">
              `,`
            </ul>`],[`<ul class="menu-group">
              `,`
            </ul>`])),l)),s},[]):[]},t.prototype.render=function(){var e=v({display:this.state.pos?"block":"none"},this.state.pos);return ht(ch||(ch=N(['<div class="','" style=',` aria-role="menu">
      `,`
    </div>`],['<div class="','" style=',` aria-role="menu">
      `,`
    </div>`])),J("context-menu"),e,this.getMenuGroupElements())},t}(ee),Ab=function(n){function t(e){var r=n.call(this,e)||this;r.changeMode=function(s){s!==r.state.editorType&&r.setState({editorType:s})},r.changePreviewStyle=function(s){s!==r.state.previewStyle&&r.setState({previewStyle:s})},r.hide=function(){r.setState({hide:!0})},r.show=function(){r.setState({hide:!1})};var i=e.editorType,o=e.previewStyle;return r.state={editorType:i,previewStyle:o,hide:!1},r.addEvent(),r}return k(t,n),t.prototype.mounted=function(){var e=this.props.slots,r=e.wwEditor,i=e.mdEditor,o=e.mdPreview;this.refs.wwContainer.appendChild(r),this.refs.mdContainer.insertAdjacentElement("afterbegin",i),this.refs.mdContainer.appendChild(o)},t.prototype.insertToolbarItem=function(e,r){this.toolbar.insertToolbarItem(e,r)},t.prototype.removeToolbarItem=function(e){this.toolbar.removeToolbarItem(e)},t.prototype.render=function(){var e=this,r=this.props,i=r.eventEmitter,o=r.hideModeSwitch,s=r.toolbarItems,a=r.theme,l=this.state,c=l.hide,u=l.previewStyle,d=l.editorType,p=c?" hidden":"",h=J(d==="markdown"?"md-mode":"ww-mode"),f=J("md")+"-"+u+"-style",m=J([a!=="light",a+" "]);return ht(dh||(dh=N([`
      <div
        class="`,"","",`"
        ref=`,`
      >
        <`,`
          ref=`,`
          eventEmitter=`,`
          previewStyle=`,`
          toolbarItems=`,`
          editorType=`,`
        />
        <div
          class="`," ",`"
          ref=`,`
        >
          <div class="`,`">
            <div
              class="`," ",`"
              ref=`,`
            >
              <div class="`,`"></div>
            </div>
            <div
              class="`,`"
              ref=`,`
            />
          </div>
        </div>
        `,`
        <`," eventEmitter=",` />
      </div>
    `],[`
      <div
        class="`,"","",`"
        ref=`,`
      >
        <`,`
          ref=`,`
          eventEmitter=`,`
          previewStyle=`,`
          toolbarItems=`,`
          editorType=`,`
        />
        <div
          class="`," ",`"
          ref=`,`
        >
          <div class="`,`">
            <div
              class="`," ",`"
              ref=`,`
            >
              <div class="`,`"></div>
            </div>
            <div
              class="`,`"
              ref=`,`
            />
          </div>
        </div>
        `,`
        <`," eventEmitter=",` />
      </div>
    `])),m,J("defaultUI"),p,function(g){return e.refs.el=g},Ob,function(g){return e.toolbar=g},i,u,s,d,J("main"),h,function(g){return e.refs.editorSection=g},J("main-container"),J("md-container"),f,function(g){return e.refs.mdContainer=g},J("md-splitter"),J("ww-container"),function(g){return e.refs.wwContainer=g},!o&&ht(uh||(uh=N(["<"," eventEmitter="," editorType="," />"],["<"," eventEmitter="," editorType="," />"])),rb,i,d),Lb,i)},t.prototype.addEvent=function(){var e=this.props.eventEmitter;e.listen("hide",this.hide),e.listen("show",this.show),e.listen("changeMode",this.changeMode),e.listen("changePreviewStyle",this.changePreviewStyle)},t}(ee),Db=function(n){function t(e){var r,i,o=n.call(this,e)||this,s=nb(o.options.el,ht(ph||(ph=N([`
        <`,`
          ref=`,`
          eventEmitter=`,`
          slots=`,`
          hideModeSwitch=`,`
          toolbarItems=`,`
          previewStyle=`,`
          editorType=`,`
          theme=`,`
        />
      `],[`
        <`,`
          ref=`,`
          eventEmitter=`,`
          slots=`,`
          hideModeSwitch=`,`
          toolbarItems=`,`
          previewStyle=`,`
          editorType=`,`
          theme=`,`
        />
      `])),Ab,function(a){return i=a},o.eventEmitter,o.getEditorElements(),o.options.hideModeSwitch,o.options.toolbarItems,o.options.previewStyle,o.options.initialEditType,o.options.theme));return o.setMinHeight(o.options.minHeight),o.setHeight(o.options.height),o.defaultUI={insertToolbarItem:i.insertToolbarItem.bind(i),removeToolbarItem:i.removeToolbarItem.bind(i),destroy:s},(r=o.pluginInfo.toolbarItems)===null||r===void 0||r.forEach(function(a){var l=a.groupIndex,c=a.itemIndex,u=a.item;o.defaultUI.insertToolbarItem({groupIndex:l,itemIndex:c},u)}),o.eventEmitter.emit("loadUI",o),o}return k(t,n),t.factory=function(e){return e.viewer?new gp(e):new t(e)},t.prototype.insertToolbarItem=function(e,r){this.defaultUI.insertToolbarItem(e,r)},t.prototype.removeToolbarItem=function(e){this.defaultUI.removeToolbarItem(e)},t.prototype.destroy=function(){n.prototype.destroy.call(this),this.defaultUI.destroy()},t}(bp),Rb=Db;bp.setLanguage(["en","en-US"],{Markdown:"Markdown",WYSIWYG:"WYSIWYG",Write:"Write",Preview:"Preview",Headings:"Headings",Paragraph:"Paragraph",Bold:"Bold",Italic:"Italic",Strike:"Strike",Code:"Inline code",Line:"Line",Blockquote:"Blockquote","Unordered list":"Unordered list","Ordered list":"Ordered list",Task:"Task",Indent:"Indent",Outdent:"Outdent","Insert link":"Insert link","Insert CodeBlock":"Insert codeBlock","Insert table":"Insert table","Insert image":"Insert image",Heading:"Heading","Image URL":"Image URL","Select image file":"Select image file","Choose a file":"Choose a file","No file":"No file",Description:"Description",OK:"OK",More:"More",Cancel:"Cancel",File:"File",URL:"URL","Link text":"Link text","Add row to up":"Add row to up","Add row to down":"Add row to down","Add column to left":"Add column to left","Add column to right":"Add column to right","Remove row":"Remove row","Remove column":"Remove column","Align column to left":"Align column to left","Align column to center":"Align column to center","Align column to right":"Align column to right","Remove table":"Remove table","Would you like to paste as table?":"Would you like to paste as table?","Text color":"Text color","Auto scroll enabled":"Auto scroll enabled","Auto scroll disabled":"Auto scroll disabled","Choose language":"Choose language"});var Pb=Rb}(),T=T.default}()});const Fb="modulepreload",Bb=function(Q){return"/markdown/"+Q},fh={},jt=function(y,b,T){let x=Promise.resolve();if(b&&b.length>0){let N=function(D){return Promise.all(D.map(F=>Promise.resolve(F).then(R=>({status:"fulfilled",value:R}),R=>({status:"rejected",reason:R}))))};document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),M=v?.nonce||v?.getAttribute("nonce");x=N(b.map(D=>{if(D=Bb(D),D in fh)return;fh[D]=!0;const F=D.endsWith(".css"),R=F?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${D}"]${R}`))return;const O=document.createElement("link");if(O.rel=F?"stylesheet":Fb,F||(O.as="script"),O.crossOrigin="",O.href=D,M&&O.setAttribute("nonce",M),document.head.appendChild(O),F)return new Promise((S,X)=>{O.addEventListener("load",S),O.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${D}`)))})}))}function k(v){const M=new Event("vite:preloadError",{cancelable:!0});if(M.payload=v,window.dispatchEvent(M),!M.defaultPrevented)throw v}return x.then(v=>{for(const M of v||[])M.status==="rejected"&&k(M.reason);return y().catch(k)})},$={EDITOR:{INITIAL_VALUE:`# Welcome to Mark Editor!

Start typing here, or open a folder to begin editing your files.`,OUTLINE_UPDATE_DELAY:300,QUICK_START_FILE:"quick-start.md",KAI_PROFILE_FILE:"about-kai-kleinbard.md"},FILE_SYSTEM:{SUPPORTED_EXTENSIONS:[".md",".markdown"]},AI_CHAT:{API_URL:"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent",API_KEY:"",PROMPT_PREFIX:`You are a helpful writing assistant for someone building a textbook. Be concise and helpful. The user's request is: "`},UI:{TOAST_DURATION:3e3},PANELS:{FILES:"files",SEARCH:"search",OUTLINE:"outline",AI:"ai"},MESSAGE_TYPES:{SUCCESS:"success",ERROR:"error"},CHAT_TYPES:{USER:"user",AI:"ai"},OUTLINE:{USE_FANCYTREE:!0,AUTO_EXPAND_LEVELS:2,UPDATE_DELAY:300}};class Hb{constructor(){this.editor=null,this.directoryHandle=null,this.currentDirectoryName=null,this.currentFileHandle=null,this.activeFileElement=null,this.outlineUpdateTimeout=null}setEditor(y){this.editor=y}getEditor(){return this.editor}setDirectoryHandle(y){this.directoryHandle=y}getDirectoryHandle(){return this.directoryHandle}setCurrentDirectoryName(y){this.currentDirectoryName=y}getCurrentDirectoryName(){return this.currentDirectoryName}setCurrentFileHandle(y){this.currentFileHandle=y}getCurrentFileHandle(){return this.currentFileHandle}setActiveFileElement(y){this.activeFileElement=y}getActiveFileElement(){return this.activeFileElement}setOutlineUpdateTimeout(y){this.outlineUpdateTimeout=y}getOutlineUpdateTimeout(){return this.outlineUpdateTimeout}hasDirectory(){return this.directoryHandle!==null}hasCurrentFile(){return this.currentFileHandle!==null}clearFileState(){this.currentFileHandle=null,this.activeFileElement=null}}const et=new Hb;class zb{constructor(){this.outlineContainer=null,this.initialized=!1,this.treeData=[]}initialize(){this.initialized||(this.outlineContainer=document.getElementById("outline-list"),this.initialized=!0)}updateOutline(){const y=et.getEditor();if(!y||!this.outlineContainer){this.showMessage("Editor not ready.");return}const b=y.getMarkdown();if(this.treeData=this.parseMarkdownToTree(b),this.treeData.length===0){this.showMessage(b.trim()===""?"Start typing headings to see an outline.":"No headings found.");return}this.renderTree()}parseMarkdownToTree(y){const b=y.split(`
`),T=/^(#+)\s+(.*)/,x=[],k=[{level:0,children:x}];return b.forEach((v,M)=>{const N=v.match(T);if(N){const D=N[1].length,F=N[2].trim(),R=M+1,O={text:F,level:D,line:R,type:"heading",expanded:D<=2,children:[]};for(;k.length>1&&k[k.length-1].level>=D;)k.pop();k[k.length-1].children.push(O),k.push({level:D,children:O.children})}}),x}renderTree(){this.outlineContainer.innerHTML=this.renderNodes(this.treeData),this.attachEventListeners()}renderNodes(y,b=0){return!y||y.length===0?"":y.map(T=>{const x=T.children&&T.children.length>0,k=T.expanded?"expanded":"",v=x?T.expanded?"":"":"",M=b*16;return`
                <li class="outline-node ${k}" data-line="${T.line}" data-level="${T.level}">
                    <div class="outline-node-content" style="padding-left: ${M}px">
                        ${x?`<button class="outline-toggle" data-line="${T.line}">${v}</button>`:'<span class="outline-spacer"></span>'}
                        <span class="outline-text heading-level-${T.level}" data-line="${T.line}">
                            ${T.text}
                            <span class="line-number">:${T.line}</span>
                        </span>
                    </div>
                    ${x?`<ul class="outline-children ${T.expanded?"expanded":""}">${this.renderNodes(T.children,b+1)}</ul>`:""}
                </li>
            `}).join("")}attachEventListeners(){this.outlineContainer.querySelectorAll(".outline-toggle").forEach(y=>{y.addEventListener("click",b=>{b.stopPropagation();const T=parseInt(y.dataset.line);this.toggleNode(T)})}),this.outlineContainer.querySelectorAll(".outline-text").forEach(y=>{y.addEventListener("click",b=>{const T=parseInt(y.dataset.line);this.handleNodeClick(T)})})}toggleNode(y){const b=this.findNodeByLine(this.treeData,y);b&&(b.expanded=!b.expanded,this.renderTree())}findNodeByLine(y,b){for(const T of y){if(T.line===b)return T;if(T.children){const x=this.findNodeByLine(T.children,b);if(x)return x}}return null}handleNodeClick(y){const b=et.getEditor();b&&(b.setSelection([y,1],[y,1]),b.focus())}showMessage(y){this.outlineContainer.innerHTML=`<div class="outline-message">${y}</div>`}expandAll(){this.setAllNodesExpanded(this.treeData,!0),this.renderTree()}collapseAll(){this.setAllNodesExpanded(this.treeData,!1),this.renderTree()}setAllNodesExpanded(y,b){y.forEach(T=>{T.children&&T.children.length>0&&(T.expanded=b,this.setAllNodesExpanded(T.children,b))})}getTree(){return this.treeData}destroy(){this.outlineContainer&&(this.outlineContainer.innerHTML=""),this.treeData=[],this.initialized=!1}}const ns=new zb;class _b{constructor(){this.dbName="AI_Textbook_Editor",this.dbVersion=3,this.storeName="markdown_files",this.db=null}async initialize(){return new Promise((y,b)=>{const T=indexedDB.open(this.dbName,this.dbVersion);T.onerror=()=>{console.error("Failed to open IndexedDB:",T.error),b(T.error)},T.onsuccess=()=>{this.db=T.result,y(this.db)},T.onupgradeneeded=x=>{const k=x.target.result;k.objectStoreNames.contains(this.storeName)||k.createObjectStore(this.storeName,{keyPath:"fileName"}).createIndex("fileName","fileName",{unique:!0}),k.objectStoreNames.contains("chats")||k.createObjectStore("chats",{keyPath:"id"})}})}async saveFile(y,b,T=""){return console.log("[IndexedDB] saveFile called with:",{fileName:y,contentLength:b.length,directoryName:T}),this.db||(console.log("[IndexedDB] Database not initialized, initializing..."),await this.initialize()),new Promise((x,k)=>{console.log("[IndexedDB] Creating transaction for:",y);const v=this.db.transaction([this.storeName],"readwrite"),M=v.objectStore(this.storeName),N={fileName:y,content:b,directoryName:T,lastModified:new Date().toISOString(),size:b.length};console.log("[IndexedDB] Saving file data:",N);const D=M.put(N);D.onsuccess=()=>{console.log("[IndexedDB] File saved successfully:",y),x(N)},D.onerror=()=>{console.error("[IndexedDB] Error saving file:",y,D.error),k(D.error)},v.oncomplete=()=>{console.log("[IndexedDB] Transaction completed for:",y)},v.onerror=()=>{console.error("[IndexedDB] Transaction error for:",y,v.error)}})}async getFile(y){return this.db||await this.initialize(),new Promise((b,T)=>{const v=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(y);v.onsuccess=()=>{v.result?b(v.result):b(null)},v.onerror=()=>{console.error("Error retrieving file from IndexedDB:",v.error),T(v.error)}})}async getFilesByDirectory(y){return this.db||await this.initialize(),new Promise((b,T)=>{const v=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();v.onsuccess=()=>{const M=v.result.filter(N=>N.directoryName===y);b(M)},v.onerror=()=>{console.error("Error retrieving files from IndexedDB:",v.error),T(v.error)}})}async deleteFile(y){return this.db||await this.initialize(),new Promise((b,T)=>{const v=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(y);v.onsuccess=()=>{b()},v.onerror=()=>{console.error("Error deleting file from IndexedDB:",v.error),T(v.error)}})}async clearDirectory(y){return this.db||await this.initialize(),new Promise((b,T)=>{const k=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName),v=k.getAll();v.onsuccess=()=>{const M=v.result.filter(D=>D.directoryName===y),N=M.map(D=>k.delete(D.fileName));Promise.all(N).then(()=>{b(M.length)}).catch(T)},v.onerror=()=>{console.error("Error clearing directory from IndexedDB:",v.error),T(v.error)}})}async clearAllFiles(){return this.db||await this.initialize(),new Promise((y,b)=>{const k=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).clear();k.onsuccess=()=>{y()},k.onerror=()=>{console.error("Error clearing all files from IndexedDB:",k.error),b(k.error)}})}async getAllFiles(){return this.db||await this.initialize(),new Promise((y,b)=>{const k=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();k.onsuccess=()=>{y(k.result)},k.onerror=()=>{console.error("Error retrieving all files from IndexedDB:",k.error),b(k.error)}})}async isFirstTimeUser(){try{return this.db||await this.initialize(),this.db.objectStoreNames.contains(this.storeName)?new Promise((y,b)=>{const k=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();k.onsuccess=()=>{const v=k.result.length===0;y(v)},k.onerror=()=>{console.error("Error checking first time user status:",k.error),y(!0)}}):!0}catch(y){return console.error("Error in isFirstTimeUser:",y),!0}}async getLastEditedFile(){try{return this.db||await this.initialize(),this.db.objectStoreNames.contains(this.storeName)?new Promise((y,b)=>{const k=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();k.onsuccess=()=>{if(k.result.length===0){y(null);return}const v=k.result.sort((M,N)=>new Date(N.lastModified)-new Date(M.lastModified));y(v[0])},k.onerror=()=>{console.error("Error retrieving last edited file:",k.error),y(null)}}):null}catch(y){return console.error("Error in getLastEditedFile:",y),null}}}const st=new _b;class gh{constructor(){this.fileList=document.getElementById("file-list"),this.isLoadingFile=!1}async openFolder(){try{const y=await window.showDirectoryPicker();et.setDirectoryHandle(y),et.setCurrentDirectoryName(y.name),it.updateStatus(`Folder: ${y.name}`),await st.initialize(),await this.loadSavedFiles(y.name),await this.populateFileList()}catch(y){y.name!=="AbortError"&&(console.error("Error opening directory:",y),it.showToast("Could not open directory due to security restrictions.",$.MESSAGE_TYPES.ERROR))}}async populateFileList(){console.log("[FileSystem] populateFileList called");const y=et.getDirectoryHandle(),b=et.getCurrentDirectoryName();if(console.log("[FileSystem] Current directory:",b),!y&&!b){console.log("[FileSystem] No directory handle or name, loading unsaved files"),await this.loadUnsavedFiles();return}this.fileList.innerHTML="";let T=!1;const x=new Set;if(y){for await(const k of y.values())if(k.kind==="file"&&this.isMarkdownFile(k.name)){T=!0,x.add(k.name);const v=this.createFileListItem(k.name,"filesystem",!1);this.fileList.appendChild(v)}}if(b)try{const k=await st.getFilesByDirectory(b);console.log("[FileSystem] Files from current directory:",k);for(const v of k)if(!x.has(v.fileName)){T=!0,x.add(v.fileName);const M=this.createFileListItem(v.fileName,"indexeddb",!0);this.fileList.appendChild(M)}}catch(k){console.error("Error loading saved files:",k)}try{const k=await st.getFilesByDirectory("shared");console.log("[FileSystem] Shared files found:",k);for(const v of k)if(!x.has(v.fileName)){T=!0,x.add(v.fileName);const M=this.createFileListItem(v.fileName,"indexeddb",!0);this.fileList.appendChild(M)}}catch(k){console.error("Error loading shared files:",k)}try{if(await st.getFile("quick-start.md")&&!x.has("quick-start.md")){T=!0,x.add("quick-start.md");const v=this.createFileListItem("quick-start.md","indexeddb",!0);this.fileList.appendChild(v)}}catch(k){console.error("Error loading quick start guide:",k)}setTimeout(async()=>{try{if(await st.getFile($.EDITOR.KAI_PROFILE_FILE)&&!x.has($.EDITOR.KAI_PROFILE_FILE)){x.add($.EDITOR.KAI_PROFILE_FILE);const v=this.createFileListItem($.EDITOR.KAI_PROFILE_FILE,"indexeddb",!0);this.fileList.appendChild(v)}}catch(k){console.error("Error loading Kai profile:",k)}},1e3),T||(this.fileList.innerHTML='<li class="text-gray-400 text-sm p-2">No Markdown files found.</li>'),jt(async()=>{const{populateSearchResults:k}=await Promise.resolve().then(()=>ml);return{populateSearchResults:k}},void 0).then(({populateSearchResults:k})=>{k()})}isMarkdownFile(y){return $.FILE_SYSTEM.SUPPORTED_EXTENSIONS.some(b=>y.toLowerCase().endsWith(b))}async openFile(y,b){try{this.isLoadingFile=!0;const T=await st.getFile(y);let x;if(T)x=T.content;else if(y===$.EDITOR.QUICK_START_FILE||y===$.EDITOR.KAI_PROFILE_FILE)try{const{KAI_PROFILE_MARKDOWN:M,QUICK_START_MARKDOWN:N}=await jt(async()=>{const{KAI_PROFILE_MARKDOWN:D,QUICK_START_MARKDOWN:F}=await import("./kaiProfile-CVL9vzBh.js");return{KAI_PROFILE_MARKDOWN:D,QUICK_START_MARKDOWN:F}},[]);y===$.EDITOR.QUICK_START_FILE?(x=N,await st.saveFile(y,x,"quick-start")):y===$.EDITOR.KAI_PROFILE_FILE&&(x=M,await st.saveFile(y,x,"welcome"))}catch(M){console.error(`Error loading special file: ${M}`),it.showToast(`Could not load ${y}`,$.MESSAGE_TYPES.ERROR);return}else{const M=et.getDirectoryHandle();if(M){x=await(await(await M.getFileHandle(y)).getFile()).text();const F=et.getCurrentDirectoryName();await st.saveFile(y,x,F)}else{it.showToast(`Could not open file: ${y}`,$.MESSAGE_TYPES.ERROR);return}}et.getEditor().setMarkdown(x),it.updateStatus(`Editing: ${y}`);const v=et.getActiveFileElement();v&&v.classList.remove("active"),et.setActiveFileElement(b),b.classList.add("active"),et.setCurrentFileHandle({name:y}),this.updateSaveButtonState(!1,!1),it.updateOutline(),setTimeout(()=>{this.isLoadingFile=!1},1e3)}catch(T){console.error("Error opening file:",T),it.showToast(`Could not open file: ${y}`,$.MESSAGE_TYPES.ERROR),et.clearFileState(),this.updateSaveButtonState(!0,!1),this.isLoadingFile=!1}}async saveFile(){const y=et.getCurrentFileHandle();if(y)try{const T=et.getEditor().getMarkdown(),x=y.name,k=et.getCurrentDirectoryName();if(y.createWritable){const v=await y.createWritable();await v.write(T),await v.close()}await st.saveFile(x,T,k),this.updateSaveButtonState(!1,!1),it.showToast(`Saved: ${x}`)}catch(b){console.error("Error saving file:",b),it.showToast(`Error saving file: ${y.name}`,$.MESSAGE_TYPES.ERROR)}}updateSaveButtonState(y,b=!1){const T=et.getEditor();if(!T)return;const x=T.getEditorElements();if(!x||!x.toolbar)return;const v=x.toolbar.querySelector(".download-dropdown-container .tui-toolbar-icons.download-file");v&&(y?(v.style.opacity="0.3",v.style.cursor="not-allowed"):(v.style.opacity="0.85",v.style.cursor="pointer"),b?v.classList.add("has-changes"):v.classList.remove("has-changes"))}markFileAsChanged(){et.hasCurrentFile()&&(this.updateSaveButtonState(!1,!0),this.saveCurrentContentToIndexedDB())}async saveCurrentContentToIndexedDB(){const y=et.getCurrentFileHandle();if(y&&!this.isLoadingFile)try{const T=et.getEditor().getMarkdown(),x=y.name,k=et.getCurrentDirectoryName(),v=await st.getFile(x);if(v&&v.content===T)return;await st.saveFile(x,T,k)}catch(b){console.error("Error auto-saving to IndexedDB:",b)}}async loadSavedFiles(y){try{return await st.getFilesByDirectory(y)}catch(b){return console.error("Error loading saved files from IndexedDB:",b),[]}}async loadUnsavedFiles(){try{const y=await st.getFilesByDirectory("unsaved_documents");this.fileList.innerHTML="";let b=0;for(const T of y){const x=this.createFileListItem(T.fileName,"indexeddb",!0);this.fileList.appendChild(x),b++}try{if(await st.getFile("quick-start.md")){const x=this.createFileListItem("quick-start.md","indexeddb",!0);this.fileList.appendChild(x),b++}}catch(T){console.error("Error loading quick start guide:",T)}if(setTimeout(async()=>{try{if(await st.getFile($.EDITOR.KAI_PROFILE_FILE)){const x=this.createFileListItem($.EDITOR.KAI_PROFILE_FILE,"indexeddb",!0);this.fileList.appendChild(x)}}catch(T){console.error("Error loading Kai profile:",T)}},1e3),b===0){this.fileList.innerHTML='<li class="text-gray-400 text-sm p-2">No saved files found. Create a new file to get started.</li>';return}}catch(y){console.error("Error loading unsaved files:",y),this.fileList.innerHTML='<li class="text-gray-400 text-sm p-2">Error loading saved files.</li>'}}async createNewFile(y,b=""){let T=et.getCurrentDirectoryName();T||(T="unsaved_documents",et.setCurrentDirectoryName(T));try{await st.saveFile(y,b,T);const x={name:y};et.setCurrentFileHandle(x),et.getEditor().setMarkdown(b),it.updateStatus(`Editing: ${y}`),this.updateSaveButtonState(!1,!1),it.updateOutline(),await this.populateFileList(),it.showToast(`Created new file: ${y}`)}catch(x){console.error("Error creating new file:",x),it.showToast(`Error creating file: ${y}`,$.MESSAGE_TYPES.ERROR)}}createNewFileDialog(){const y=prompt("Enter file name (with .md extension):");if(y){if(!y.toLowerCase().endsWith(".md")){it.showToast("File name must end with .md",$.MESSAGE_TYPES.ERROR);return}if(Array.from(this.fileList.children).map(T=>T.dataset.fileName).includes(y)){it.showToast("File already exists",$.MESSAGE_TYPES.ERROR);return}this.createNewFile(y,`# ${y.replace(".md","")}

Start writing here...`)}}async handleFirstTimeUser(){try{const{QUICK_START_MARKDOWN:y}=await jt(async()=>{const{QUICK_START_MARKDOWN:T}=await import("./kaiProfile-CVL9vzBh.js");return{QUICK_START_MARKDOWN:T}},[]);await st.saveFile($.EDITOR.QUICK_START_FILE,y,"quick-start"),et.getEditor().setMarkdown(y),it.updateStatus(`Welcome! Editing: ${$.EDITOR.QUICK_START_FILE}`),it.showToast("Welcome to the AI Textbook Editor! Here's your quick start guide.",$.MESSAGE_TYPES.SUCCESS),await this.populateFileList(),et.setCurrentDirectoryName("quick-start"),et.setCurrentFileHandle({name:$.EDITOR.QUICK_START_FILE}),this.updateSaveButtonState(!1,!1),setTimeout(async()=>{try{const{KAI_PROFILE_MARKDOWN:T}=await jt(async()=>{const{KAI_PROFILE_MARKDOWN:x}=await import("./kaiProfile-CVL9vzBh.js");return{KAI_PROFILE_MARKDOWN:x}},[]);await st.saveFile($.EDITOR.KAI_PROFILE_FILE,T,"welcome"),console.log("Kai profile loaded and saved in background")}catch(T){console.error("Error loading Kai profile in background:",T)}},3e3)}catch(y){console.error("Error handling first-time user:",y),it.showToast("Error setting up welcome file",$.MESSAGE_TYPES.ERROR)}}async reinitializeBundledDocuments(){try{await st.deleteFile($.EDITOR.KAI_PROFILE_FILE),await st.deleteFile($.EDITOR.QUICK_START_FILE);const{KAI_PROFILE_MARKDOWN:y,QUICK_START_MARKDOWN:b}=await jt(async()=>{const{KAI_PROFILE_MARKDOWN:T,QUICK_START_MARKDOWN:x}=await import("./kaiProfile-CVL9vzBh.js");return{KAI_PROFILE_MARKDOWN:T,QUICK_START_MARKDOWN:x}},[]);await st.saveFile($.EDITOR.KAI_PROFILE_FILE,y,"welcome"),await st.saveFile($.EDITOR.QUICK_START_FILE,b,"quick-start"),await this.populateFileList()}catch(y){console.error("Error reinitializing bundled documents:",y),it.showToast("Error reinitializing bundled documents",$.MESSAGE_TYPES.ERROR)}}async loadLastEditedFile(){try{const b=!localStorage.getItem("aiTextbookEditor_hasVisited");let T=!1;if(b||(T=await st.isFirstTimeUser()),T&&!b)await this.handleFirstTimeUser();else{const x=await st.getFile($.EDITOR.QUICK_START_FILE),k=await st.getFile($.EDITOR.KAI_PROFILE_FILE);if(x||k){x&&x.directoryName==="quick-start"?(et.setCurrentDirectoryName("quick-start"),et.setCurrentFileHandle({name:$.EDITOR.QUICK_START_FILE}),it.updateStatus(`Editing: ${$.EDITOR.QUICK_START_FILE}`)):k&&k.directoryName==="welcome"?(et.setCurrentDirectoryName("welcome"),et.setCurrentFileHandle({name:$.EDITOR.KAI_PROFILE_FILE}),it.updateStatus(`Editing: ${$.EDITOR.KAI_PROFILE_FILE}`)):(et.setCurrentDirectoryName("quick-start"),et.setCurrentFileHandle({name:$.EDITOR.QUICK_START_FILE}),it.updateStatus(`Editing: ${$.EDITOR.QUICK_START_FILE}`)),await this.populateFileList(),this.updateSaveButtonState(!1,!1);try{const{KAI_PROFILE_MARKDOWN:v,QUICK_START_MARKDOWN:M}=await jt(async()=>{const{KAI_PROFILE_MARKDOWN:N,QUICK_START_MARKDOWN:D}=await import("./kaiProfile-CVL9vzBh.js");return{KAI_PROFILE_MARKDOWN:N,QUICK_START_MARKDOWN:D}},[]);k||await st.saveFile($.EDITOR.KAI_PROFILE_FILE,v,"welcome"),x||await st.saveFile($.EDITOR.QUICK_START_FILE,M,"quick-start")}catch(v){console.error("Error ensuring bundled documents are available:",v)}}else{const v=await st.getLastEditedFile();v?(et.setCurrentDirectoryName(v.directoryName),et.getEditor().setMarkdown(v.content),it.updateStatus(`Editing: ${v.fileName}`),await this.populateFileList(),et.setCurrentFileHandle({name:v.fileName}),this.updateSaveButtonState(!1,!1)):it.updateStatus("No files found. Create a new file or open a folder.")}}}catch(y){console.error("Error loading last edited file:",y),it.showToast("Error loading last edited file",$.MESSAGE_TYPES.ERROR)}}createFileListItem(y,b,T){const x=document.createElement("li");x.className="list-item p-2 rounded-md text-sm relative group cursor-pointer",x.dataset.fileName=y,x.dataset.source=b;const k=document.createElement("div");k.className="flex items-center justify-between";const v=document.createElement("span");v.textContent=y,v.className=T?"text-blue-600":"",k.appendChild(v);const M=document.createElement("div");M.className="hidden group-hover:flex items-center space-x-1";const N=document.createElement("button");N.innerHTML='<i class="fas fa-edit text-gray-500 hover:text-blue-600"></i>',N.className="p-1 hover:bg-gray-100 rounded",N.title="Rename file",N.addEventListener("click",F=>{F.stopPropagation(),this.startRename(x,v,y)});const D=document.createElement("button");return D.innerHTML='<i class="fas fa-times text-gray-500 hover:text-red-600"></i>',D.className="p-1 hover:bg-gray-100 rounded",D.title="Delete file",D.addEventListener("click",F=>{F.stopPropagation(),this.deleteFile(y,x)}),M.appendChild(N),M.appendChild(D),k.appendChild(M),x.appendChild(k),x.addEventListener("click",()=>this.openFile(y,x)),x}startRename(y,b,T){const x=document.createElement("input");x.type="text",x.value=T,x.className="bg-white border border-blue-500 rounded px-2 py-1 text-sm w-full",b.style.display="none",y.querySelector(".flex").insertBefore(x,y.querySelector(".hidden")),x.focus(),x.select();const k=async()=>{const v=x.value.trim();if(v&&v!==T){if(!v.toLowerCase().endsWith(".md")){it.showToast("File name must end with .md",$.MESSAGE_TYPES.ERROR),x.remove(),b.style.display="";return}await this.renameFile(T,v,y)}x.remove(),b.style.display=""};x.addEventListener("blur",k),x.addEventListener("keydown",v=>{v.key==="Enter"?k():v.key==="Escape"&&(x.remove(),b.style.display="")})}async renameFile(y,b,T){try{const x=et.getCurrentDirectoryName()||"unsaved_documents";if((await st.getFilesByDirectory(x)).find(F=>F.fileName===b&&F.fileName!==y)){it.showToast("File name already exists",$.MESSAGE_TYPES.ERROR);return}const M=await st.getFile(y);if(!M){it.showToast("File not found",$.MESSAGE_TYPES.ERROR);return}await st.saveFile(b,M.content,x),await st.deleteFile(y),T.dataset.fileName=b;const N=T.querySelector("span");N.textContent=b;const D=et.getCurrentFileHandle();D&&D.name===y&&(et.setCurrentFileHandle({name:b}),it.updateStatus(`Editing: ${b}`)),it.showToast(`Renamed to: ${b}`)}catch(x){console.error("Error renaming file:",x),it.showToast("Error renaming file",$.MESSAGE_TYPES.ERROR)}}async deleteFile(y,b){if(confirm(`Are you sure you want to delete "${y}"? This action cannot be undone.`))try{await st.deleteFile(y),b.remove();const T=et.getCurrentFileHandle();T&&T.name===y&&(et.getEditor().setMarkdown(""),et.clearFileState(),it.updateStatus("File deleted"),this.updateSaveButtonState(!0,!1)),it.showToast(`Deleted: ${y}`),this.fileList.children.length===0&&(this.fileList.innerHTML='<li class="text-gray-400 text-sm p-2">No saved files found.</li>')}catch(T){console.error("Error deleting file:",T),it.showToast("Error deleting file",$.MESSAGE_TYPES.ERROR)}}initializeEventListeners(){window.fixBundledDocuments=async()=>{await this.reinitializeBundledDocuments()},window.clearAllAndReinitialize=async()=>{await st.clearAllFiles(),await this.reinitializeBundledDocuments()}}}const zn=new gh,fl=Object.freeze(Object.defineProperty({__proto__:null,FileSystem:gh,fileSystem:zn},Symbol.toStringTag,{value:"Module"}));class qb{constructor(){this.initializeElements()}initializeElements(){this.filesToolBtn=document.getElementById("files-tool-btn"),this.searchToolBtn=document.getElementById("search-tool-btn"),this.outlineToolBtn=document.getElementById("outline-tool-btn"),this.aiToolBtn=document.getElementById("ai-tool-btn"),this.filesPanel=document.getElementById("files-panel"),this.searchPanel=document.getElementById("search-panel"),this.outlinePanel=document.getElementById("outline-panel"),this.aiPanel=document.getElementById("ai-panel"),this.sidebar=document.getElementById("sidebar"),this.outlineList=document.getElementById("outline-list"),this.toast=document.getElementById("toast"),this.initializeActivePanel(),ns.initialize(),this.initializeOutlineControls(),this.initializeResizeHandle()}initializeActivePanel(){this.filesPanel.classList.contains("active")?this.currentActivePanel=$.PANELS.FILES:this.searchPanel.classList.contains("active")?this.currentActivePanel=$.PANELS.SEARCH:this.outlinePanel.classList.contains("active")?this.currentActivePanel=$.PANELS.OUTLINE:this.aiPanel.classList.contains("active")?this.currentActivePanel=$.PANELS.AI:this.currentActivePanel=null}switchPanel(y){if(this.currentActivePanel===y){this.closeSidebar();return}this.currentActivePanel=y,this.openSidebar();const b=[this.filesPanel,this.searchPanel,this.outlinePanel,this.aiPanel],T=[this.filesToolBtn,this.searchToolBtn,this.outlineToolBtn,this.aiToolBtn];b.forEach(x=>x.classList.remove("active")),T.forEach(x=>x.classList.remove("active")),y===$.PANELS.FILES?(this.filesPanel.classList.add("active"),this.filesToolBtn.classList.add("active"),zn.populateFileList()):y===$.PANELS.SEARCH?(console.log("[UI] Switching to search panel"),this.searchPanel.classList.add("active"),this.searchToolBtn.classList.add("active"),jt(async()=>{const{populateSearchResults:x}=await Promise.resolve().then(()=>ml);return{populateSearchResults:x}},void 0).then(({populateSearchResults:x})=>{console.log("[UI] Calling populateSearchResults"),x()})):y===$.PANELS.OUTLINE?(this.outlinePanel.classList.add("active"),this.outlineToolBtn.classList.add("active")):y===$.PANELS.AI&&(this.aiPanel.classList.add("active"),this.aiToolBtn.classList.add("active"),jt(async()=>{const{aiChat:x}=await Promise.resolve().then(()=>bh);return{aiChat:x}},void 0).then(({aiChat:x})=>{x.onAIPanelOpened()}))}closeSidebar(){this.sidebar.classList.add("hidden"),this.currentActivePanel=null,[this.filesToolBtn,this.searchToolBtn,this.outlineToolBtn,this.aiToolBtn].forEach(b=>b.classList.remove("active"))}openSidebar(){this.sidebar.classList.remove("hidden")}isSidebarOpen(){return!this.sidebar.classList.contains("hidden")}getCurrentActivePanel(){return this.currentActivePanel}showToast(y,b=$.MESSAGE_TYPES.SUCCESS){if(window.innerWidth<=768&&document.getElementById("mobile-slideup-panel")){let T=document.getElementById("mobile-toast");T||(T=document.createElement("div"),T.id="mobile-toast",document.body.appendChild(T)),T.textContent=y,T.className="fixed top-5 left-1/2 transform -translate-x-1/2 text-white py-2 px-4 rounded-lg shadow-xl z-[200] transition-opacity duration-300",b===$.MESSAGE_TYPES.ERROR?T.classList.add("bg-red-500"):T.classList.add("bg-green-500"),T.style.opacity="1",setTimeout(()=>{T.style.opacity="0"},3e3);return}this.toast.textContent=y,this.toast.className="fixed bottom-5 right-5 text-white py-2 px-4 rounded-lg shadow-xl opacity-0 transform translate-y-2 transition-all duration-300",b===$.MESSAGE_TYPES.ERROR?this.toast.classList.add("bg-red-500"):this.toast.classList.add("bg-green-500"),this.toast.classList.remove("opacity-0","translate-y-2"),this.toast.classList.add("opacity-100","translate-y-0"),setTimeout(()=>{this.toast.classList.remove("opacity-100","translate-y-0"),this.toast.classList.add("opacity-0","translate-y-2")},$.UI.TOAST_DURATION)}updateStatus(y){console.log("Status:",y)}updateOutline(){ns.updateOutline()}debouncedUpdateOutline(){clearTimeout(et.getOutlineUpdateTimeout());const y=setTimeout(()=>this.updateOutline(),$.EDITOR.OUTLINE_UPDATE_DELAY);et.setOutlineUpdateTimeout(y)}initializeOutlineControls(){const y=document.getElementById("expand-all-btn"),b=document.getElementById("collapse-all-btn");y&&y.addEventListener("click",()=>{ns.expandAll()}),b&&b.addEventListener("click",()=>{ns.collapseAll()})}initializeResizeHandle(){const y=document.getElementById("sidebar-resize-handle");let b=!1,T=0,x=0;const k=N=>{b=!0,T=N.clientX||N.touches[0].clientX,x=this.sidebar.offsetWidth,this.sidebar.classList.add("resizing"),document.body.style.cursor="col-resize",document.body.style.userSelect="none",document.addEventListener("mousemove",v),document.addEventListener("mouseup",M),document.addEventListener("touchmove",v),document.addEventListener("touchend",M)},v=N=>{if(!b)return;const F=(N.clientX||N.touches[0].clientX)-T,R=Math.max(200,Math.min(600,x+F));this.sidebar.style.width=`${R}px`},M=()=>{if(!b)return;b=!1,this.sidebar.classList.remove("resizing"),document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",M),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",M);const N=this.sidebar.offsetWidth;localStorage.setItem("sidebarWidth",N)};y.addEventListener("mousedown",k),y.addEventListener("touchstart",k),this.loadSavedWidth()}loadSavedWidth(){const y=localStorage.getItem("sidebarWidth");if(y){const b=parseInt(y);b>=200&&b<=600&&(this.sidebar.style.width=`${b}px`)}}}const it=new qb;class vh{constructor(){this.chatInput=document.getElementById("chat-input"),this.chatSendBtn=document.getElementById("chat-send-btn"),this.chatMessages=document.getElementById("chat-messages"),this.apiKeyInput=document.getElementById("api-key-input"),this.saveApiKeyBtn=document.getElementById("save-api-key-btn"),this.apiKeySection=document.getElementById("api-key-section"),this.aiSettingsBtn=document.getElementById("ai-settings-btn"),this.newChatBtn=document.getElementById("new-chat-btn"),this.saveLocallyCheckbox=document.getElementById("save-locally-checkbox"),this.knowledgeBaseCheckbox=document.getElementById("knowledge-base-checkbox"),this.promptDropdown=document.getElementById("prompt-dropdown"),this.customPromptSection=document.getElementById("custom-prompt-section"),this.customPromptInput=document.getElementById("custom-prompt-input"),this.defaultPromptSection=document.getElementById("default-prompt-section"),this.defaultPromptDisplay=document.getElementById("default-prompt-display"),this.apiKey=localStorage.getItem("gemini-api-key")||"",this.tempApiKey="",this.defaultPrompt="You are an AI assistant for a document editor. You help users write and edit textbooks and documents. Always output perfect markdown formatting. Keep image links as markdown image syntax (![alt](url)). Be concise and helpful.",this.customPrompt=localStorage.getItem("custom-prompt")||"",this.systemPrompt=this.customPrompt||this.defaultPrompt,this.useKnowledgeBase=localStorage.getItem("use-knowledge-base")==="true",this.initialized=!1,this.initializeEventListeners(),this.loadSettings(),this.checkApiKey(),(this.apiKey||this.tempApiKey)&&this.chatMessages.children.length===0&&!this.initialized&&(this.loadChatHistory(),this.initialized=!0)}initializeEventListeners(){this.chatSendBtn.addEventListener("click",()=>this.handleAIChat()),this.chatInput.addEventListener("keydown",y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),this.handleAIChat())}),this.saveApiKeyBtn.addEventListener("click",()=>this.saveApiKey()),this.aiSettingsBtn.addEventListener("click",()=>this.toggleSettings()),this.newChatBtn.addEventListener("click",()=>this.newChat()),this.promptDropdown.addEventListener("change",()=>this.handlePromptChange()),this.customPromptInput.addEventListener("input",()=>this.saveCustomPrompt()),this.knowledgeBaseCheckbox.addEventListener("change",()=>this.saveKnowledgeBaseSetting()),this.setupResizeObserver()}onAIPanelOpened(){this.apiKey||this.tempApiKey||this.showWelcomeMessage()}checkApiKey(){this.apiKey||this.tempApiKey?(this.apiKeySection.style.display="none",this.aiSettingsBtn.classList.remove("hidden"),this.newChatBtn.classList.remove("hidden"),this.chatInput.disabled=!1,this.chatSendBtn.disabled=!1):(this.showWelcomeMessage(),this.apiKeySection.style.display="block",this.aiSettingsBtn.classList.remove("hidden"),this.newChatBtn.classList.remove("hidden"),this.chatInput.disabled=!0,this.chatSendBtn.disabled=!0)}showWelcomeMessage(){this.chatMessages.children.length===0&&this.addChatMessage("Welcome! To get started with the AI assistant, please enter your Gemini API key in the settings panel below. You can get a free API key from Google AI Studio.","ai")}saveApiKey(){const y=this.apiKeyInput.value.trim();y&&(this.saveLocallyCheckbox.checked?(this.apiKey=y,localStorage.setItem("gemini-api-key",y)):this.tempApiKey=y,this.apiKeyInput.value="",this.checkApiKey(),this.initialized||(localStorage.getItem("chat-welcomed")?this.loadChatHistory():(this.initializeChat(),this.addChatMessage("Hello! I'm your AI assistant for document editing. I can help you write, edit, and improve your textbook content. I'll format my responses in perfect markdown. How can I help you today?","ai"),localStorage.setItem("chat-welcomed","true")),this.initialized=!0))}toggleSettings(){this.apiKeySection.style.display==="none"?this.apiKeySection.style.display="block":this.apiKeySection.style.display="none"}handlePromptChange(){this.promptDropdown.value==="custom"?(this.customPromptSection.classList.remove("hidden"),this.defaultPromptSection.classList.add("hidden"),this.systemPrompt=this.customPrompt||this.defaultPrompt):(this.customPromptSection.classList.add("hidden"),this.defaultPromptSection.classList.remove("hidden"),this.systemPrompt=this.defaultPrompt)}saveCustomPrompt(){this.customPrompt=this.customPromptInput.value.trim(),this.customPrompt&&(localStorage.setItem("custom-prompt",this.customPrompt),this.systemPrompt=this.customPrompt)}loadSettings(){this.defaultPromptDisplay.textContent=this.defaultPrompt,this.customPrompt?(this.promptDropdown.value="custom",this.customPromptSection.classList.remove("hidden"),this.defaultPromptSection.classList.add("hidden"),this.customPromptInput.value=this.customPrompt):this.defaultPromptSection.classList.remove("hidden"),this.knowledgeBaseCheckbox.checked=this.useKnowledgeBase}saveKnowledgeBaseSetting(){this.useKnowledgeBase=this.knowledgeBaseCheckbox.checked,localStorage.setItem("use-knowledge-base",this.useKnowledgeBase.toString())}async getAllMarkdownFiles(){try{const y=indexedDB.open("AI_Textbook_Editor",2);return new Promise(b=>{y.onsuccess=T=>{const x=T.target.result;if(!x.objectStoreNames.contains("markdown_files")){b([]);return}const M=x.transaction(["markdown_files"],"readonly").objectStore("markdown_files").getAll();M.onsuccess=()=>b(M.result||[]),M.onerror=()=>b([])},y.onerror=()=>b([])})}catch{return[]}}async handleAIChat(){const y=this.chatInput.value.trim();if(!(!y||!this.apiKey&&!this.tempApiKey)){this.addChatMessage(y,"user"),this.chatInput.value="",this.chatSendBtn.disabled=!0,this.addChatMessage('<span class="loading-dots"><span></span><span></span><span></span></span>',"ai",!0);try{const b=await this.callAIAPI(y);this.updateLastChatMessage(b)}catch(b){console.error("AI Chat Error:",b),this.updateLastChatMessage(`Error: Could not connect to the AI service. ${b.message}`)}finally{this.chatSendBtn.disabled=!1}}}async callAIAPI(y){const b=[{role:"user",parts:[{text:this.systemPrompt}]}];if(this.useKnowledgeBase){const O=await this.getAllMarkdownFiles();if(console.log(`Knowledge base enabled - found ${O.length} files`),O.length>0){const S=O.map(X=>`## ${X.fileName}
${X.content}`).join(`

`);console.log("Adding knowledge base to AI context:",S.substring(0,200)+"..."),b.push({role:"user",parts:[{text:`Knowledge Base:
${S}`}]})}}b.push({role:"user",parts:[{text:y}]});const T={contents:b,generationConfig:{responseMimeType:"text/plain"}},x=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:streamGenerateContent?key=${this.apiKey||this.tempApiKey}`,k=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!k.ok)throw new Error(`API request failed with status ${k.status}`);const v=k.body.getReader(),M=new TextDecoder;let N="",D="",F=0,R=!1;for(;;){const{done:O,value:S}=await v.read();if(O)break;const X=M.decode(S,{stream:!0});for(const Z of X)if(D+=Z,Z==="[")R=!0,F=0;else if(Z==="{")F++;else if(Z==="}"){if(F--,F===0)try{let nt;if(R&&D.includes("]")){nt=JSON.parse(D);for(const rt of nt)if(rt.candidates?.[0]?.content?.parts?.[0]?.text){const Ct=rt.candidates[0].content.parts[0].text;console.log("Stream chunk:",Ct),N+=Ct,this.updateStreamingMessage(N)}D="",R=!1}else if(!R){if(nt=JSON.parse(D),nt.candidates?.[0]?.content?.parts?.[0]?.text){const rt=nt.candidates[0].content.parts[0].text;console.log("Stream chunk:",rt),N+=rt,this.updateStreamingMessage(N)}D=""}}catch{}}else if(Z==="]"&&R)try{const nt=JSON.parse(D);for(const rt of nt)if(rt.candidates?.[0]?.content?.parts?.[0]?.text){const Ct=rt.candidates[0].content.parts[0].text;console.log("Stream chunk:",Ct),N+=Ct,this.updateStreamingMessage(N)}D="",R=!1,F=0}catch{}}return N||"Sorry, I couldn't generate a response."}addChatMessage(y,b,T=!1){const x=document.createElement("div");let k;if(b==="user"?k=`<div class="p-3 bg-gray-200 rounded-lg text-sm text-gray-800">${this.escapeHtml(y)}</div>`:k=`
                <div class="p-3 bg-indigo-50 rounded-lg text-sm text-indigo-800 markdown-content">${this.formatMarkdown(y)}</div>
                ${T?"":`<div class="flex space-x-2 mt-2 px-3 pb-2">
                    <button class="insert-btn text-xs text-gray-500 hover:text-indigo-600 flex items-center space-x-1" title="Insert into editor">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14m-7-7h14"/>
                        </svg>
                        <span>Insert</span>
                    </button>
                    <button class="copy-btn text-xs text-gray-500 hover:text-indigo-600 flex items-center space-x-1" title="Copy to clipboard">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                        </svg>
                        <span>Copy</span>
                    </button>
                </div>`}
            `,x.innerHTML=k,T&&(x.id="streaming-message"),b==="ai"&&!T){const v=x.querySelector(".insert-btn"),M=x.querySelector(".copy-btn");v?.addEventListener("click",()=>this.insertIntoEditor(y)),M?.addEventListener("click",()=>this.copyToClipboard(y))}this.chatMessages.appendChild(x),this.chatMessages.scrollTop=this.chatMessages.scrollHeight,T||this.saveChatToDB()}updateStreamingMessage(y){const b=document.getElementById("streaming-message");b&&(b.querySelector("div").innerHTML=this.formatMarkdown(y),this.chatMessages.scrollTop=this.chatMessages.scrollHeight)}updateLastChatMessage(y){const b=document.getElementById("streaming-message");if(b){b.innerHTML=`
                <div class="p-3 bg-indigo-50 rounded-lg text-sm text-indigo-800 markdown-content">${this.formatMarkdown(y)}</div>
                <div class="flex space-x-2 mt-2 px-3 pb-2">
                    <button class="insert-btn text-xs text-gray-500 hover:text-indigo-600 flex items-center space-x-1" title="Insert into editor">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14m-7-7h14"/>
                        </svg>
                        <span>Insert</span>
                    </button>
                    <button class="copy-btn text-xs text-gray-500 hover:text-indigo-600 flex items-center space-x-1" title="Copy to clipboard">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                        </svg>
                        <span>Copy</span>
                    </button>
                </div>
            `;const T=b.querySelector(".insert-btn"),x=b.querySelector(".copy-btn");T?.addEventListener("click",()=>this.insertIntoEditor(y)),x?.addEventListener("click",()=>this.copyToClipboard(y)),b.id=""}}formatMarkdown(y){return y.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,'<code class="bg-gray-100 px-1 rounded">$1</code>').replace(/\n/g,"<br>").replace(/!\[([^\]]*)\]\(([^\)]+)\)/g,'<img src="$2" alt="$1" class="max-w-full h-auto rounded">')}escapeHtml(y){const b=document.createElement("div");return b.textContent=y,b.innerHTML}insertIntoEditor(y){const b=window.editorInstance||window.appState?.getEditor()||document.querySelector("#editor")?._editor;if(b&&b.getMarkdown){const T=b.getMarkdown(),x=T+(T?`

`:"")+y;b.setMarkdown(x)}}async copyToClipboard(y){try{await navigator.clipboard.writeText(y)}catch{const T=document.createElement("textarea");T.value=y,document.body.appendChild(T),T.select(),document.execCommand("copy"),document.body.removeChild(T)}}async loadChatHistory(){try{const y=await this.getChatFromDB();y&&y.messages.length>0?y.messages.forEach(b=>{this.addChatMessage(b.content,b.sender)}):localStorage.getItem("chat-welcomed")||(this.initializeChat(),localStorage.setItem("chat-welcomed","true"))}catch{localStorage.getItem("chat-welcomed")||(this.initializeChat(),localStorage.setItem("chat-welcomed","true"))}}initializeChat(){this.saveChatToDB()}async saveChatToDB(){try{const y=Array.from(this.chatMessages.children).map(T=>{const x=T.querySelector(".bg-gray-200"),k=x?T.querySelector(".bg-gray-200").textContent:T.querySelector(".markdown-content").textContent;return{sender:x?"user":"ai",content:k}}),b=indexedDB.open("AI_Textbook_Editor",2);b.onupgradeneeded=T=>{const x=T.target.result;x.objectStoreNames.contains("chats")||x.createObjectStore("chats",{keyPath:"id"})},b.onsuccess=T=>{const x=T.target.result;x.objectStoreNames.contains("chats")&&x.transaction(["chats"],"readwrite").objectStore("chats").put({id:"current",messages:y,timestamp:Date.now()})}}catch(y){console.error("Error saving chat:",y)}}async getChatFromDB(){return new Promise(y=>{const b=indexedDB.open("AI_Textbook_Editor",2);b.onupgradeneeded=T=>{const x=T.target.result;x.objectStoreNames.contains("chats")||x.createObjectStore("chats",{keyPath:"id"})},b.onsuccess=T=>{const x=T.target.result;if(!x.objectStoreNames.contains("chats")){y(null);return}const M=x.transaction(["chats"],"readonly").objectStore("chats").get("current");M.onsuccess=()=>y(M.result),M.onerror=()=>y(null)},b.onerror=()=>y(null)})}setupResizeObserver(){const y=document.getElementById("sidebar");y&&window.ResizeObserver&&new ResizeObserver(()=>{this.chatInput.offsetHeight,this.chatSendBtn.offsetHeight}).observe(y)}newChat(){this.chatMessages.innerHTML="",this.initializeChat()}}const yh=new vh,bh=Object.freeze(Object.defineProperty({__proto__:null,AIChat:vh,aiChat:yh},Symbol.toStringTag,{value:"Module"}));let is=!1,oi=!1,hl=null;async function $b(){return is?Promise.resolve():(oi||(oi=!0,hl=new Promise((Q,y)=>{if(window.jsPDF){is=!0,oi=!1,Q();return}const b=document.createElement("script");b.src="lib/js/jspdf.debug.js",b.async=!0,b.onload=()=>{is=!0,oi=!1,console.log("[PDF Export] jsPDF loaded successfully"),"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"CACHE_FILE",url:"lib/js/jspdf.debug.js"}),Q()},b.onerror=()=>{oi=!1,console.error("[PDF Export] Failed to load jsPDF"),y(new Error("Failed to load jsPDF library. Please check your internet connection."))},document.head.appendChild(b)})),hl)}async function jb(Q,y="document"){if(!Q||Q.trim()===""){alert("No content to export");return}try{if(!is&&!oi&&console.log("[PDF Export] Loading jsPDF library..."),await $b(),!window.jsPDF)throw new Error("jsPDF library not available");const b=new window.jsPDF,T=b.internal.pageSize.getWidth(),x=b.internal.pageSize.getHeight(),k={top:20,left:20,right:20,bottom:20},v=T-k.left-k.right;let M=k.top;const N=6,D=Q.split(`
`);for(let F=0;F<D.length;F++){const R=D[F];if(M>x-k.bottom-20&&(b.addPage(),M=k.top),R.startsWith("# ")){b.setFont("helvetica","normal"),b.setFontSize(18),b.setFont(void 0,"bold");let O=R.substring(2);O=O.replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu,"");const S=b.splitTextToSize(O,v);b.text(S,k.left,M),M+=S.length*N*1.5}else if(R.startsWith("## ")){b.setFont("helvetica","normal"),b.setFontSize(14),b.setFont(void 0,"bold");let O=R.substring(3);O=O.replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu,"");const S=b.splitTextToSize(O,v);b.text(S,k.left,M),M+=S.length*N*1.3}else if(R.startsWith("### ")){b.setFont("helvetica","normal"),b.setFontSize(12),b.setFont(void 0,"bold");let O=R.substring(4);O=O.replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu,"");const S=b.splitTextToSize(O,v);b.text(S,k.left,M),M+=S.length*N*1.2}else if(R.startsWith("- ")||R.startsWith("* ")){b.setFont("helvetica","normal"),b.setFontSize(10),b.setFont(void 0,"normal");const O=" "+R.substring(2),S=b.splitTextToSize(O,v-10);b.text(S,k.left+10,M),M+=S.length*N}else if(R.match(/^\d+\. /)){b.setFont("helvetica","normal"),b.setFontSize(10),b.setFont(void 0,"normal");const O=b.splitTextToSize(R,v-10);b.text(O,k.left+10,M),M+=O.length*N}else if(R.startsWith("> ")){b.setFont("helvetica","normal"),b.setFontSize(10),b.setFont(void 0,"italic");const O=R.substring(2),S=b.splitTextToSize(O,v-20);b.text(S,k.left+20,M),M+=S.length*N}else if(R.startsWith("```")||R.startsWith("~~~"))M+=N*.5;else if(R.trim()==="")M+=N;else if(R.match(/!\[([^\]]*)\]\(([^)]+)\)/)){const O=R.match(/!\[([^\]]*)\]\(([^)]+)\)/),S=O[1]||"Image",X=O[2];try{const Z=await Vb(X);if(Z){M+60>x-k.bottom&&(b.addPage(),M=k.top);const rt=Math.min(v,100);b.addImage(Z,"JPEG",k.left,M,rt,60),M+=70,S&&(b.setFont("helvetica","normal"),b.setFontSize(8),b.setFont(void 0,"italic"),b.text(`Figure: ${S}`,k.left,M),M+=N)}else b.setFont("helvetica","normal"),b.setFontSize(10),b.setFont(void 0,"normal"),b.text(`[Image: ${S}]`,k.left,M),M+=N}catch{b.setFont("helvetica","normal"),b.setFontSize(10),b.setFont(void 0,"normal"),b.text(`[Image: ${S}]`,k.left,M),M+=N}}else{b.setFont("helvetica","normal"),b.setFontSize(10),b.setFont(void 0,"normal");let O=R;if(O=O.replace(/\[([^\]]+)\]\([^)]+\)/g,"$1"),O=O.replace(/\*\*([^*]+)\*\*/g,"$1"),O=O.replace(/\*([^*]+)\*/g,"$1"),O=O.replace(/__([^_]+)__/g,"$1"),O=O.replace(/_([^_]+)_/g,"$1"),O=O.replace(/`([^`]+)`/g,"$1"),O.trim()){O=O.replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu,"");const S=b.splitTextToSize(O,v);b.text(S,k.left,M),M+=S.length*N}}M+=2}b.save(y+".pdf")}catch(b){console.error("[PDF Export] Error exporting to PDF:",b),alert(`Failed to export PDF: ${b.message}`)}}async function Vb(Q){return new Promise(y=>{if(Q.startsWith("data:")){y(Q);return}const b=new window.Image;b.crossOrigin="anonymous",b.onload=()=>{try{const T=document.createElement("canvas"),x=T.getContext("2d");T.width=b.width,T.height=b.height,x.drawImage(b,0,0);const k=T.toDataURL("image/jpeg",.8);y(k)}catch{y(null)}},b.onerror=()=>y(null),b.src=Q,setTimeout(()=>y(null),5e3)})}async function Ub(Q,y="document"){if(!Q||Q.trim()===""){alert("No content to export");return}const b=await Wb(Q),T=Kb(b,y),x=new Blob([T],{type:"text/html;charset=utf-8"}),k=document.createElement("a");k.href=URL.createObjectURL(x),k.download=y+".html",document.body.appendChild(k),k.click(),document.body.removeChild(k)}async function Wb(Q){let y=Q;y=y.replace(/^### (.*$)/gm,"<h3>$1</h3>"),y=y.replace(/^## (.*$)/gm,"<h2>$1</h2>"),y=y.replace(/^# (.*$)/gm,"<h1>$1</h1>"),y=y.replace(/^[\s]*\*{3,}[\s]*$/gm,"<hr>"),y=y.replace(/^[\s]*-{3,}[\s]*$/gm,"<hr>"),y=y.replace(/^[\s]*_{3,}[\s]*$/gm,"<hr>"),y=y.replace(/\*\*\*(.*?)\*\*\*/g,"<strong><em>$1</em></strong>"),y=y.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),y=y.replace(/\*(.*?)\*/g,"<em>$1</em>"),y=y.replace(/___(.*?)___/g,"<strong><em>$1</em></strong>"),y=y.replace(/__(.*?)__/g,"<strong>$1</strong>"),y=y.replace(/_(.*?)_/g,"<em>$1</em>"),y=y.replace(/`(.*?)`/g,"<code>$1</code>");const b=y.match(/!\[([^\]]*)\]\(([^)]+)\)/g);if(b)for(const D of b){const F=/!\[([^\]]*)\]\(([^)]+)\)/,R=D.match(F),O=R[1]||"Image",S=R[2];try{const X=await Gb(S);if(X){const Z=`<img src="${X}" alt="${mr(O)}" style="max-width: 100%; height: auto; margin: 10px 0; display: block;" />`;y=y.replace(D,Z)}else{const Z=`<div style="border: 2px dashed #ccc; padding: 20px; text-align: center; margin: 10px 0; background-color: #f9f9f9;">
                        <p style="margin: 0; color: #666;"> Image: ${mr(O)}</p>
                        <p style="margin: 5px 0 0; font-size: 0.8em; color: #999;">Original URL: ${mr(S)}</p>
                    </div>`;y=y.replace(D,Z)}}catch{const Z=`<div style="border: 2px dashed #ccc; padding: 20px; text-align: center; margin: 10px 0; background-color: #f9f9f9;">
                    <p style="margin: 0; color: #666;"> Image: ${mr(O)}</p>
                    <p style="margin: 5px 0 0; font-size: 0.8em; color: #999;">Failed to load: ${mr(S)}</p>
                </div>`;y=y.replace(D,Z)}}y=y.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>'),y=y.replace(/~~(.*?)~~/g,"<del>$1</del>");const T=y.split(`
`),x=[];let k=!1,v=!1,M=!1,N=!1;for(let D=0;D<T.length;D++){let F=T[D];if(F.startsWith("```")||F.startsWith("~~~")){if(M)x.push("</code></pre>"),M=!1;else{const R=F.substring(3).trim();x.push(`<pre><code class="language-${R}">`),M=!0}continue}if(M){x.push(mr(F));continue}if(F.startsWith("> ")){N||(x.push("<blockquote>"),N=!0),x.push("<p>"+F.substring(2)+"</p>");continue}else N&&(x.push("</blockquote>"),N=!1);if(F.match(/^[\s]*[-*+]\s/)){k||(x.push("<ul>"),k=!0);const R=F.replace(/^[\s]*[-*+]\s/,"");x.push(`<li>${R}</li>`);continue}else k&&(x.push("</ul>"),k=!1);if(F.match(/^[\s]*\d+\.\s/)){v||(x.push("<ol>"),v=!0);const R=F.replace(/^[\s]*\d+\.\s/,"");x.push(`<li>${R}</li>`);continue}else v&&(x.push("</ol>"),v=!1);if(F.trim()===""){x.push("<br>");continue}F.match(/^<[h1-6|ul|ol|li|blockquote|pre|hr]/)?x.push(F):x.push(`<p>${F}</p>`)}return k&&x.push("</ul>"),v&&x.push("</ol>"),N&&x.push("</blockquote>"),M&&x.push("</code></pre>"),x.join(`
`)}function Kb(Q,y){return`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${mr(y)}</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
        }
       
        h1, h2, h3, h4, h5, h6 {
            margin-top: 2em;
            margin-bottom: 1em;
            font-weight: 600;
            line-height: 1.25;
        }
       
        h1 {
            font-size: 2em;
            border-bottom: 2px solid #eee;
            padding-bottom: 0.3em;
        }
       
        h2 {
            font-size: 1.5em;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.3em;
        }
       
        h3 {
            font-size: 1.25em;
        }
       
        p {
            margin: 1em 0;
        }
       
        ul, ol {
            margin: 1em 0;
            padding-left: 2em;
        }
       
        li {
            margin: 0.5em 0;
        }
       
        blockquote {
            margin: 1em 0;
            padding: 0 1em;
            color: #666;
            border-left: 4px solid #ddd;
            background-color: #f9f9f9;
        }
       
        code {
            background-color: #f4f4f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
        }
       
        pre {
            background-color: #f4f4f4;
            padding: 1em;
            border-radius: 5px;
            overflow-x: auto;
            margin: 1em 0;
        }
       
        pre code {
            background-color: transparent;
            padding: 0;
        }
       
        a {
            color: #0366d6;
            text-decoration: none;
        }
       
        a:hover {
            text-decoration: underline;
        }
       
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 1em auto;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
       
        hr {
            border: none;
            border-top: 2px solid #eee;
            margin: 2em 0;
        }
       
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 1em 0;
        }
       
        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
        }
       
        th {
            background-color: #f5f5f5;
            font-weight: 600;
        }
       
        del {
            color: #999;
        }
       
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
           
            h1 {
                font-size: 1.5em;
            }
           
            h2 {
                font-size: 1.25em;
            }
        }
       
        @media print {
            body {
                max-width: none;
                margin: 0;
            }
           
            a {
                color: #000;
                text-decoration: none;
            }
           
            a:after {
                content: " (" attr(href) ")";
                font-size: 0.8em;
                color: #666;
            }
        }
    </style>
</head>
<body>
${Q}
</body>
</html>`}function mr(Q){const y=document.createElement("div");return y.textContent=Q,y.innerHTML}async function Gb(Q){return new Promise(y=>{if(Q.startsWith("data:")){y(Q);return}const b=new window.Image;b.crossOrigin="anonymous",b.onload=()=>{try{const T=document.createElement("canvas"),x=T.getContext("2d");T.width=b.width,T.height=b.height,x.drawImage(b,0,0);const k=T.toDataURL("image/jpeg",.8);y(k)}catch{y(null)}},b.onerror=()=>y(null),b.src=Q,setTimeout(()=>y(null),5e3)})}window.appState=et;class Jb{constructor(){this.editor=null}async initialize(){return new Promise(async y=>{requestAnimationFrame(async()=>{const b=toastui.Editor,x=!localStorage.getItem("aiTextbookEditor_hasVisited"),k=new URLSearchParams(window.location.search),v=k.get("file"),M=k.get("share"),N=k.get("name");let D=$.EDITOR.INITIAL_VALUE,F="markdown";try{if(M&&N){console.log("[Editor] Processing shared content:",{sharedName:N,contentLength:M.length}),F="wysiwyg";const R=decodeURIComponent(atob(M).split("").map(S=>"%"+("00"+S.charCodeAt(0).toString(16)).slice(-2)).join(""));D=R,console.log("[Editor] Decoded content length:",R.length);const O=`${decodeURIComponent(N)}.md`;console.log("[Editor] Saving shared file as:",O);try{const S=await st.saveFile(O,R,"shared");console.log("[Editor] Shared file saved successfully:",S),setTimeout(()=>{console.log("[Editor] Updating file list after shared file save"),window.fileSystem&&window.fileSystem.populateFileList&&window.fileSystem.populateFileList()},100)}catch(S){console.error("[Editor] Error saving shared file:",S)}window.history.replaceState({},document.title,window.location.pathname)}else if(v){F="wysiwyg",D=await this.loadFileContent(v);try{const{KAI_PROFILE_MARKDOWN:R,QUICK_START_MARKDOWN:O}=await jt(async()=>{const{KAI_PROFILE_MARKDOWN:Z,QUICK_START_MARKDOWN:nt}=await import("./kaiProfile-CVL9vzBh.js");return{KAI_PROFILE_MARKDOWN:Z,QUICK_START_MARKDOWN:nt}},[]);await st.getFile($.EDITOR.KAI_PROFILE_FILE)||await st.saveFile($.EDITOR.KAI_PROFILE_FILE,R,"welcome"),await st.getFile($.EDITOR.QUICK_START_FILE)||await st.saveFile($.EDITOR.QUICK_START_FILE,O,"quick-start")}catch(R){console.error("Error ensuring bundled documents are available:",R)}}else if(x){F="wysiwyg",D=await this.loadQuickStartGuide(),localStorage.setItem("aiTextbookEditor_hasVisited","true");try{await st.saveFile("quick-start.md",D,"quick-start"),setTimeout(async()=>{try{const{KAI_PROFILE_MARKDOWN:R}=await jt(async()=>{const{KAI_PROFILE_MARKDOWN:O}=await import("./kaiProfile-CVL9vzBh.js");return{KAI_PROFILE_MARKDOWN:O}},[]);await st.saveFile($.EDITOR.KAI_PROFILE_FILE,R,"welcome"),console.log("Kai profile loaded and saved in background")}catch(R){console.error("Error loading Kai profile in background:",R)}},2e3)}catch(R){console.error("Error saving documents to IndexedDB:",R)}}}catch(R){console.error("Error loading initial content:",R),M&&it.showToast("Error loading shared content",$.MESSAGE_TYPES.ERROR)}this.editor=new b({el:document.querySelector("#editor"),height:"100%",initialEditType:F,previewStyle:"vertical",initialValue:D,usageStatistics:!1,toolbarItems:[["heading","bold","italic","strike"],["hr","quote"],["ul","ol","task","indent","outdent"],["table","image","link"],["code","codeblock"],[{el:this.createButton("open-folder","Open Folder",async()=>{try{await zn.openFolder(),it.showToast("Folder opened successfully")}catch{it.showToast("Failed to open folder",$.MESSAGE_TYPES.ERROR)}})},{el:this.createButton("new-file","New File",async()=>{try{await zn.createNewFileDialog(),it.showToast("New file created")}catch{it.showToast("Failed to create new file",$.MESSAGE_TYPES.ERROR)}})},{el:this.createButton("share-file","Share",()=>this.shareFile())},{el:this.createDownloadDropdown()}]]}),et.setEditor(this.editor),window.editorInstance=this.editor,window.testQuickStartGuide=()=>this.testQuickStartGuide(),this.addCustomToolbarItems(),this.setupEventListeners(),it.updateOutline(),y(this.editor)})})}createButton(y,b,T){const x=document.createElement("button");return x.className=`tui-toolbar-icons ${y} custom-small`,x.title=b,x.addEventListener("click",T),x}createDownloadDropdown(){const y=document.createElement("div");y.className="download-dropdown-container relative";const b=document.createElement("button");b.className="tui-toolbar-icons download-file custom-small",b.title="Download File",b.innerHTML=`
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7,10 12,15 17,10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        `;const T=document.createElement("div");return T.className="download-dropdown absolute top-full mt-1 left-0 min-w-48 bg-white border border-gray-300 rounded-md shadow-lg hidden z-50",T.style.transform="translateX(-100%)",T.style.marginLeft="100%",T.innerHTML=`
            <div class="download-options-list py-1">
                <button class="download-option w-full text-left px-4 py-2 text-sm hover:bg-gray-100" data-format="md">
                    <i class="fas fa-file-code mr-2"></i>Download as .md
                </button>
                <button class="download-option w-full text-left px-4 py-2 text-sm hover:bg-gray-100" data-format="txt">
                    <i class="fas fa-file-alt mr-2"></i>Download as .txt
                </button>
                <button class="download-option w-full text-left px-4 py-2 text-sm hover:bg-gray-100" data-format="pdf">
                    <i class="fas fa-file-pdf mr-2"></i>Download as .pdf
                </button>
                <button class="download-option w-full text-left px-4 py-2 text-sm hover:bg-gray-100" data-format="html">
                    <i class="fas fa-file-code mr-2"></i>Download as .html
                </button>
            </div>
        `,b.addEventListener("click",x=>{x.stopPropagation(),T.classList.toggle("hidden")}),T.addEventListener("click",async x=>{const k=x.target.closest(".download-option");if(k&&!k.disabled){const v=k.dataset.format;if(v==="pdf"){const M=et.getEditor(),N=M?M.getMarkdown():"",D=et.getCurrentFileHandle();let F="document";D&&D.name&&(F=D.name.replace(/\.[^/.]+$/,"")),await jb(N,F),it.showToast(`Downloaded: ${F}.pdf`)}else if(v==="html"){const M=et.getEditor(),N=M?M.getMarkdown():"",D=et.getCurrentFileHandle();let F="document";D&&D.name&&(F=D.name.replace(/\.[^/.]+$/,"")),await Ub(N,F),it.showToast(`Downloaded: ${F}.html`)}else this.downloadFile(v);T.classList.add("hidden")}}),document.addEventListener("click",x=>{y.contains(x.target)||T.classList.add("hidden")}),y.appendChild(b),y.appendChild(T),y}downloadFile(y){const b=et.getEditor();if(!b)return;const T=b.getMarkdown(),x=et.getCurrentFileHandle();let k="document";x&&x.name&&(k=x.name.replace(/\.[^/.]+$/,"")),k+=y==="md"?".md":".txt";const v=new Blob([T],{type:"text/plain"}),M=URL.createObjectURL(v),N=document.createElement("a");N.href=M,N.download=k,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(M),it.showToast(`Downloaded: ${k}`)}async shareFile(){const y=et.getEditor();if(!y)return;const b=y.getMarkdown(),T=et.getCurrentFileHandle();let x="shared-document";T&&T.name&&(x=T.name.replace(/\.[^/.]+$/,""));const k=btoa(encodeURIComponent(b).replace(/%([0-9A-F]{2})/g,(M,N)=>String.fromCharCode("0x"+N))),v=`${window.location.origin}${window.location.pathname}?share=${k}&name=${encodeURIComponent(x)}`;try{await navigator.clipboard.writeText(v),it.showToast("Share link copied to clipboard!")}catch(M){console.error("Failed to copy to clipboard:",M),it.showToast("Failed to copy share link",$.MESSAGE_TYPES.ERROR)}}addCustomToolbarItems(){setTimeout(()=>zn.updateSaveButtonState(!0,!1),100)}setupEventListeners(){this.editor.on("change",()=>{zn.markFileAsChanged(),it.debouncedUpdateOutline()}),this.setupLinkClickHandler()}setupLinkClickHandler(){const y=document.querySelector("#editor");y&&(y.addEventListener("click",b=>{const T=b.target;T.tagName==="A"&&T.href&&(b.preventDefault(),b.stopPropagation(),window.open(T.href,"_blank","noopener,noreferrer"))}),y.addEventListener("mousedown",b=>{const T=b.target;T.tagName==="A"&&T.href&&(b.ctrlKey||b.metaKey)&&(b.preventDefault(),b.stopPropagation(),window.open(T.href,"_blank","noopener,noreferrer"))}))}getEditor(){return this.editor}setMarkdown(y){this.editor&&this.editor.setMarkdown(y)}getMarkdown(){return this.editor?this.editor.getMarkdown():""}focus(){this.editor&&this.editor.focus()}setSelection(y,b){this.editor&&this.editor.setSelection(y,b)}async loadFileContent(y){try{const b=await st.getFile(y);if(b)return b.content;if(y===$.EDITOR.KAI_PROFILE_FILE||y===$.EDITOR.QUICK_START_FILE){const{KAI_PROFILE_MARKDOWN:x,QUICK_START_MARKDOWN:k}=await jt(async()=>{const{KAI_PROFILE_MARKDOWN:v,QUICK_START_MARKDOWN:M}=await import("./kaiProfile-CVL9vzBh.js");return{KAI_PROFILE_MARKDOWN:v,QUICK_START_MARKDOWN:M}},[]);if(y===$.EDITOR.KAI_PROFILE_FILE){const v=x;return await st.saveFile(y,v,"welcome"),v}else if(y===$.EDITOR.QUICK_START_FILE){const v=k;return await st.saveFile(y,v,"quick-start"),v}}const T=await fetch(y);if(T.ok){const x=await T.text();return await st.saveFile(y,x,"url-param"),x}return`# ${y}

File not found. Start writing your content here...`}catch(b){return console.error("Error loading file:",b),`# ${y}

Error loading file. Start writing your content here...`}}async loadQuickStartGuide(){try{const{QUICK_START_MARKDOWN:y}=await jt(async()=>{const{QUICK_START_MARKDOWN:b}=await import("./kaiProfile-CVL9vzBh.js");return{QUICK_START_MARKDOWN:b}},[]);return await st.saveFile($.EDITOR.QUICK_START_FILE,y,"quick-start"),y}catch(y){return console.error("Error loading quick start guide:",y),console.log("Returning fallback content due to error"),$.EDITOR.INITIAL_VALUE}}async testQuickStartGuide(){return await this.loadQuickStartGuide()}}const mh=new Jb;let rs,hn,si;function wh(){console.log("[SearchPanel] Initializing search panel"),rs=document.getElementById("search-input"),hn=document.getElementById("search-results-list"),si=document.getElementById("file-list"),console.log("[SearchPanel] Elements found:",{searchInput:!!rs,searchResultsList:!!hn,fileList:!!si}),rs&&(rs.addEventListener("input",Yb),console.log("[SearchPanel] Search input event listener added")),kh()}function kh(){if(console.log("[SearchPanel] Populating search results"),!si||!hn){console.log("[SearchPanel] Missing elements:",{fileList:!!si,searchResultsList:!!hn});return}hn.innerHTML="";const Q=si.children.length;console.log("[SearchPanel] Found",Q,"files to clone"),Array.from(si.children).forEach(y=>{const b=y.cloneNode(!0);b.addEventListener("click",()=>{const T=b.dataset.fileName;T&&jt(async()=>{const{fileSystem:x}=await Promise.resolve().then(()=>fl);return{fileSystem:x}},void 0).then(({fileSystem:x})=>{x.openFile(T,b)})}),hn.appendChild(b)}),console.log("[SearchPanel] Added",hn.children.length,"items to search results")}async function Yb(Q){const y=Q.target.value.toLowerCase();if(!y){Array.from(hn.children).forEach(b=>{b.classList.remove("hidden")});return}for(const b of hn.children){let x=b.textContent.toLowerCase().includes(y);if(!x&&b.dataset.fileName)try{const k=await st.getFile(b.dataset.fileName);k&&k.content.toLowerCase().includes(y)&&(x=!0)}catch(k){console.error("Error searching file content:",k)}b.classList.toggle("hidden",!x)}}const ml=Object.freeze(Object.defineProperty({__proto__:null,initSearchPanel:wh,populateSearchResults:kh},Symbol.toStringTag,{value:"Module"}));class Qb{constructor(){this.initialized=!1}async initialize(){if(!this.initialized)try{await this.initializeModules(),this.setupEventListeners(),yh.initializeChat(),this.initialized=!0,console.log("Mark Editor initialized successfully");const y=document.getElementById("app-loader");y&&(y.style.display="none")}catch(y){console.error("Failed to initialize application:",y)}}async initializeModules(){await st.initialize(),await new Promise(y=>setTimeout(y,100)),await mh.initialize(),zn.initializeEventListeners(),wh(),await zn.loadLastEditedFile()}setupEventListeners(){document.getElementById("files-tool-btn").addEventListener("click",()=>it.switchPanel($.PANELS.FILES)),document.getElementById("search-tool-btn").addEventListener("click",()=>it.switchPanel($.PANELS.SEARCH)),document.getElementById("outline-tool-btn").addEventListener("click",()=>it.switchPanel($.PANELS.OUTLINE)),document.getElementById("ai-tool-btn").addEventListener("click",()=>it.switchPanel($.PANELS.AI))}getStatus(){return{initialized:this.initialized,hasEditor:mh.getEditor()!==null,hasDirectory:et.hasDirectory(),hasCurrentFile:et.hasCurrentFile()}}}const Xb=new Qb;document.addEventListener("DOMContentLoaded",()=>{Xb.initialize()});let Ht=null,xh=!1,ai=null;function Zb(){const Q=document.getElementById("sidebar");Q&&(ai&&ai.disconnect(),ai=new MutationObserver(y=>{for(const b of y)b.type==="attributes"&&b.attributeName==="style"&&console.log(`[MobileUI] Sidebar style changed: ${Q.getAttribute("style")}`)}),ai.observe(Q,{attributes:!0,attributeFilter:["style"]}))}function tw(){console.log("[MobileUI] Activating mobile UI");const Q=document.getElementById("sidebar");Q&&(xh=Q.style.display!=="none",Q.style.display="none",console.log("[MobileUI] Sidebar hidden"),Zb());const y=document.getElementById("editor");if(y){const F=window.innerHeight*.9;y.style.maxHeight=`${F}px`,y.style.height=`${F}px`}if(document.getElementById("mobile-slideup-panel")){console.log("[MobileUI] Mobile panel already exists");return}Ht=document.createElement("div"),Ht.id="mobile-slideup-panel",Ht.innerHTML=`
    <div id="mobile-slideup-handle" style="width:100%;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;">
      <div style="width:48px;height:6px;background:#a3a3a3;border-radius:3px;margin:8px 0;"></div>
    </div>
    <div id="mobile-tabs" style="display:flex;justify-content:space-around;border-bottom:1px solid #e5e7eb;background:#fff;">
      <button class="mobile-tab" data-tab="files" style="flex:1;padding:12px 0;font-weight:500;">Files</button>
      <button class="mobile-tab" data-tab="search" style="flex:1;padding:12px 0;font-weight:500;">Search</button>
      <button class="mobile-tab" data-tab="outline" style="flex:1;padding:12px 0;font-weight:500;">Outline</button>
      <button class="mobile-tab" data-tab="ai" style="flex:1;padding:12px 0;font-weight:500;">AI</button>
    </div>
    <div id="mobile-tab-content" style="flex:1;overflow-y:auto;background:#fff;"></div>
  `,Object.assign(Ht.style,{position:"fixed",left:0,right:0,bottom:0,height:"60vh",minHeight:"200px",maxHeight:"90vh",background:"#fff",boxShadow:"0 -2px 16px rgba(0,0,0,0.12)",borderTopLeftRadius:"16px",borderTopRightRadius:"16px",zIndex:100,display:"flex",flexDirection:"column",transform:"translateY(85%)",transition:"transform 0.3s cubic-bezier(.4,2,.6,1)",touchAction:"pan-y"}),document.body.appendChild(Ht),console.log("[MobileUI] Mobile panel created and appended");let b=0,T=0,x=!1;document.getElementById("mobile-slideup-handle").addEventListener("touchstart",D=>{D.preventDefault(),x=!0,b=D.touches[0].clientY;const R=Ht.style.transform.match(/translateY\(([\d.]+)%\)/);T=R?parseFloat(R[1]):85,Ht.style.transition="none"},{passive:!1}),window.addEventListener("touchmove",D=>{if(!x)return;D.preventDefault();const F=D.touches[0].clientY-b,R=window.innerHeight,O=F/R*100;let S=T+O;S=Math.max(5,Math.min(S,90)),Ht.style.transform=`translateY(${S}%)`},{passive:!1}),window.addEventListener("touchend",()=>{if(!x)return;x=!1,Ht.style.transition="";const D=Ht.getBoundingClientRect(),F=window.innerHeight;D.top/F*100>60?Ht.style.transform="translateY(85%)":Ht.style.transform="translateY(5%)"});const v=document.getElementById("mobile-tab-content");function M(D){let F="";if(D==="files"){const R=document.getElementById("files-panel");F=R?R.innerHTML:"<div>Files not available</div>",v.innerHTML=F,v.querySelectorAll(".list-item").forEach(O=>{O.addEventListener("click",()=>{const S=O.dataset.fileName;S&&(jt(async()=>{const{fileSystem:X}=await Promise.resolve().then(()=>fl);return{fileSystem:X}},void 0).then(({fileSystem:X})=>{X.openFile(S,O)}),N(`Opening: ${S}`))})})}else if(D==="search"){const R=document.getElementById("search-panel");F=R?R.innerHTML:"<div>Search not available</div>",v.innerHTML=F;const O=v.querySelector("#search-input"),S=v.querySelector("#search-results-list");O&&S&&(jt(async()=>{const{populateSearchResults:X}=await Promise.resolve().then(()=>ml);return{populateSearchResults:X}},void 0).then(({populateSearchResults:X})=>{X()}),O.addEventListener("input",async X=>{const Z=X.target.value.toLowerCase();Array.from(S.children).forEach(nt=>{const Ct=nt.textContent.toLowerCase().includes(Z);nt.classList.toggle("hidden",!Ct)})}),v.querySelectorAll(".list-item").forEach(X=>{X.addEventListener("click",()=>{const Z=X.dataset.fileName;Z&&(jt(async()=>{const{fileSystem:nt}=await Promise.resolve().then(()=>fl);return{fileSystem:nt}},void 0).then(({fileSystem:nt})=>{nt.openFile(Z,X)}),N(`Opening: ${Z}`))})}))}else if(D==="outline"){const R=document.getElementById("outline-panel");F=R?R.innerHTML:"<div>Outline not available</div>",v.innerHTML=F,jt(async()=>{const{outlineTree:O}=await import("./outlineTree-CmIIs99T.js");return{outlineTree:O}},[]).then(({outlineTree:O})=>{O&&O.rebindMobileEvents&&O.rebindMobileEvents(v)})}else if(D==="ai"){const R=document.getElementById("ai-panel");F=R?R.innerHTML:"<div>AI not available</div>",v.innerHTML=F,jt(async()=>{const{aiChat:O}=await Promise.resolve().then(()=>bh);return{aiChat:O}},void 0).then(({aiChat:O})=>{O.chatInput=v.querySelector("#chat-input"),O.chatSendBtn=v.querySelector("#chat-send-btn"),O.chatMessages=v.querySelector("#chat-messages"),O.apiKeyInput=v.querySelector("#api-key-input"),O.saveApiKeyBtn=v.querySelector("#save-api-key-btn"),O.apiKeySection=v.querySelector("#api-key-section"),O.aiSettingsBtn=v.querySelector("#ai-settings-btn"),O.newChatBtn=v.querySelector("#new-chat-btn"),O.saveLocallyCheckbox=v.querySelector("#save-locally-checkbox"),O.knowledgeBaseCheckbox=v.querySelector("#knowledge-base-checkbox"),O.promptDropdown=v.querySelector("#prompt-dropdown"),O.customPromptSection=v.querySelector("#custom-prompt-section"),O.customPromptInput=v.querySelector("#custom-prompt-input"),O.defaultPromptSection=v.querySelector("#default-prompt-section"),O.defaultPromptDisplay=v.querySelector("#default-prompt-display"),O.chatSendBtn?.addEventListener("click",()=>O.handleAIChat()),O.chatInput?.addEventListener("keydown",S=>{S.key==="Enter"&&!S.shiftKey&&(S.preventDefault(),O.handleAIChat())}),O.saveApiKeyBtn?.addEventListener("click",()=>O.saveApiKey()),O.aiSettingsBtn?.addEventListener("click",()=>O.toggleSettings()),O.newChatBtn?.addEventListener("click",()=>O.newChat()),O.promptDropdown?.addEventListener("change",()=>O.handlePromptChange()),O.customPromptInput?.addEventListener("input",()=>O.saveCustomPrompt()),O.knowledgeBaseCheckbox?.addEventListener("change",()=>O.saveKnowledgeBaseSetting()),O.loadSettings(),O.checkApiKey(),O.onAIPanelOpened()})}console.log(`[MobileUI] Switched to tab: ${D}`)}function N(D,F="success"){let R=document.getElementById("mobile-toast");R||(R=document.createElement("div"),R.id="mobile-toast",document.body.appendChild(R)),R.textContent=D,R.className="fixed top-5 left-1/2 transform -translate-x-1/2 text-white py-2 px-4 rounded-lg shadow-xl z-[200] transition-opacity duration-300",F==="error"?R.classList.add("bg-red-500"):R.classList.add("bg-green-500"),R.style.opacity="1",setTimeout(()=>{R.style.opacity="0"},3e3)}Ht.querySelectorAll(".mobile-tab").forEach(D=>{D.addEventListener("click",F=>{Ht.querySelectorAll(".mobile-tab").forEach(R=>R.style.fontWeight="500"),D.style.fontWeight="700",M(D.dataset.tab)})}),M("files"),console.log("[MobileUI] Defaulted to Files tab")}function ew(){console.log(`[MobileUI] Deactivating mobile UI at width: ${window.innerWidth}`),Ht&&Ht.parentNode&&(Ht.parentNode.removeChild(Ht),Ht=null,console.log("[MobileUI] Mobile panel removed"));const Q=document.getElementById("sidebar");Q&&xh&&(Q.style.display="",console.log("[MobileUI] Sidebar restored"));const y=document.getElementById("editor");y&&(y.style.maxHeight="",y.style.height="100%"),ai&&ai.disconnect()}function nw(){function Q(){console.log(`[MobileUI] Checking mobile: window.innerWidth=${window.innerWidth}`),window.innerWidth<=768?tw():ew()}Q(),window.addEventListener("resize",Q),console.log("[MobileUI] Mobile UI initialized")}window.addEventListener("DOMContentLoaded",()=>{nw()});export{et as a};
